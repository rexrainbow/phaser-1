/**
  * @author       Richard Davey <rich@photonstorm.com>
  * @copyright    2020 Photon Storm Ltd.
  * @license      {@link https://opensource.org/licenses/MIT|MIT License}
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Phaser4={})}(this,(function(t){"use strict";var e,n=0,r=function(){return e},i=function(t){e=t},o=function(){return n},a=function(t){n=t},u=function(t){t},s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}for(var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=new Uint8Array(256),p=0;p<l.length;p++)v[l.charCodeAt(p)]=p;function y(){}var x=function(){function t(t){var e=new Float32Array(16);this.data=e,this.onChange=y,t?Array.isArray(t)?this.fromArray(t):this.fromArray(t.data):(e[0]=1,e[5]=1,e[10]=1,e[15]=1)}return t.prototype.set=function(t,e,n,r,i,o,a,u,s,h,c,f,d,l,v,p){var y=this.data;return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=o,y[6]=a,y[7]=u,y[8]=s,y[9]=h,y[10]=c,y[11]=f,y[12]=d,y[13]=l,y[14]=v,y[15]=p,this.onChange(this),this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.data,r=0;r<16;r++)t[e+r]=n[r];return t},t.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var n=this.data,r=0;r<16;r++)n[r]=t[e+r];return this.onChange(this),this},t.prototype.toString=function(){return"[ mat4="+this.data.join(", ")+" ]"},t.prototype.destroy=function(){this.onChange=y,this.data=null},t}();function m(t,e,n,r){void 0===r&&(r=new x);var i=t.x,o=t.y,a=t.z,u=t.w,s=i+i,h=o+o,c=a+a,f=i*s,d=i*h,l=i*c,v=o*h,p=o*c,y=a*c,m=u*s,w=u*h,g=u*c,b=n.x,M=n.y,_=n.z,C=e.x,T=e.y,z=e.z;return r.set((1-(v+y))*b,(d+g)*b,(l-w)*b,0,(d-g)*M,(1-(f+y))*M,(p+m)*M,0,(l+w)*_,(p-m)*_,(1-(f+v))*_,0,C,T,z,1)}function w(t,e,n,r){void 0===n&&(n=!0),void 0===r&&(r=new x);var i=e.x,o=e.y,a=e.z,u=Math.sin(t.x),s=Math.cos(t.x),h=Math.sin(t.y),c=Math.cos(t.y),f=i,d=o,l=a,v=-u,p=0-v*h,y=0-s*h,m=v*c,w=s*c;return n||(f=c*i+h*a,d=p*i+s*o+m*a,l=y*i+u*o+w*a),r.set(c,p,y,0,0,s,u,0,h,m,w,0,f,d,l,1)}var g=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.set(t,e,n)}return t.prototype.set=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n,this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.x,r=this.y,i=this.z;return t[e]=n,t[e+1]=r,t[e+2]=i,t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.set(t[e],t[e+1],t[e+2])},t.prototype.toString=function(){return"{ x="+this.x+", y="+this.y+", z="+this.z+" }"},t}();function b(t,e){void 0===e&&(e=new g);var n=f(t.data,11),r=n[0],i=n[1],o=n[2],a=(n[3],n[4]),u=n[5],s=n[6],h=(n[7],n[8]),c=n[9],d=n[10];return e.set(Math.hypot(r,i,o),Math.hypot(a,u,s),Math.hypot(h,c,d))}var M=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this._x=t,this._y=e,this._z=n,this._w=r,this.onChange=y}return t.prototype.set=function(t,e,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this._x=t,this._y=e,this._z=n,this._w=r,this.onChange(this),this},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){var e=this._x;this._x=t,t!==e&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){var e=this._y;this._y=t,t!==e&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){var e=this._z;this._z=t,t!==e&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._w},set:function(t){var e=this._w;this._w=t,t!==e&&this.onChange(this)},enumerable:!1,configurable:!0}),t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.x,r=this.y,i=this.z,o=this.w;return t[e]=n,t[e+1]=r,t[e+2]=i,t[e+3]=o,t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.set(t[e],t[e+1],t[e+2],t[e+3])},t.prototype.destroy=function(){this.onChange=y},t.prototype.toString=function(){return"{ x="+this.x+", y="+this.y+", z="+this.z+", w="+this.w+" }"},t}();function _(t){return void 0===t&&(t=new x),t.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}function C(t,e){void 0===e&&(e=new x);var n=f(t.data,16),r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],h=n[6],c=n[7],d=n[8],l=n[9],v=n[10],p=n[11],y=n[12],m=n[13],w=n[14],g=n[15],b=v*g-w*p,M=l*g-m*p,_=l*w-m*v,C=d*g-y*p,T=d*w-v*y,z=d*m-y*l,S=+(s*b-h*M+c*_),E=-(u*b-h*C+c*T),R=+(u*M-s*C+c*z),P=-(u*_-s*T+h*z),A=r*S+i*E+o*R+a*P;if(0===A)return e;var D=1/A,F=h*g-w*c,O=s*g-m*c,I=s*w-m*h,L=u*g-y*c,B=u*w-y*h,k=u*m-y*s,G=h*p-v*c,j=s*p-l*c,U=s*v-l*h,V=u*p-d*c,N=u*v-d*h,W=u*l-d*s,q=-(i*b-o*M+a*_),H=+(r*b-o*C+a*T),K=-(r*M-i*C+a*z),X=+(r*_-i*T+o*z),Y=+(i*F-o*O+a*I),Z=-(r*F-o*L+a*B),J=+(r*O-i*L+a*k),Q=-(r*I-i*B+o*k),$=-(i*G-o*j+a*U),tt=+(r*G-o*V+a*N),et=-(r*j-i*V+a*W),nt=+(r*U-i*N+o*W);return e.set(S*D,q*D,Y*D,$*D,E*D,H*D,Z*D,tt*D,R*D,K*D,J*D,et*D,P*D,X*D,Q*D,nt*D)}function T(t,e,n,r){void 0===r&&(r=new x);var i=t.x,o=t.y,a=t.z,u=n.x,s=n.y,h=n.z,c=e.x,f=e.y,d=e.z;if(Math.abs(i-c)<1e-5&&Math.abs(o-f)<1e-5&&Math.abs(a-d)<1e-5)return _(r);var l=i-c,v=o-f,p=a-d,y=1/Math.hypot(l,v,p),m=s*(p*=y)-h*(v*=y),w=h*(l*=y)-u*p,g=u*v-s*l;(y=Math.hypot(m,w,g))?(m*=y=1/y,w*=y,g*=y):(m=0,w=0,g=0);var b=v*g-p*w,M=p*m-l*g,C=l*w-v*m;return(y=Math.hypot(b,M,C))?(b*=y=1/y,M*=y,C*=y):(b=0,M=0,C=0),r.set(m,b,l,0,w,M,v,0,g,C,p,0,-(m*i+w*o+g*a),-(b*i+M*o+C*a),-(l*i+v*o+p*a),1)}function z(t,e,n){void 0===n&&(n=new x);var r=f(t.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],m=r[12],w=r[13],g=r[14],b=r[15],M=f(e.data,16),_=M[0],C=M[1],T=M[2],z=M[3],S=M[4],E=M[5],R=M[6],P=M[7],A=M[8],D=M[9],F=M[10],O=M[11],I=M[12],L=M[13],B=M[14],k=M[15];return n.set(_*i+C*s+T*l+z*m,C*o+C*h+T*v+z*w,T*a+C*c+T*p+z*g,z*u+C*d+T*y+z*b,S*i+E*s+R*l+P*m,S*o+E*h+R*v+P*w,S*a+E*c+R*p+P*g,S*u+E*d+R*y+P*b,A*i+D*s+F*l+O*m,A*o+D*h+F*v+O*w,A*a+D*c+F*p+O*g,A*u+D*d+F*y+O*b,I*i+L*s+B*l+k*m,I*o+L*h+B*v+k*w,I*a+L*c+B*p+k*g,I*u+L*d+B*y+k*b)}function S(t,e,n,r,i,o,a){void 0===a&&(a=new x);var u=1/(t-e),s=1/(n-r),h=1/(i-o);return a.set(-2*u,0,0,0,0,-2*s,0,0,0,0,2*h,0,(t+e)*u,(r+n)*s,(o+i)*h,1)}function E(t,e,n,r,i){void 0===i&&(i=new x);var o=1/Math.tan(t/2),a=-1,u=-2*n;if(null!==r&&r!==1/0){var s=1/(n-r);a=(r+n)*s,u=2*r*n*s}return i.set(o/e,0,0,0,0,o,0,0,0,0,a,-1,0,0,u,0)}function R(t,e,n,r,i){void 0===i&&(i=new x);var o=t.data,a=f(o,16),u=a[0],s=a[1],h=a[2],c=a[3],d=a[4],l=a[5],v=a[6],p=a[7],y=a[8],m=a[9],w=a[10],g=a[11],b=a[12],M=a[13],_=a[14],C=a[15];return t===i?(o[12]=u*e+d*n+y*r+b,o[13]=s*e+l*n+m*r+M,o[14]=h*e+v*n+w*r+_,o[15]=c*e+p*n+g*r+C):i.set(u,s,h,c,d,l,v,p,y,m,w,g,u*e+d*n+y*r+b,s*e+l*n+m*r+M,h*e+v*n+w*r+_,c*e+p*n+g*r+C),i}function P(t,e){void 0===e&&(e=new x);var n=f(t.data,16),r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],h=n[6],c=n[7],d=n[8],l=n[9],v=n[10],p=n[11],y=n[12],m=n[13],w=n[14],g=n[15];return e.set(r,u,d,y,i,s,l,m,o,h,v,w,a,c,p,g)}var A=Object.freeze({__proto__:null,Add:function(t,e,n){void 0===n&&(n=new x);var r=f(t.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],m=r[12],w=r[13],g=r[14],b=r[15],M=f(e.data,16),_=M[0],C=M[1],T=M[2],z=M[3],S=M[4],E=M[5],R=M[6],P=M[7],A=M[8],D=M[9],F=M[10],O=M[11],I=M[12],L=M[13],B=M[14],k=M[15];return n.set(i+_,o+C,a+T,u+z,s+S,h+E,c+R,d+P,l+A,v+D,p+F,y+O,m+I,w+L,g+B,b+k)},AddTranslationFromFloats:function(t,e,n,r){var i=t.data;return i[12]+=e,i[13]+=n,i[14]+=r,t.onChange(t),t},Adjoint:function(t,e){void 0===e&&(e=new x);var n=f(t.data,16),r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],h=n[6],c=n[7],d=n[8],l=n[9],v=n[10],p=n[11],y=n[12],m=n[13],w=n[14],g=n[15],b=r*s-i*u,M=r*h-o*u,_=r*c-a*u,C=i*h-o*s,T=i*c-a*s,z=o*c-a*h,S=d*m-l*y,E=d*w-v*y,R=d*g-p*y,P=l*w-v*m,A=l*g-p*m,D=v*g-p*w;return e.set(s*D-h*A+c*P,o*A-i*D-a*P,m*z-w*T+g*C,v*T-l*z-p*C,h*R-u*D-c*E,r*D-o*R+a*E,w*_-y*z-g*M,d*z-v*_+p*M,u*A-s*R+c*S,i*R-r*A-a*S,y*T-m*_+g*b,l*_-d*T-p*b,s*E-u*P-h*S,r*P-i*E+o*S,m*M-y*C-w*b,d*C-l*M+v*b)},Clone:function(t){return new x(t)},CopyFrom:function(t,e){return e.fromArray(t.data)},CopyPosition:function(t,e){var n=t.data,r=e.data;return r[12]=n[12],r[13]=n[13],r[14]=n[14],e.onChange(e),e},Determinant:function(t){var e=f(t.data,16),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],h=e[7],c=e[8],d=e[9],l=e[10],v=e[11],p=e[12],y=e[13],x=e[14],m=e[15],w=l*m-x*v,g=d*m-y*v,b=d*x-y*l,M=c*m-p*v,_=c*x-l*p,C=c*y-p*d;return n*+(u*w-s*g+h*b)+r*-(a*w-s*M+h*_)+i*+(a*g-u*M+h*C)+o*-(a*b-u*_+s*C)},Equals:function(t,e){var n=f(t.data,16),r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],h=n[6],c=n[7],d=n[8],l=n[9],v=n[10],p=n[11],y=n[12],x=n[13],m=n[14],w=n[15],g=f(e.data,16),b=g[0],M=g[1],_=g[2],C=g[3],T=g[4],z=g[5],S=g[6],E=g[7],R=g[8],P=g[9],A=g[10],D=g[11],F=g[12],O=g[13],I=g[14],L=g[15];return r===b&&i===M&&o===_&&a===C&&u===T&&s===z&&h===S&&c===E&&d===R&&l===P&&v===A&&p===D&&y===F&&x===O&&m===I&&w===L},Frobenius:function(t){var e=f(t.data,16),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],h=e[7],c=e[8],d=e[9],l=e[10],v=e[11],p=e[12],y=e[13],x=e[14],m=e[15];return Math.hypot(n,r,i,o,a,u,s,h,c,d,l,v,p,y,x,m)},FromQuat:function(t,e){void 0===e&&(e=new x);var n=t.x,r=t.y,i=t.z,o=t.w,a=n+n,u=r+r,s=i+i,h=n*a,c=r*a,f=r*u,d=i*a,l=i*u,v=i*s,p=o*a,y=o*u,m=o*s;return e.set(1-f-v,c+m,d-y,0,c-m,1-h-v,l+p,0,d+y,l-p,1-h-f,0,0,0,0,1)},FromRotation:function(t,e,n){void 0===n&&(n=new x);var r=e.x,i=e.y,o=e.z,a=Math.hypot(r,i,o);if(a<1e-5)return null;r*=a=1/a,i*=a,o*=a;var u=Math.sin(t),s=Math.cos(t),h=1-s;return n.set(r*r*h+s,i*r*h+o*u,o*r*h-i*u,0,r*i*h-o*u,i*i*h+s,o*i*h+r*u,0,r*o*h+i*u,i*o*h-r*u,o*o*h+s,0,0,0,0,1)},FromRotationTranslation:function(t,e,n){void 0===n&&(n=new x);var r=t.x,i=t.y,o=t.z,a=t.w,u=r+r,s=i+i,h=o+o,c=r*u,f=r*s,d=r*h,l=i*s,v=i*h,p=o*h,y=a*u,m=a*s,w=a*h,g=e.x,b=e.y,M=e.z;return n.set(1-(l+p),f+w,d-m,0,f-w,1-(c+p),v+y,0,d+m,v-y,1-(c+l),0,g,b,M,1)},FromRotationTranslationScale:m,FromRotationTranslationScaleOrigin:function(t,e,n,r,i){void 0===i&&(i=new x);var o=t.x,a=t.y,u=t.z,s=t.w,h=o+o,c=a+a,f=u+u,d=o*h,l=o*c,v=o*f,p=a*c,y=a*f,m=u*f,w=s*h,g=s*c,b=s*f,M=n.x,_=n.y,C=n.z,T=r.x,z=r.y,S=r.z,E=e.x,R=e.y,P=e.z,A=(1-(p+m))*M,D=(l+b)*M,F=(v-g)*M,O=(l-b)*_,I=(1-(d+m))*_,L=(y+w)*_,B=(v+g)*C,k=(y-w)*C,G=(1-(d+p))*C;return i.set(A,D,F,0,O,I,L,0,B,k,G,0,E+T-(A*T+O*z+B*S),R+z-(D*T+I*z+k*S),P+S-(F*T+L*z+G*S),1)},FromRotationXYTranslation:w,FromScaling:function(t,e){void 0===e&&(e=new x);var n=t.x,r=t.y,i=t.z;return e.set(n,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1)},FromTranslation:function(t,e){void 0===e&&(e=new x);var n=t.x,r=t.y,i=t.z;return e.set(1,0,0,0,0,1,0,0,0,0,1,0,n,r,i,1)},FromXRotation:function(t,e){void 0===e&&(e=new x);var n=Math.cos(t),r=Math.sin(t);return e.set(1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1)},FromYRotation:function(t,e){void 0===e&&(e=new x);var n=Math.cos(t),r=Math.sin(t);return e.set(n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1)},FromZRotation:function(t,e){void 0===e&&(e=new x);var n=Math.cos(t),r=Math.sin(t);return e.set(n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1)},Frustum:function(t,e,n,r,i,o,a){void 0===a&&(a=new x);var u=1/(e-t),s=1/(r-n),h=1/(i-o);return a.set(2*i*u,0,0,0,0,2*i*s,0,0,(e+t)*u,(r+n)*s,(o+i)*h,-1,0,0,o*i*2*h,0)},GetRotation:function(t,e){void 0===e&&(e=new M);var n=b(t),r=1/n.x,i=1/n.y,o=1/n.z,a=f(t.data,11),u=a[0],s=a[1],h=a[2],c=(a[3],a[4]),d=a[5],l=a[6],v=(a[7],u*r),p=s*i,y=h*o,x=c*r,m=d*i,w=l*o,g=a[8]*r,_=a[9]*i,C=a[10]*o,T=v+m+C,z=0;return T>0?(z=2*Math.sqrt(T+1),e.set((w-_)/z,(g-y)/z,(p-x)/z,.25*z)):v>m&&v>C?(z=2*Math.sqrt(1+v-m-C),e.set(.25*z,(p+x)/z,(g+y)/z,(w-_)/z)):m>C?(z=2*Math.sqrt(1+m-v-C),e.set((p+x)/z,.25*z,(w+_)/z,(g-y)/z)):(z=2*Math.sqrt(1+C-v-m),e.set((g+y)/z,(w+_)/z,.25*z,(p-x)/z))},GetScaling:b,GetTranslation:function(t,e){void 0===e&&(e=new g);var n=t.data;return e.set(n[12],n[13],n[14])},Identity:_,Invert:C,LookAt:T,Matrix4:x,Multiply:z,MultiplyScalar:function(t,e,n){void 0===n&&(n=new x);var r=f(t.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],m=r[12],w=r[13],g=r[14],b=r[15];return n.set(i*e,o*e,a*e,u*e,s*e,h*e,c*e,d*e,l*e,v*e,p*e,y*e,m*e,w*e,g*e,b*e)},MultiplyScalarAndAdd:function(t,e,n,r){void 0===r&&(r=new x);var i=f(t.data,16),o=i[0],a=i[1],u=i[2],s=i[3],h=i[4],c=i[5],d=i[6],l=i[7],v=i[8],p=i[9],y=i[10],m=i[11],w=i[12],g=i[13],b=i[14],M=i[15],_=f(e.data,16),C=_[0],T=_[1],z=_[2],S=_[3],E=_[4],R=_[5],P=_[6],A=_[7],D=_[8],F=_[9],O=_[10],I=_[11],L=_[12],B=_[13],k=_[14],G=_[15];return r.set(o+C*n,a+T*n,u+z*n,s+S*n,h+E*n,c+R*n,d+P*n,l+A*n,v+D*n,p+F*n,y+O*n,m+I*n,w+L*n,g+B*n,b+k*n,M+G*n)},Ortho:S,Perspective:E,PerspectiveFromFieldOfView:function(t,e,n,r){void 0===r&&(r=new x);var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(a+u),h=2/(i+o);return r.set(s,0,0,0,0,h,0,0,-(a-u)*s*.5,(i-o)*h*.5,n/(e-n),-1,0,0,n*e/(e-n),0)},Rotate:function(t,e,n,r){void 0===r&&(r=new x);var i=n.x,o=n.y,a=n.z,u=Math.hypot(i,o,a);if(u<1e-5)return null;i*=u=1/u,o*=u,a*=u;var s=Math.sin(e),h=Math.cos(e),c=1-h,d=f(t.data,16),l=d[0],v=d[1],p=d[2],y=d[3],m=d[4],w=d[5],g=d[6],b=d[7],M=d[8],_=d[9],C=d[10],T=d[11],z=d[12],S=d[13],E=d[14],R=d[15],P=i*i*c+h,A=o*i*c+a*s,D=a*i*c-o*s,F=i*o*c-a*s,O=o*o*c+h,I=a*o*c+i*s,L=i*a*c+o*s,B=o*a*c-i*s,k=a*a*c+h;return r.set(l*P+m*A+M*D,v*P+w*A+_*D,p*P+g*A+C*D,y*P+b*A+T*D,l*F+m*O+M*I,v*F+w*O+_*I,p*F+g*O+C*I,y*F+b*O+T*I,l*L+m*B+M*k,v*L+w*B+_*k,p*L+g*B+C*k,y*L+b*B+T*k,z,S,E,R)},RotateX:function(t,e,n){void 0===n&&(n=new x);var r=Math.sin(e),i=Math.cos(e),o=f(t.data,16),a=o[0],u=o[1],s=o[2],h=o[3],c=o[4],d=o[5],l=o[6],v=o[7],p=o[8],y=o[9],m=o[10],w=o[11],g=o[12],b=o[13],M=o[14],_=o[15];return n.set(a,u,s,h,c*i+p*r,d*i+y*r,l*i+m*r,v*i+w*r,p*i-c*r,y*i-d*r,m*i-l*r,w*i-v*r,g,b,M,_)},RotateY:function(t,e,n){void 0===n&&(n=new x);var r=Math.sin(e),i=Math.cos(e),o=f(t.data,16),a=o[0],u=o[1],s=o[2],h=o[3],c=o[4],d=o[5],l=o[6],v=o[7],p=o[8],y=o[9],m=o[10],w=o[11],g=o[12],b=o[13],M=o[14],_=o[15];return n.set(a*i-p*r,u*i-y*r,s*i-m*r,h*i-w*r,c,d,l,v,a*r+p*i,u*r+y*i,s*r+m*i,h*r+w*i,g,b,M,_)},RotateZ:function(t,e,n){void 0===n&&(n=new x);var r=Math.sin(e),i=Math.cos(e),o=f(t.data,16),a=o[0],u=o[1],s=o[2],h=o[3],c=o[4],d=o[5],l=o[6],v=o[7],p=o[8],y=o[9],m=o[10],w=o[11],g=o[12],b=o[13],M=o[14],_=o[15];return n.set(a*i+c*r,u*i+d*r,s*i+l*r,h*i+v*r,c*i-a*r,d*i-u*r,l*i-s*r,v*i-h*r,p,y,m,w,g,b,M,_)},Scale:function(t,e,n){void 0===n&&(n=new x);var r=f(t.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],m=r[12],w=r[13],g=r[14],b=r[15],M=e.x,_=e.y,C=e.z;return n.set(i*M,o*M,a*M,u*M,s*_,h*_,c*_,d*_,l*C,v*C,p*C,y*C,m,w,g,b)},SetTranslation:function(t,e){var n=t.data,r=e.x,i=e.y,o=e.z;return n[12]=r,n[13]=i,n[14]=o,t.onChange(t),t},SetTranslationFromFloats:function(t,e,n,r){var i=t.data;return i[12]=e,i[13]=n,i[14]=r,t.onChange(t),t},Subtract:function(t,e,n){void 0===n&&(n=new x);var r=f(t.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],m=r[12],w=r[13],g=r[14],b=r[15],M=f(e.data,16),_=M[0],C=M[1],T=M[2],z=M[3],S=M[4],E=M[5],R=M[6],P=M[7],A=M[8],D=M[9],F=M[10],O=M[11],I=M[12],L=M[13],B=M[14],k=M[15];return n.set(i-_,o-C,a-T,u-z,s-S,h-E,c-R,d-P,l-A,v-D,p-F,y-O,m-I,w-L,g-B,b-k)},TargetTo:function(t,e,n,r){void 0===r&&(r=new x);var i=t.x,o=t.y,a=t.z,u=n.x,s=n.y,h=n.z,c=i-e.x,f=o-e.y,d=a-e.z,l=c*c+f*f+d*d;l>0&&(c*=l=1/Math.sqrt(l),f*=l,d*=l);var v=s*d-h*f,p=h*c-u*d,y=u*f-s*c;return(l=v*v+p*p+y*y)>0&&(v*=l=1/Math.sqrt(l),p*=l,y*=l),r.set(v,p,y,0,f*y-d*p,d*v-c*y,c*p-f*v,0,c,f,d,0,i,o,a,1)},Translate:function(t,e,n){void 0===n&&(n=new x);var r=e.x,i=e.y,o=e.z,a=t.data,u=f(a,16),s=u[0],h=u[1],c=u[2],d=u[3],l=u[4],v=u[5],p=u[6],y=u[7],m=u[8],w=u[9],g=u[10],b=u[11],M=u[12],_=u[13],C=u[14],T=u[15];return t===n?(a[12]=s*r+l*i+m*o+M,a[13]=h*r+v*i+w*o+_,a[14]=c*r+p*i+g*o+C,a[15]=d*r+y*i+b*o+T):n.set(s,h,c,d,l,v,p,y,m,w,g,b,s*r+l*i+m*o+M,h*r+v*i+w*o+_,c*r+p*i+g*o+C,d*r+y*i+b*o+T),n},TranslateFromFloats:R,Transpose:P,Zero:function(t){return t.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}),D=function(){function t(t,e,n,r,i,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.set(t,e,n,r,i,o)}return t.prototype.set=function(t,e,n,r,i,o){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o,this},t.prototype.identity=function(){return this.set()},t.prototype.toArray=function(){var t=this;return[t.a,t.b,t.c,t.d,t.tx,t.ty]},t.prototype.fromArray=function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5])},t}();function F(t,e,n){return!(t.width<=0||t.height<=0)&&(t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n)}var O=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.set(t,e,n,r)}return t.prototype.set=function(t,e,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=n,this.height=r,this},t.prototype.contains=function(t,e){return F(this,t,e)},Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y},enumerable:!1,configurable:!0}),t}(),I=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.set(t,e)}return t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e,this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.x,r=this.y;return t[e]=n,t[e+1]=r,t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.set(t[e],t[e+1])},t.prototype.toString=function(){return"{ x="+this.x+", y="+this.y+" }"},t}(),L=function(t){function e(e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=t.call(this,n,r)||this;return i.onChange=e,i}return h(e,t),e.prototype.destroy=function(){this.onChange=y},e.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this._x=t,this._y=e,this.onChange&&this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var e=this._x;this._x=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var e=this._y;this._y=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),e}(I);var B={PI2:2*Math.PI,HALF_PI:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};function k(t){return(t%=B.PI2)>=0?t:t+B.PI2}function G(t,e,n){var r=n-e;return e+((t-e)%r+r)%r}function j(t){return G(t,-Math.PI,Math.PI)}var U=Object.freeze({__proto__:null,AngleBetween:function(t,e,n,r){return Math.atan2(r-e,n-t)},AngleBetweenY:function(t,e,n,r){return Math.atan2(n-t,r-e)},CounterClockwise:function(t){return t>Math.PI&&(t-=B.PI2),Math.abs(((t+B.HALF_PI)%B.PI2-B.PI2)%B.PI2)},NormalizeAngle:k,ReverseAngle:function(t){return k(t+Math.PI)},RotateAngleTo:function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=B.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=B.PI2:e-=B.PI2),e>t?t+=n:e<t&&(t-=n))),t},ShortestAngleBetween:function(t,e){var n=e-t;return 0===n?0:n-360*Math.floor((n- -180)/360)},WrapAngle:j,WrapAngleDegrees:function(t){return G(t,-180,180)}}),V=function(){function t(){var t=this;this._rotation=0,this.type="Camera",this.dirtyRender=!0;var e=r();this.renderer=e.renderer,this.matrix=_(),this.bounds=new O,this.worldTransform=new D,this.position=new L((function(){return t.updateTransform()}),0,0),this.scale=new L((function(){return t.updateTransform()}),1,1),this.origin=new L((function(){return t.updateTransform()}),.5,.5),this.reset()}return t.prototype.updateTransform=function(){var t=this.matrix.data,e=this.position.x,n=this.position.y,r=this.scale.x,i=this.scale.y,o=-e+this.width*this.origin.x,a=-n+this.height*this.origin.y,u=Math.sin(this.rotation),s=Math.cos(this.rotation),h=u+u,c=u*h,f=s*h,d=(1-c)*r,l=f*r,v=-f*i,p=(1-c)*i;t[0]=d,t[1]=l,t[4]=v,t[5]=p,t[12]=e+o-(d*o+v*a),t[13]=n+a-(l*o+p*a),this.worldTransform.set(s*r,u*r,-u*i,s*i,-e,-n);var y=this.width*(1/r),x=this.height*(1/i);this.bounds.set(o-y/2,a-x/2,y,x),this.dirtyRender=!0},t.prototype.reset=function(){var t=this.renderer.width,e=this.renderer.height;this.width=t,this.height=e,this.bounds.set(0,0,t,e)},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){t!==this._rotation&&(this._rotation=j(t),this.updateTransform())},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.position.destroy(),this.scale.destroy(),this.origin.destroy(),this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null},t}(),N=function(){function t(){this.type="StaticCamera",this.dirtyRender=!0;var t=r();this.renderer=t.renderer,this.matrix=_(),this.bounds=new O,this.worldTransform=new D,this.reset()}return t.prototype.reset=function(){var t=this.renderer;if(t){var e=t.width,n=t.height;this.width=e,this.height=n}this.bounds.set(0,0,this.width,this.height)},t.prototype.destroy=function(){this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null},t}(),W=Object.freeze({__proto__:null,Camera:V,StaticCamera:N});function q(){return new g(0,0,-1)}function H(){return new g(0,-1,0)}function K(){return new g(0,0,1)}function X(){return new g(-1,0,0)}function Y(){return new g(1,0,0)}function Z(){return new g(0,1,0)}function J(){return new g(0,0,0)}var Q=Z(),$=H(),tt=X(),et=Y(),nt=K(),rt=q(),it=J();function ot(t,e,n){return void 0===n&&(n=new g),n.set(t.x+e.x,t.y+e.y,t.z+e.z)}function at(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function ut(t,e,n,r,i){var o=1-i,a=o*o,u=i*i;return t*(a*o)+e*(3*i*a)+n*(3*u*o)+r*(u*i)}function st(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),u=t*t;return(2*n-2*r+o+a)*(t*u)+(-3*n+3*r-2*o-a)*u+o*t+n}function ht(t,e,n){return void 0===n&&(n=new g),n.set(t.x*e,t.y*e,t.z*e)}function ct(t,e,n){return Math.max(e,Math.min(n,t))}function ft(t,e,n){void 0===n&&(n=new g);var r=t.x,i=t.y,o=t.z;return n.set(r/e,i/e,o/e)}function dt(t){var e=t.x,n=t.y,r=t.z;return Math.sqrt(e*e+n*n+r*r)}function lt(t,e,n){void 0===n&&(n=new g);var r=t.x,i=t.y,o=t.z,a=e.x,u=e.y,s=e.z,h=i*s-o*u,c=o*a-r*s,f=r*u-i*a,d=h*h+c*c+f*f;return d>0&&(d=1/Math.sqrt(d)),n.set(h*d,c*d,f*d)}function vt(t,e){var n=t.x-e.x,r=t.y-e.y,i=t.z-e.z;return n*n+r*r+i*i}function pt(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}function yt(t,e,n,r,i){var o=i*i;return t*(o*(2*i-3)+1)+e*(o*(i-2)+i)+n*(o*(i-1))+r*(o*(3-2*i))}function xt(t,e){void 0===e&&(e=new g);var n=t.x,r=t.y,i=t.z,o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e.set(n*o,r*o,i*o)}function mt(t,e,n){void 0===n&&(n=new g);var r=f(e.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],x=r[12],m=r[13],w=r[14],b=r[15],M=t.x,_=t.y,C=t.z,T=u*M+d*_+y*C+b;return T=T||1,n.set((i*M+s*_+l*C+x)/T,(o*M+h*_+v*C+m)/T,(a*M+c*_+p*C+w)/T)}var wt=new x,gt=new x;var bt=function(t){function e(e,n,r,i){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this,n,r,i)||this;return o.onChange=e,o}return h(e,t),e.prototype.destroy=function(){this.onChange=y},e.prototype.set=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._x=t,this._y=e,this._z=n,this.onChange&&this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var e=this._x;this._x=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var e=this._y;this._y=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){var e=this._z;this._z=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),e}(g),Mt=function(t){function e(e,n,r,i){return void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),t.call(this,e,n,r,i)||this}return h(e,t),Object.defineProperty(e.prototype,"r",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[ r="+this.x+", g="+this.y+", b="+this.z+" ]"},e}(bt);function _t(t,e,n){return void 0===n&&(n=new g),n.set(t.x-e.x,t.y-e.y,t.z-e.z)}function Ct(t,e,n,r){return void 0===r&&(r=new g),r.set(t.x+e.x*n,t.y+e.y*n,t.z+e.z*n)}function Tt(t,e,n){void 0===n&&(n=new g);var r=f(e.data,11),i=r[0],o=r[1],a=r[2],u=(r[3],r[4]),s=r[5],h=r[6],c=(r[7],r[8]),d=r[9],l=r[10],v=t.x,p=t.y,y=t.z;return n.set(i*v+u*p+c*y,o*v+s*p+d*y,a*v+h*p+l*y)}function zt(t,e,n){void 0===n&&(n=new g);var r=e.x,i=e.y,o=e.z,a=e.w,u=t.x,s=t.y,h=t.z,c=i*h-o*s,f=o*u-r*h,d=r*s-i*u,l=i*d-o*f,v=o*c-r*d,p=r*f-i*c,y=2*a;return c*=y,f*=y,d*=y,l*=2,v*=2,p*=2,n.set(u+c+l,s+f+v,h+d+p)}var St=new x,Et=new g;var Rt=Object.freeze({__proto__:null,Abs:function(t,e){return void 0===e&&(e=new g),e.set(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))},Add:ot,AddScalar:function(t,e,n){return void 0===n&&(n=new g),n.set(t.x+e,t.y+e,t.z+e)},Angle:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,u=e.z,s=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+u*u),h=s&&at(t,e)/s;return Math.acos(Math.min(Math.max(h,-1),1))},Backward:q,Bezier:function(t,e,n,r,i,o){return void 0===o&&(o=new g),o.set(ut(i,t.x,e.x,n.x,r.x),ut(i,t.y,e.y,n.y,r.y),ut(i,t.z,e.z,n.z,r.z))},CatmullRom:function(t,e,n,r,i,o){return void 0===o&&(o=new g),o.set(st(i,t.x,e.x,n.x,r.x),st(i,t.y,e.y,n.y,r.y),st(i,t.z,e.z,n.z,r.z))},Ceil:function(t,e){return void 0===e&&(e=new g),e.set(Math.ceil(t.x),Math.ceil(t.y),Math.ceil(t.z))},Center:function(t,e,n){return void 0===n&&(n=new g),ot(t,e,n),ht(n,.5,n)},Clamp:function(t,e,n,r){return void 0===r&&(r=new g),r.set(ct(t.x,e.x,n.x),ct(t.y,e.y,n.y),ct(t.z,e.z,n.z))},ClampLength:function(t,e,n,r){void 0===r&&(r=new g);var i=dt(t);return ft(t,i||1,r),ht(r,ct(e,n,i),r)},ClampScalar:function(t,e,n,r){return void 0===r&&(r=new g),r.set(ct(t.x,e,n),ct(t.y,e,n),ct(t.z,e,n))},Clone:function(t){var e=t.x,n=t.y,r=t.z;return new g(e,n,r)},CopyFrom:function(t,e){var n=t.x,r=t.y,i=t.z;return e.set(n,r,i)},Cross:function(t,e,n){void 0===n&&(n=new g);var r=t.x,i=t.y,o=t.z,a=e.x,u=e.y,s=e.z;return n.set(i*s-o*u,o*a-r*s,r*u-i*a)},CrossNormalize:lt,Distance:function(t,e){return Math.sqrt(vt(t,e))},DistanceSquared:vt,Divide:function(t,e,n){return void 0===n&&(n=new g),n.set(t.x/e.x,t.y/e.y,t.z/e.z)},DivideScalar:ft,Dot:at,Down:H,Equals:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z},Floor:function(t,e){return void 0===e&&(e=new g),e.set(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))},Forward:K,Fract:function(t,e){return void 0===e&&(e=new g),e.set(t.x-Math.floor(t.x),t.y-Math.floor(t.y),t.z-Math.floor(t.z))},FuzzyEquals:function(t,e,n){return void 0===n&&(n=1e-4),pt(t.x,e.x,n)&&pt(t.y,e.y,n)&&pt(t.z,e.z,n)},Hermite:function(t,e,n,r,i,o){return void 0===o&&(o=new g),o.set(yt(i,t.x,e.x,n.x,r.x),yt(i,t.y,e.y,n.y,r.y),yt(i,t.z,e.z,n.z,r.z))},Inverse:function(t,e){return void 0===e&&(e=new g),e.set(1/t.x,1/t.y,1/t.z)},IsNonUniform:function(t){var e=Math.abs(t.x),n=Math.abs(t.y),r=Math.abs(t.z);return e!==n||e!==r||n!==r},Left:X,Length:dt,LengthSquared:function(t){var e=t.x,n=t.y,r=t.z;return e*e+n*n+r*r},Lerp:function(t,e,n,r){void 0===r&&(r=new g);var i=t.x,o=t.y,a=t.z;return r.set(i+n*(e.x-i),o+n*(e.y-o),a+n*(e.z-a))},ManhattanDistance:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)+Math.abs(t.z-e.z)},ManhattanLength:function(t){return Math.abs(t.x)+Math.abs(t.y)+Math.abs(t.z)},Max:function(t,e,n){void 0===n&&(n=new g);var r=t.x,i=t.y,o=t.z,a=e.x,u=e.y,s=e.z;return n.set(Math.max(r,a),Math.max(i,u),Math.max(o,s))},Min:function(t,e,n){void 0===n&&(n=new g);var r=t.x,i=t.y,o=t.z,a=e.x,u=e.y,s=e.z;return n.set(Math.min(r,a),Math.min(i,u),Math.min(o,s))},Multiply:function(t,e,n){return void 0===n&&(n=new g),n.set(t.x*e.x,t.y*e.y,t.z*e.z)},MultiplyByFloats:function(t,e,n,r,i){return void 0===i&&(i=new g),i.set(t.x*e,t.y*n,t.z*r)},Negate:function(t,e){return void 0===e&&(e=new g),e.set(-t.x,-t.y,-t.z)},Normalize:xt,One:function(){return new g(1,1,1)},Project:function(t,e,n,r,i){void 0===i&&(i=new g);var o=r.x,a=r.y,u=r.width,s=r.height;return wt.set(u/2,0,0,0,0,-s/2,0,0,0,0,.5,0,o+u/2,s/2+a,.5,1),z(e,n,gt),z(gt,wt,gt),mt(t,gt,i)},Random:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=new g);var r=2*Math.random()*Math.PI,i=2*Math.random()-1,o=Math.sqrt(1-i*i)*e;return n.set(Math.cos(r)*o,Math.sin(r)*o,i*e)},Reflect:function(t,e,n){return void 0===n&&(n=new g),ht(e,2*at(t,e),n),_t(t,n,n)},RGBCallback:Mt,Right:Y,RotateX:function(t,e,n,r){void 0===r&&(r=new g);var i=t.x,o=t.y,a=t.z,u=e.x,s=e.y,h=e.z,c=o-s,f=a-h,d=i-u,l=c*Math.cos(n)-f*Math.sin(n),v=c*Math.sin(n)+f*Math.cos(n);return r.set(d+u,l+s,v+h)},RotateY:function(t,e,n,r){void 0===r&&(r=new g);var i=t.x,o=t.y,a=t.z,u=e.x,s=e.y,h=e.z,c=i-u,f=o-s,d=a-h,l=d*Math.sin(n)+c*Math.cos(n),v=f,p=d*Math.cos(n)-c*Math.sin(n);return r.set(l+u,v+s,p+h)},RotateZ:function(t,e,n,r){void 0===r&&(r=new g);var i=t.x,o=t.y,a=t.z,u=e.x,s=e.y,h=e.z,c=i-u,f=o-s,d=a-h,l=c*Math.cos(n)-f*Math.sin(n),v=c*Math.sin(n)+f*Math.cos(n),p=d;return r.set(l+u,v+s,p+h)},Round:function(t,e){return void 0===e&&(e=new g),e.set(Math.round(t.x),Math.round(t.y),Math.round(t.z))},RoundToZero:function(t,e){return void 0===e&&(e=new g),e.set(t.x<0?Math.ceil(t.x):Math.floor(t.x),t.y<0?Math.ceil(t.y):Math.floor(t.y),t.z<0?Math.ceil(t.z):Math.floor(t.z))},Scale:ht,ScaleAndAdd:Ct,SetFromCylindricalCoords:function(t,e,n,r){return void 0===r&&(r=new g),r.set(t*Math.sin(e),n,t*Math.cos(e))},SetFromSphericalCoords:function(t,e,n,r){void 0===r&&(r=new g);var i=Math.sin(e)*t;return r.set(i*Math.sin(n),Math.cos(e)*t,i*Math.cos(n))},SetLength:function(t,e,n){return void 0===n&&(n=new g),xt(t,n),ht(n,e,n)},Subtract:_t,SubtractScalar:function(t,e,n){return void 0===n&&(n=new g),n.set(t.x-e,t.y-e,t.z-e)},TransformMat4:mt,TransformMat4Zero:Tt,TransformQuat:zt,Unproject:function(t,e,n,r,i,o,a){void 0===a&&(a=new g),z(r,i,St),z(St,o,St),C(St,St);var u=t.x,s=t.y,h=t.z;Et.set(u/e*2-1,-(s/n*2-1),2*h-1),mt(Et,St,a);var c=St.data;return ht(a,1/(Et.x*c[3]+Et.y*c[7]+Et.z*c[11]+c[15]),a)},Up:Z,Vec3:g,Vec3Callback:bt,Zero:J,BACKWARD:rt,DOWN:$,FORWARD:nt,LEFT:tt,RIGHT:et,UP:Q,ZERO:it});function Pt(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}function At(t,e){var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(n,r,i,o)}function Dt(t,e,n,r){void 0===r&&(r=new M);var i=.5*n,o=.5*e,a=.5*t,u=Math.sin(i),s=Math.cos(i),h=Math.sin(o),c=Math.cos(o),f=Math.sin(a),d=Math.cos(a);return r.set(d*h*s+f*c*u,f*c*s-d*h*u,d*c*u-f*h*s,d*c*s+f*h*u)}function Ft(t,e){var n=Pt(t,e);return Math.acos(2*n*n-1)}function Ot(t){var e=t.x,n=t.y,r=t.z,i=t.w;return Math.sqrt(e*e+n*n+r*r+i*i)}function It(t,e,n){void 0===n&&(n=new M);var r=t.x,i=t.y,o=t.z,a=t.w;return n.set(r*e,i*e,o*e,a*e)}function Lt(t,e){void 0===e&&(e=new M);var n=Ot(t);return 0===n?e.set(0,0,0,1):It(t,n,e)}function Bt(t,e,n,r){if(void 0===r&&(r=new M),0===n)return At(t,r);if(1===n)return At(e,r);var i=t.x,o=t.y,a=t.z,u=t.w,s=e.x,h=e.y,c=e.z,f=e.w,d=u*f+i*s+o*h+a*c;if(d<0?(r.set(-s,-h,-c,-f),d=-d):At(e,r),d>=1)return r.set(i,o,a,u);var l=1-d*d;if(l<=Number.EPSILON){var v=1-n;return r.set(v*i+n*r.x,v*o+n*r.y,v*a+n*r.z,v*u+n*r.w),Lt(r,r)}var p=Math.sqrt(l),y=Math.atan2(p,d),x=Math.sin((1-n)*y)/p,m=Math.sin(n*y)/p;return r.set(i*x+r.x*m,o*x+r.y*m,a*x+r.z*m,u*x+r.w*m)}function kt(t,e,n){void 0===n&&(n=new M),e*=.5;var r=t.x,i=t.y,o=t.z,a=t.w,u=Math.sin(e),s=Math.cos(e);return n.set(r*s+a*u,i*s+o*u,o*s-i*u,a*s-r*u)}function Gt(t,e,n){void 0===n&&(n=new M),e*=.5;var r=t.x,i=t.y,o=t.z,a=t.w,u=Math.sin(e),s=Math.cos(e);return n.set(r*s-o*u,i*s+a*u,o*s+r*u,a*s-i*u)}function jt(t,e,n){void 0===n&&(n=new M),e*=.5;var r=t.x,i=t.y,o=t.z,a=t.w,u=Math.sin(e),s=Math.cos(e);return n.set(r*s+i*u,i*s-r*u,o*s+a*u,a*s-o*u)}function Ut(t,e,n){void 0===n&&(n=new M);var r=t.x,i=t.y,o=t.z;e*=.5;var a=Math.sin(e);return n.set(r*a,i*a,o*a,Math.cos(e))}var Vt=Object.freeze({__proto__:null,Add:function(t,e,n){return void 0===n&&(n=new M),n.set(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)},AddScalar:function(t,e,n){return void 0===n&&(n=new M),n.set(t.x+e,t.y+e,t.z+e,t.w+e)},AngleTo:function(t,e){return 2*Math.acos(Math.abs(ct(Pt(t,e),-1,1)))},AreClose:function(t,e){return Pt(t,e)>=0},Clone:function(t){var e=t.x,n=t.y,r=t.z,i=t.w;return new M(e,n,r,i)},Conjugate:function(t,e){void 0===e&&(e=new M);var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(-1*n,-1*r,-1*i,o)},CopyFrom:At,Dot:Pt,Equals:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},FromEulerAngles:function(t,e,n,r){return void 0===r&&(r=new M),Dt(e,t,n,r)},FromEulerVector:function(t,e){return void 0===e&&(e=new M),Dt(t.y,t.x,t.z,e)},FromRotationAxis:function(t,e,n){void 0===n&&(n=new M);var r=Math.sin(e/2);xt(t,t);var i=t.x,o=t.y,a=t.z;return n.set(i*r,o*r,a*r,Math.cos(e/2))},FromRotationMatrix:function(t,e){void 0===e&&(e=new M);var n,r=f(t.data,11),i=r[0],o=r[1],a=r[2],u=(r[3],r[4]),s=r[5],h=r[6],c=(r[7],r[8]),d=r[9],l=r[10],v=i+s+l;return v>0?(n=.5/Math.sqrt(v+1),e.set((h-d)*n,(c-a)*n,(o-u)*n,.25/n)):i>s&&i>l?(n=2*Math.sqrt(1+i-s-l),e.set(.25*n,(u+o)/n,(c+a)/n,(h-d)/n)):s>l?(n=2*Math.sqrt(1+s-i-l),e.set((u+o)/n,.25*n,(d+h)/n,(c-a)/n)):(n=2*Math.sqrt(1+l-i-s),e.set((c+a)/n,(d+h)/n,.25*n,(o-u)/n))},FuzzyEquals:function(t,e,n){return void 0===n&&(n=1e-4),pt(t.x,e.x,n)&&pt(t.y,e.y,n)&&pt(t.z,e.z,n)&&pt(t.w,e.w,n)},GetAngle:Ft,GetAxisAngle:function(t,e){void 0===e&&(e=new M);var n=2*Math.acos(t.w),r=Math.sin(n/2);return r>1e-6?e.set(t.x/r,t.y/r,t.z/r):e.set(1,0,0),n},Hermite:function(t,e,n,r,i,o){return void 0===o&&(o=new M),o.set(yt(i,t.x,e.x,n.x,r.x),yt(i,t.y,e.y,n.y,r.y),yt(i,t.z,e.z,n.z,r.z),yt(i,t.w,e.w,n.w,r.w))},Invert:function(t,e){void 0===e&&(e=new M);var n=t.x,r=t.y,i=t.z,o=t.w,a=n*n+r*r+i*i+o*o,u=a?1/a:0;return e.set(-n*u,-r*u,-i*u,o*u)},Length:Ot,LengthSquared:function(t){var e=t.x,n=t.y,r=t.z,i=t.w;return e*e+n*n+r*r+i*i},Multiply:function(t,e,n){void 0===n&&(n=new M);var r=t.x,i=t.y,o=t.z,a=t.w,u=e.x,s=e.y,h=e.z,c=e.w;return n.set(r*c+a*u+i*h-o*s,i*c+a*s+o*u-r*h,o*c+a*h+r*s-i*u,a*c-r*u-i*s-o*h)},MultiplyByFloats:function(t,e,n,r,i,o){return void 0===o&&(o=new M),o.set(t.x*e,t.y*n,t.z*r,t.w*i)},Normalize:Lt,Quaternion:M,RotateTowards:function(t,e,n,r){void 0===r&&(r=new M);var i=Ft(t,e);return 0===i?At(t,r):Bt(t,e,Math.min(1,n/i),r)},RotateX:kt,RotateY:Gt,RotateZ:jt,RotationAlphaBetaGamma:function(t,e,n,r){void 0===r&&(r=new M);var i=.5*(n+t),o=.5*(n-t),a=.5*e;return r.set(Math.cos(o)*Math.sin(a),Math.sin(o)*Math.sin(a),Math.sin(i)*Math.cos(a),Math.cos(i)*Math.cos(a))},RotationYawPitchRoll:Dt,Scale:It,ScaleAndAdd:function(t,e,n,r){return void 0===r&&(r=new M),r.set(t.x+e.x*n,t.y+e.y*n,t.z+e.z*n,t.w+e.w*n)},SetAxisAngle:Ut,SetFromUnitVectors:function(t,e,n,r){void 0===r&&(r=new M);var i=e.x,o=e.y,a=e.z,u=n.x,s=n.y,h=n.z,c=at(e,n)+1;return c<1e-6?(c=0,Math.abs(i)>Math.abs(a)?r.set(-o,i,0,c):r.set(0,-a,o,c)):r.set(o*h-a*s,a*u-i*h,i*s-o*u,c)},Slerp:Bt,Subtract:function(t,e,n){return void 0===n&&(n=new M),n.set(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)},SubtractScalar:function(t,e,n){void 0===n&&(n=new M);var r=t.x,i=t.y,o=t.z,a=t.w;return n.set(r-e,i-e,o-e,a-e)},ToEulerAngles:function(t,e){void 0===e&&(e=new g);var n=t.x,r=t.y,i=t.z,o=t.w,a=o*o,u=i*i,s=n*n,h=r*r,c=r*i-n*o;return c<-.4999999?e.set(Math.PI/2,2*Math.atan2(r,o),0):c>.4999999?e.set(-Math.PI/2,2*Math.atan2(r,o),0):e.set(Math.asin(-2*(i*r-n*o)),Math.atan2(2*(i*n+r*o),u-s-h+a),Math.atan2(2*(n*r+i*o),-u-s+h+a))},Zero:function(){return new M(0,0,0,0)}});function Nt(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}function Wt(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)}function qt(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}var Ht=Object.freeze({__proto__:null,In:Nt,InOut:Wt,Out:qt});function Kt(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}function Xt(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}function Yt(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}var Zt=Object.freeze({__proto__:null,In:Kt,InOut:Xt,Out:Yt});function Jt(t){return 1-Math.sqrt(1-t*t)}function Qt(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}function $t(t){return Math.sqrt(1- --t*t)}var te=Object.freeze({__proto__:null,In:Jt,InOut:Qt,Out:$t});function ee(t){return t*t*t}function ne(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}function re(t){return--t*t*t+1}var ie=Object.freeze({__proto__:null,In:ee,InOut:ne,Out:re});function oe(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var r=n/4;return e<1?e=1:r=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n)}function ae(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var r=n/4;return e<1?e=1:r=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n)*.5+1}function ue(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var r=n/4;return e<1?e=1:r=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-r)*(2*Math.PI)/n)+1}var se=Object.freeze({__proto__:null,In:oe,InOut:ae,Out:ue});function he(t){return Math.pow(2,10*(t-1))-.001}function ce(t){return 0==t?0:1==t?1:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}function fe(t){return 1-Math.pow(2,-10*t)}var de=Object.freeze({__proto__:null,In:he,InOut:ce,Out:fe});function le(t){return t*t}function ve(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}function pe(t){return t*(2-t)}var ye=Object.freeze({__proto__:null,In:le,InOut:ve,Out:pe});function xe(t){return t*t*t*t}function me(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}function we(t){return-(--t*t*t*t-1)}var ge=Object.freeze({__proto__:null,In:xe,InOut:me,Out:we});function be(t){return t*t*t*t*t}function Me(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}function _e(t){return(t-=1)*t*t*t*t+1}var Ce=Object.freeze({__proto__:null,In:be,InOut:Me,Out:_e});function Te(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}function ze(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}function Se(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}var Ee=Object.freeze({__proto__:null,In:Te,InOut:ze,Out:Se});function Re(t){return t}var Pe=Object.freeze({__proto__:null,Linear:Re});function Ae(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}var De=Object.freeze({__proto__:null,Stepped:Ae}),Fe=new Map([["power0",Re],["power1",pe],["power2",re],["power3",we],["power4",_e],["linear",Re],["quad",pe],["cubic",re],["quart",we],["quint",_e],["sine",Se],["expo",fe],["circ",$t],["elastic",ue],["back",qt],["bounce",Yt],["stepped",Ae],["quad.in",le],["cubic.in",ee],["quart.in",xe],["quint.in",be],["sine.in",Te],["expo.in",he],["circ.in",Jt],["elastic.in",oe],["back.in",Nt],["bounce.in",Kt],["quad.out",pe],["cubic.out",re],["quart.out",we],["quint.out",_e],["sine.out",Se],["expo.out",fe],["circ.out",$t],["elastic.out",ue],["back.out",qt],["bounce.out",Yt],["quad.inout",ve],["cubic.inout",ne],["quart.inout",me],["quint.inout",Me],["sine.inout",ze],["expo.inout",ce],["circ.inout",Qt],["elastic.inout",ae],["back.inout",Wt],["bounce.inout",Xt]]);var Oe=Object.freeze({__proto__:null,GetEase:function(t){return t=(t=t.toLowerCase()).replace("ease",""),Fe.has(t)?Fe.get(t):Re}}),Ie=Object.freeze({__proto__:null,Back:Ht,Bounce:Zt,Circular:te,Cubic:ie,Elastic:se,Expo:de,GetEase:Oe,Linear:Pe,Quadratic:ye,Quartic:ge,Quintic:Ce,Sine:Ee,Stepped:De});var Le=Object.freeze({__proto__:null,FuzzyCeil:function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)},FuzzyEqual:pt,FuzzyFloor:function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)},FuzzyGreaterThan:function(t,e,n){return void 0===n&&(n=1e-4),t>e-n},FuzzyLessThan:function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}});function Be(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}function ke(t,e){return Be(t)/Be(e)/Be(t-e)}function Ge(t,e,n){return(e-t)*n+t}function je(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)}function Ue(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}var Ve=Object.freeze({__proto__:null,BezierInterpolation:function(t,e){for(var n=0,r=t.length-1,i=0;i<=r;i++)n+=Math.pow(1-e,r-i)*Math.pow(e,i)*t[i]*ke(r,i);return n},CatmullRomInterpolation:function(t,e){var n=t.length-1,r=n*e,i=Math.floor(r);return t[0]===t[n]?(e<0&&(i=Math.floor(r=n*(1+e))),st(r-i,t[(i-1+n)%n],t[i],t[(i+1)%n],t[(i+2)%n])):e<0?t[0]-(st(-r,t[0],t[0],t[1],t[1])-t[0]):e>1?t[n]-(st(r-n,t[n],t[n],t[n-1],t[n-1])-t[n]):st(r-i,t[i?i-1:0],t[i],t[n<i+1?n:i+1],t[n<i+2?n:i+2])},CubicBezierInterpolation:function(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)},LinearInterpolation:function(t,e){var n=t.length-1,r=n*e,i=Math.floor(r);return e<0?Ge(t[0],t[1],r):e>1?Ge(t[n],t[n-1],n-r):Ge(t[i],t[i+1>n?n:i+1],r-i)},QuadraticBezierInterpolation:function(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)},SmoothStepInterpolation:function(t,e,n){return e+(n-e)*je(t,0,1)},SmootherStepInterpolation:function(t,e,n){return e+(n-e)*Ue(t,0,1)}});function Ne(t,e,n){void 0===n&&(n=new D);var r=t.a,i=t.b,o=t.c,a=t.d,u=t.tx,s=t.ty,h=e.a,c=e.b,f=e.c,d=e.d,l=e.tx,v=e.ty;return n.set(h*r+c*o,h*i+c*a,f*r+d*o,f*i+d*a,l*r+v*o+u,l*i+v*a+s)}function We(t,e){var n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,u=t.ty;return e.set(n,r,i,o,a,u)}function qe(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty}function He(t,e,n){void 0===n&&(n=new D);var r=t.a,i=t.b,o=t.c,a=t.d,u=t.tx,s=t.ty,h=Math.sin(e),c=Math.cos(e);return n.set(r*c+o*h,i*c+a*h,r*-h+o*c,i*-h+a*c,u,s)}function Ke(t,e,n,r){void 0===r&&(r=new D);var i=t.a,o=t.b,a=t.c,u=t.d,s=t.tx,h=t.ty;return r.set(i*e,o*e,a*n,u*n,s,h)}function Xe(t,e,n,r){void 0===r&&(r=new D);var i=t.a,o=t.b,a=t.c,u=t.d,s=t.tx,h=t.ty;return r.tx=i*e+a*n+s,r.ty=o*e+u*n+h,r}function Ye(t,e,n,r){void 0===r&&(r=new I);var i=t.a,o=t.b,a=t.c,u=t.d,s=t.tx,h=t.ty,c=1/(i*u+a*-o);return r.set(u*c*e+-a*c*n+(h*a-s*u)*c,i*c*n+-o*c*e+(-h*i+s*o)*c)}var Ze=Object.freeze({__proto__:null,Add:function(t,e,n){return void 0===n&&(n=new D),n.set(t.a+e.a,t.b+e.b,t.c+e.c,t.d+e.d,t.tx+e.tx,t.ty+e.ty)},Append:Ne,Clone:function(t){return new D(t.a,t.b,t.c,t.d,t.tx,t.ty)},CopyFrom:We,CopyToContext:function(t,e){var n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,u=t.ty;return e.transform(n,r,i,o,a,u),e},Determinant:function(t){var e=t.a,n=t.b,r=t.c;return e*t.d-n*r},Equals:function(t,e,n){void 0===n&&(n=1e-6);var r=t.a,i=t.b,o=t.c,a=t.d,u=t.tx,s=t.ty,h=e.a,c=e.b,f=e.c,d=e.d,l=e.tx,v=e.ty;return Math.abs(r-h)<=n*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-c)<=n*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-f)<=n*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-d)<=n*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-l)<=n*Math.max(1,Math.abs(u),Math.abs(l))&&Math.abs(s-v)<=n*Math.max(1,Math.abs(s),Math.abs(v))},ExactEquals:qe,Frobenius:function(t){return Math.hypot(t.a,t.b,t.c,t.d,t.tx,t.ty,1)},FromRotation:function(t){var e=new D;return He(e,t,e)},FromScaling:function(t,e){void 0===e&&(e=t);var n=new D;return Ke(n,t,e,n)},FromTranslation:function(t,e){var n=new D;return Xe(n,t,e,n)},GlobalToLocal:Ye,Identity:function(){return new D},Invert:function(t,e){void 0===e&&(e=new D);var n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,u=t.ty,s=n*o-r*i;return s&&(s=1/s,e.set(o*s,-r*s,-i*s,n*s,(i*u-o*a)*s,(r*a-n*u)*s)),e},ITRS:function(t,e,n,r,i,o){if(0===r)return t.set(1,0,0,1,e,n);var a=Math.sin(r),u=Math.cos(r);return t.set(u*i,a*i,-a*o,u*o,e,n)},ITRSS:function(t,e,n,r,i,o,a,u){return void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=0),void 0===u&&(u=0),0===r?t.set(1,0,0,1,e,n):t.set(Math.cos(r+u)*i,Math.sin(r+u)*i,-Math.sin(r-a)*o,Math.cos(r-a)*o,e,n)},LocalToGlobal:function(t,e,n,r){void 0===r&&(r=new I);var i=t.a,o=t.b,a=t.c,u=t.d,s=t.tx,h=t.ty;return r.set(i*e+a*n+s,o*e+u*n+h)},Matrix2D:D,Multiply:function(t,e,n){void 0===n&&(n=new D);var r=t.a,i=t.b,o=t.c,a=t.d,u=t.tx,s=t.ty,h=e.a,c=e.b,f=e.c,d=e.d,l=e.tx,v=e.ty;return n.set(r*h+o*c,i*h+a*c,r*f+o*d,i*f+a*d,r*l+o*v+u,i*l+a*v+s)},MultiplyScalar:function(t,e,n){void 0===n&&(n=new D);var r=t.a,i=t.b,o=t.c,a=t.d,u=t.tx,s=t.ty;return n.set(r*e,i*e,o*e,a*e,u*e,s*e)},MultiplyScalarAndAdd:function(t,e,n,r){void 0===r&&(r=new D);var i=e.a,o=e.b,a=e.c,u=e.d,s=e.tx,h=e.ty,c=t.a,f=t.b,d=t.c,l=t.d,v=t.tx,p=t.ty;return r.set(c+i*n,f+o*n,d+a*n,l+u*n,v+s*n,p+h*n)},Rotate:He,Scale:Ke,SetToContext:function(t,e){var n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,u=t.ty;return e.setTransform(n,r,i,o,a,u),e},Skew:function(t,e,n,r){void 0===r&&(r=new D);var i=t.a,o=t.b,a=t.c,u=t.d,s=t.tx,h=t.ty;return r.set(i,o+Math.tan(e),a+Math.tan(n),u,s,h)},Subtract:function(t,e,n){return void 0===n&&(n=new D),n.set(t.a-e.a,t.b-e.b,t.c-e.c,t.d-e.d,t.tx-e.tx,t.ty-e.ty)},Translate:Xe,Zero:function(t){return t.set(0,0,0,0,0,0)}});function Je(t,e){return!(t<1||e<1)&&(0==(t&t-1)&&0==(e&e-1))}var Qe=Object.freeze({__proto__:null,GetPowerOfTwo:function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)},IsSizePowerOfTwo:Je,IsValuePowerOfTwo:function(t){return t>0&&0==(t&t-1)}});var $e=Object.freeze({__proto__:null,SnapCeil:function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=!1),0===e?t:(t-=n,t=e*Math.ceil(t/e),r?(n+t)/e:n+t)},SnapFloor:function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=!1),0===e?t:(t-=n,t=e*Math.floor(t/e),r?(n+t)/e:n+t)},SnapTo:function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=!1),0===e?t:(t-=n,t=e*Math.round(t/e),r?(n+t)/e:n+t)}});function tn(t,e,n){return void 0===n&&(n=new I),n.set(t.x+e.x,t.y+e.y)}function en(t,e,n){return void 0===n&&(n=new I),n.set(t.x*e,t.y*e)}function nn(t,e){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function rn(t,e){return Math.sqrt(nn(t,e))}function on(t,e){return t.x*e.x+t.y*e.y}function an(t,e,n,r){return void 0===r&&(r=new I),r.set(t.x*e,t.y*n)}function un(t,e,n){return void 0===n&&(n=new I),n.set(t.x-e.x,t.y-e.y)}function sn(t,e,n){return void 0===n&&(n=new I),n.set(t.x/e,t.y/e)}function hn(t,e,n,r,i,o,a,u){void 0===u&&(u=new I);var s=Math.sin(i),h=Math.cos(i),c=h*o,f=s*o,d=-s*a,l=h*a,v=1/(c*l+d*-f);return u.set(l*v*t+-d*v*e+(r*d-n*l)*v,c*v*e+-f*v*t+(-r*c+n*f)*v)}function cn(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function fn(t,e){return void 0===e&&(e=new I),sn(t,cn(t)||1,e)}var dn=Object.freeze({__proto__:null,Abs:function(t,e){return void 0===e&&(e=new I),e.set(Math.abs(t.x),Math.abs(t.y))},Add:tn,AddScalar:function(t,e,n){return void 0===n&&(n=new I),n.set(t.x+e,t.y+e)},Angle:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},AngleY:function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)},Bezier:function(t,e,n,r,i,o){return void 0===o&&(o=new I),o.set(ut(i,t.x,e.x,n.x,r.x),ut(i,t.y,e.y,n.y,r.y))},CatmullRom:function(t,e,n,r,i,o){return void 0===o&&(o=new I),o.set(st(i,t.x,e.x,n.x,r.x),st(i,t.y,e.y,n.y,r.y))},Ceil:function(t,e){return void 0===e&&(e=new I),e.set(Math.ceil(t.x),Math.ceil(t.y))},Center:function(t,e,n){return void 0===n&&(n=new I),tn(t,e,n),en(n,.5,n)},ChebyshevDistance:function(t,e){return Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))},Clamp:function(t,e,n,r){return void 0===r&&(r=new I),r.set(ct(t.x,e.x,n.x),ct(t.y,e.y,n.y))},ClampScalar:function(t,e,n,r){return void 0===r&&(r=new I),r.set(ct(t.x,e,n),ct(t.y,e,n))},Clone:function(t){return new I(t.x,t.y)},CopyFrom:function(t,e){return e.set(t.x,t.y)},Cross:function(t,e){return t.x*e.y-t.y*e.x},Distance:rn,DistanceFromSegment:function(t,e,n){if(0===nn(e,n))return rn(t,e);var r=un(n,e);un(t,e,t);var i=Math.max(0,Math.min(1,on(t,r)/12));return rn(t,tn(e,an(r,i,i,r)))},DistancePower:function(t,e,n){return void 0===n&&(n=2),Math.sqrt(Math.pow(e.x-t.x,n)+Math.pow(e.y-t.y,n))},DistanceSquared:nn,Divide:function(t,e,n){return void 0===n&&(n=new I),n.set(t.x/e.x,t.y/e.y)},DivideScalar:sn,Dot:on,Equals:function(t,e){return t.x===e.x&&t.y===e.y},Floor:function(t,e){return void 0===e&&(e=new I),e.set(Math.floor(t.x),Math.floor(t.y))},Fract:function(t,e){return void 0===e&&(e=new I),e.set(t.x-Math.floor(t.x),t.y-Math.floor(t.y))},FromGridIndex:function(t,e,n,r){void 0===r&&(r=new I);var i=0,o=0;return t>0&&t<=e*n&&(i=t>e-1?t-(o=Math.floor(t/e))*e:t,r.set(i,o)),r},FromTransform:hn,FuzzyEquals:function(t,e,n){return void 0===n&&(n=1e-4),pt(t.x,e.x,n)&&pt(t.y,e.y,n)},Hermite:function(t,e,n,r,i,o){return void 0===o&&(o=new I),o.set(yt(i,t.x,e.x,n.x,r.x),yt(i,t.y,e.y,n.y,r.y))},Inverse:function(t,e){return void 0===e&&(e=new I),e.set(1/t.x,1/t.y)},Length:cn,LengthSquared:function(t){return t.x*t.x+t.y*t.y},Lerp:function(t,e,n,r){void 0===r&&(r=new I);var i=t.x,o=t.y;return r.set(i+n*(e.x-i),o+n*(e.y-o))},ManhattanDistance:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},ManhattanLength:function(t){return Math.abs(t.x)+Math.abs(t.y)},Max:function(t,e,n){void 0===n&&(n=new I);var r=t.x,i=t.y,o=e.x,a=e.y;return n.set(Math.max(r,o),Math.max(i,a))},Min:function(t,e,n){void 0===n&&(n=new I);var r=t.x,i=t.y,o=e.x,a=e.y;return n.set(Math.min(r,o),Math.min(i,a))},Multiply:function(t,e,n){return void 0===n&&(n=new I),n.set(t.x*e.x,t.y*e.y)},MultiplyByFloats:an,Negate:function(t,e){return void 0===e&&(e=new I),e.set(-t.x,-t.y)},Normalize:fn,One:function(){return new I(1,1)},PerpDot:function(t,e){return t.x*e.y-t.y*e.x},Random:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=new I);var r=2*Math.random()*Math.PI;return n.set(Math.cos(r)*e,Math.sin(r)*e)},Rotate:function(t,e,n,r){void 0===r&&(r=new I);var i=Math.sin(n),o=Math.cos(n),a=t.x-e.x,u=t.y-e.y;return r.set(a*o-u*i+e.x,a*i+u*o+e.y)},Round:function(t,e){return void 0===e&&(e=new I),e.set(Math.round(t.x),Math.round(t.y))},RoundToZero:function(t,e){return void 0===e&&(e=new I),e.set(t.x<0?Math.ceil(t.x):Math.floor(t.x),t.y<0?Math.ceil(t.y):Math.floor(t.y))},Scale:en,ScaleAndAdd:function(t,e,n,r){return void 0===r&&(r=new I),r.set(t.x+e.x*n,t.y+e.y*n)},SetLength:function(t,e,n){return void 0===n&&(n=new I),fn(t,n),en(n,e,n)},Subtract:un,SubtractScalar:function(t,e,n){return void 0===n&&(n=new I),n.set(t.x-e,t.y-e)},Transform:function(t,e,n,r,i,o,a){return void 0===a&&(a=new I),hn(t.x,t.y,e,n,r,i,o,a)},TransformMat2d:function(t,e,n){void 0===n&&(n=new I);var r=e.a,i=e.b,o=e.c,a=e.d,u=e.tx,s=e.ty;return n.set(r*t.x+o*t.y+u,i*t.x+a*t.y+s)},TransformMat4:function(t,e,n){void 0===n&&(n=new I);var r=e.data;return n.set(r[0]*t.x+r[4]*t.y+r[12],r[1]*t.x+r[5]*t.y+r[13])},Vec2:I,Vec2Callback:L,Zero:function(){return new I(0,0)}}),ln=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this.set(t,e,n,r)}return t.prototype.set=function(t,e,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this.x=t,this.y=e,this.z=n,this.w=r,this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.x,r=this.y,i=this.z,o=this.w;return t[e]=n,t[e+1]=r,t[e+2]=i,t[e+3]=o,t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.set(t[e],t[e+1],t[e+2],t[e+3])},t.prototype.toString=function(){return"{ x="+this.x+", y="+this.y+", z="+this.z+", w="+this.w+" }"},t}();function vn(t,e,n){return void 0===n&&(n=new ln),n.set(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)}function pn(t,e,n){void 0===n&&(n=new ln);var r=t.x,i=t.y,o=t.z,a=t.w;return n.set(r*e,i*e,o*e,a*e)}function yn(t,e,n){void 0===n&&(n=new ln);var r=t.x,i=t.y,o=t.z,a=t.w;return n.set(r/e,i/e,o/e,a/e)}function xn(t){var e=t.x,n=t.y,r=t.z,i=t.w;return Math.sqrt(e*e+n*n+r*r+i*i)}function mn(t,e){var n=t.x-e.x,r=t.y-e.y,i=t.z-e.z,o=t.w-e.w;return n*n+r*r+i*i+o*o}function wn(t,e){return void 0===e&&(e=new ln),yn(t,xn(t)||1,e)}var gn=function(t){function e(e,n,r,i,o){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0);var a=t.call(this,n,r,i,o)||this;return a.onChange=e,a}return h(e,t),e.prototype.destroy=function(){this.onChange=y},e.prototype.set=function(t,e,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this._x=t,this._y=e,this._z=n,this._w=r,this.onChange&&this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var e=this._x;this._x=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var e=this._y;this._y=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){var e=this._z;this._z=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._w},set:function(t){var e=this._w;this._w=t,e!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),e}(ln),bn=function(t){function e(e,n,r,i,o){return void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=1),t.call(this,e,n,r,i,o)||this}return h(e,t),Object.defineProperty(e.prototype,"r",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[ r="+this.x+", g="+this.y+", b="+this.z+", a="+this.w+" ]"},e}(gn);var Mn=Object.freeze({__proto__:null,Abs:function(t,e){return void 0===e&&(e=new ln),e.set(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z),Math.abs(t.w))},Add:vn,AddScalar:function(t,e,n){return void 0===n&&(n=new ln),n.set(t.x+e,t.y+e,t.z+e,t.w+e)},Bezier:function(t,e,n,r,i,o){return void 0===o&&(o=new ln),o.set(ut(i,t.x,e.x,n.x,r.x),ut(i,t.y,e.y,n.y,r.y),ut(i,t.z,e.z,n.z,r.z),ut(i,t.w,e.w,n.w,r.w))},CatmullRom:function(t,e,n,r,i,o){return void 0===o&&(o=new ln),o.set(st(i,t.x,e.x,n.x,r.x),st(i,t.y,e.y,n.y,r.y),st(i,t.z,e.z,n.z,r.z),st(i,t.w,e.w,n.w,r.w))},Ceil:function(t,e){void 0===e&&(e=new ln);var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(Math.ceil(n),Math.ceil(r),Math.ceil(i),Math.ceil(o))},Center:function(t,e,n){return void 0===n&&(n=new ln),vn(t,e,n),pn(n,.5,n)},Clamp:function(t,e,n,r){return void 0===r&&(r=new ln),r.set(ct(t.x,e.x,n.x),ct(t.y,e.y,n.y),ct(t.z,e.z,n.z),ct(t.w,e.w,n.w))},ClampLength:function(t,e,n,r){void 0===r&&(r=new ln);var i=xn(t);return yn(t,i||1,r),pn(r,ct(e,n,i),r)},ClampScalar:function(t,e,n,r){return void 0===r&&(r=new ln),r.set(ct(t.x,e,n),ct(t.y,e,n),ct(t.z,e,n),ct(t.w,e,n))},Clone:function(t){var e=t.x,n=t.y,r=t.z,i=t.w;return new ln(e,n,r,i)},CopyFrom:function(t,e){var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(n,r,i,o)},Cross:function(t,e,n,r){void 0===r&&(r=new ln);var i=t.x,o=t.y,a=t.z,u=t.w,s=e.x,h=e.y,c=e.z,f=e.w,d=n.x,l=n.y,v=n.z,p=n.w,y=s*l-h*d,x=s*v-c*d,m=s*p-f*d,w=h*v-c*l,g=h*p-f*l,b=c*p-f*v,M=i,_=o,C=a,T=u;return r.set(_*b-C*g+T*w,-M*b+C*m-T*x,M*g-_*m+T*y,-M*w+_*x-C*y)},Distance:function(t,e){return Math.sqrt(mn(t,e))},DistanceSquared:mn,Divide:function(t,e,n){return void 0===n&&(n=new ln),n.set(t.x/e.x,t.y/e.y,t.z/e.z,t.w/e.w)},DivideScalar:yn,Dot:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w},Equals:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},Floor:function(t,e){void 0===e&&(e=new ln);var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(Math.floor(n),Math.floor(r),Math.floor(i),Math.floor(o))},Fract:function(t,e){return void 0===e&&(e=new ln),e.set(t.x-Math.floor(t.x),t.y-Math.floor(t.y),t.z-Math.floor(t.z),t.w-Math.floor(t.w))},FuzzyEquals:function(t,e,n){return void 0===n&&(n=1e-4),pt(t.x,e.x,n)&&pt(t.y,e.y,n)&&pt(t.z,e.z,n)&&pt(t.w,e.w,n)},Hermite:function(t,e,n,r,i,o){return void 0===o&&(o=new ln),o.set(yt(i,t.x,e.x,n.x,r.x),yt(i,t.y,e.y,n.y,r.y),yt(i,t.z,e.z,n.z,r.z),yt(i,t.w,e.w,n.w,r.w))},Length:xn,LengthSquared:function(t){var e=t.x,n=t.y,r=t.z,i=t.w;return e*e+n*n+r*r+i*i},Lerp:function(t,e,n,r){void 0===r&&(r=new ln);var i=t.x,o=t.y,a=t.z,u=t.w;return r.set(i+n*(e.x-i),o+n*(e.y-o),a+n*(e.z-a),u+n*(e.w-u))},ManhattanDistance:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)+Math.abs(t.z-e.z)+Math.abs(t.w-e.w)},ManhattanLength:function(t){var e=t.x,n=t.y,r=t.z,i=t.w;return Math.abs(e)+Math.abs(n)+Math.abs(r)+Math.abs(i)},Max:function(t,e,n){void 0===n&&(n=new ln);var r=t.x,i=t.y,o=t.z,a=t.w,u=e.x,s=e.y,h=e.z,c=e.w;return n.set(Math.max(r,u),Math.max(i,s),Math.max(o,h),Math.max(a,c))},Min:function(t,e,n){void 0===n&&(n=new ln);var r=t.x,i=t.y,o=t.z,a=t.w,u=e.x,s=e.y,h=e.z,c=e.w;return n.set(Math.min(r,u),Math.min(i,s),Math.min(o,h),Math.min(a,c))},Multiply:function(t,e,n){return void 0===n&&(n=new ln),n.set(t.x*e.x,t.y*e.y,t.z*e.z,t.w*e.w)},MultiplyByFloats:function(t,e,n,r,i,o){return void 0===o&&(o=new ln),o.set(t.x*e,t.y*n,t.z*r,t.w*i)},Negate:function(t,e){return void 0===e&&(e=new ln),e.set(-t.x,-t.y,-t.z,-t.w)},Normalize:wn,One:function(){return new ln(1,1,1,1)},RGBACallback:bn,Random:function(t,e,n){var r,i,o,a,u,s;void 0===e&&(e=1),void 0===n&&(n=new ln);do{u=(r=2*Math.random()-1)*r+(i=2*Math.random()-1)*i}while(u>=1);do{s=(o=2*Math.random()-1)*o+(a=2*Math.random()-1)*a}while(s>=1);var h=Math.sqrt((1-u)/s);return n.set(e*r,e*i,e*o*h,e*a*h)},Round:function(t,e){void 0===e&&(e=new ln);var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(Math.round(n),Math.round(r),Math.round(i),Math.round(o))},RoundToZero:function(t,e){void 0===e&&(e=new ln);var n=t.x,r=t.y,i=t.z,o=t.w;return e.set(n<0?Math.ceil(n):Math.floor(n),r<0?Math.ceil(r):Math.floor(r),i<0?Math.ceil(i):Math.floor(i),o<0?Math.ceil(o):Math.floor(o))},Scale:pn,ScaleAndAdd:function(t,e,n,r){return void 0===r&&(r=new ln),r.set(t.x+e.x*n,t.y+e.y*n,t.z+e.z*n,t.w+e.w*n)},SetLength:function(t,e,n){return void 0===n&&(n=new ln),wn(t,n),pn(n,e,n)},Subtract:function(t,e,n){return void 0===n&&(n=new ln),n.set(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)},SubtractScalar:function(t,e,n){void 0===n&&(n=new ln);var r=t.x,i=t.y,o=t.z,a=t.w;return n.set(r-e,i-e,o-e,a-e)},TransformMat4:function(t,e,n){void 0===n&&(n=new ln);var r=f(e.data,16),i=r[0],o=r[1],a=r[2],u=r[3],s=r[4],h=r[5],c=r[6],d=r[7],l=r[8],v=r[9],p=r[10],y=r[11],x=r[12],m=r[13],w=r[14],g=r[15],b=t.x,M=t.y,_=t.z,C=t.w;return n.set(i*b+s*M+l*_+x*C,o*b+h*M+v*_+m*C,a*b+c*M+p*_+w*C,u*b+d*M+y*_+g*C)},Vec4:ln,Vec4Callback:gn,Zero:function(){return new ln(0,0,0,0)}});function _n(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function Cn(t){return t*B.DEG_TO_RAD}function Tn(t,e,n){return(n-e)*(t=ct(t,0,1))}var zn=Object.freeze({__proto__:null,Angle:U,Easing:Ie,Average:function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length},Bernstein:ke,Between:_n,Bezier:ut,CatmullRom:st,CeilTo:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var r=Math.pow(n,-e);return Math.ceil(t*r)/r},Clamp:ct,DegToRad:Cn,Difference:function(t,e){return Math.abs(t-e)},Factorial:Be,FloatBetween:function(t,e){return Math.random()*(e-t)+t},FloorTo:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var r=Math.pow(n,-e);return Math.floor(t*r)/r},FromPercent:Tn,Fuzzy:Le,GetSpeed:function(t,e){return t/e/1e3},Hermite:yt,Interpolation:Ve,Linear:Ge,MATH_CONST:B,Matrix2D:Ze,Matrix4:A,MaxAdd:function(t,e,n){return Math.min(t+e,n)},MinSub:function(t,e,n){return Math.max(t-e,n)},Percent:function(t,e,n,r){void 0===n&&(n=e+1);var i=(t-e)/(n-e);return i>1?void 0!==r?(i=(r-t)/(r-n))<0&&(i=0):i=1:i<0&&(i=0),i},Pow2:Qe,Quaternion:Vt,RadToDeg:function(t){return t*B.RAD_TO_DEG},RoundAwayFromZero:function(t){return t>0?Math.ceil(t):Math.floor(t)},RoundTo:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var r=Math.pow(n,-e);return Math.round(t*r)/r},SinCosTableGenerator:function(t,e,n,r){void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=1),r*=Math.PI/t;for(var i=[],o=[],a=0;a<t;a++)e+=(n-=e*r)*r,i[a]=n,o[a]=e;return{sin:o,cos:i,length:t}},SmootherStep:Ue,SmoothStep:je,Snap:$e,Vec2:dn,Vec3:Rt,Vec4:Mn,Within:function(t,e,n){return Math.abs(t-e)<=n},Wrap:G}),Sn=function(){function t(t,e,n,i,o,a){var u=this;void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=45),void 0===o&&(o=.1),void 0===a&&(a=1e3),this.dirtyRender=!0,this.type="Camera3D";var s=r();this.renderer=s.renderer,this.position=new bt((function(){return u.update()}),t,e,n),this.direction=new bt((function(){return u.update()}),0,1,0),this._lookAtPosition=new g,this._lookAtView=new x,this._axis=new M,this.up=Z(),this.left=X(),this._fov=i,this._near=o,this._far=a,this.aspectRatio=this.renderer.width/this.renderer.height,this.viewMatrix=new x,this.projectionMatrix=E(Cn(i),this.aspectRatio,o,a),this.lookAt(new g)}return t.prototype.updateProjectionMatrix=function(){return E(Cn(this._fov),this.aspectRatio,this._near,this._far,this.projectionMatrix),this},t.prototype.lookAt=function(t){var e=this.position,n=this.direction,r=this.left;return _t(t,e,n),xt(n,n),lt(Q,n,r),lt(n,r,this.up),this.update()},t.prototype.rotateOnAxis=function(t,e){var n=this.direction,r=this.left,i=this.up,o=Ut(t,e,this._axis);return zt(n,o,n),zt(r,o,r),zt(i,o,i),xt(i,i),xt(r,r),xt(n,n),this.update()},t.prototype.yaw=function(t){return this.rotateOnAxis(this.up,t)},t.prototype.pitch=function(t){return this.rotateOnAxis(this.left,t)},t.prototype.roll=function(t){return this.rotateOnAxis(this.direction,t)},t.prototype.forward=function(t){var e=this.position,n=e.x,r=e.y,i=e.z,o=this.direction,a=o.x,u=o.y,s=o.z;return e.set(n-t*a,r-t*u,i-t*s),this.update()},t.prototype.update=function(){var t=this._lookAtPosition,e=this._lookAtView,n=this.position;return ot(n,this.direction,t),T(n,t,this.up,e),R(e,-n.x,-n.y,-n.z,this.viewMatrix),this},t.prototype.reset=function(){},t.prototype.destroy=function(){this.position.destroy(),this.direction.destroy(),this.up=null,this.left=null,this.viewMatrix=null,this.projectionMatrix=null,this._lookAtPosition=null,this._lookAtView=null,this._axis=null},Object.defineProperty(t.prototype,"fov",{get:function(){return this._fov},set:function(t){t>0&&t<180&&(this._fov=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"near",{get:function(){return this._near},set:function(t){t>0&&(this._near=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"far",{get:function(){return this._far},set:function(t){t>0&&(this._far=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),t}(),En=Object.freeze({__proto__:null,Camera3D:Sn}),Rn="BackgroundColor",Pn="BatchSize",An="DefaultOrigin",Dn="MaxTextures",Fn="Parent",On="Size",In="Scenes",Ln="Renderer",Bn="WebGLContext",kn="CanvasContext",Gn="Banner",jn=new Map;function Un(t){jn.set(Rn,t)}function Vn(t,e,n,r,i){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n=""),void 0===r&&(r="#fff"),void 0===i&&(i="linear-gradient(#3e0081 40%, #00bcc3)"),jn.set(Gn,{title:t,version:e,url:n,color:r,background:i})}function Nn(t){jn.set(Pn,t)}function Wn(){return jn.get(On).height}function qn(){return jn.get(On).resolution}function Hn(){return jn.get(On).width}function Kn(t,e,n){void 0===t&&(t=800),void 0===e&&(e=600),void 0===n&&(n=1),0===n&&(n=window.devicePixelRatio),jn.set(On,{width:t,height:e,resolution:n})}var Xn=[],Yn=function(t,e){Xn.push({texture:t,glConfig:e})},Zn=function(){return Xn},Jn=function(){Xn.length=0};function Qn(){return jn.get(Rn)}var $n,tr=function(){function t(){this.clearBeforeRender=!0,this.optimizeRedraw=!0,this.autoResize=!0,this.width=Hn(),this.height=Wn(),this.resolution=qn(),this.setBackgroundColor(Qn());var t=document.createElement("canvas");this.canvas=t,this.initContext()}return t.prototype.initContext=function(){var t=this.canvas.getContext("2d",jn.get(kn));this.ctx=t,this.resize(this.width,this.height,this.resolution)},t.prototype.resize=function(t,e,n){void 0===n&&(n=1),this.width=t*n,this.height=e*n,this.resolution=n;var r=this.canvas;r.width=this.width,r.height=this.height,this.autoResize&&(r.style.width=(this.width/n).toString()+"px",r.style.height=(this.height/n).toString()+"px")},t.prototype.setBackgroundColor=function(t){var e=t>>16&255,n=t>>8&255,r=255&t,i=t>16777215?t>>>24:255;return this.clearColor="rgba("+e+", "+n+", "+r+", "+i+")",this},t.prototype.reset=function(){var t=this.ctx;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0)},t.prototype.render=function(t){Jn();var e=this.ctx;this.optimizeRedraw&&0===t.numDirtyFrames&&0===t.numDirtyCameras||(this.reset(),this.clearBeforeRender&&(e.clearRect(0,0,this.width,this.height),e.fillStyle=this.clearColor,e.fillRect(0,0,this.width,this.height)))},t.prototype.destroy=function(){},t}();function er(t){jn.set(Ln,t)}function nr(t,e){void 0===t&&(t=.5),void 0===e&&(e=t),jn.set(An,{x:t,y:e})}function rr(t){jn.set(Dn,t)}function ir(t){var e;return t&&("string"==typeof t?e=document.getElementById(t):"object"==typeof t&&1===t.nodeType&&(e=t)),e||(e=document.body),e}var or={get:function(){return $n},set:function(t){$n=t}};function ar(t,e){if(e||(e=t.currentViewport)){var n=$n.getParameter($n.VIEWPORT);n[0]===e.x&&n[1]===e.y&&n[2]===e.width&&n[3]===e.height||$n.viewport(e.x,e.y,e.width,e.height)}}function ur(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0);var o=function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0);var o=new O(e,n,r,i);return t.viewportStack.push(o),o}(t,e,n,r,i);ar(t,o),t.currentViewport=o}function sr(t,e,n){void 0===e&&(e=!0),n||(n=t.currentFramebuffer);var r=n.framebuffer,i=n.viewport;$n.bindFramebuffer($n.FRAMEBUFFER,r),e&&($n.clearColor(0,0,0,0),$n.clear($n.COLOR_BUFFER_BIT|$n.DEPTH_BUFFER_BIT)),i&&ur(t,i.x,i.y,i.width,i.height)}function hr(t){var e=t.framebufferStack;e.length>1&&(t.currentFramebuffer.viewport&&function(t){var e=t.viewportStack;e.length>1&&e.pop(),t.currentViewport=e[e.length-1],ar(t)}(t),e.pop()),t.currentFramebuffer=e[e.length-1],sr(t,!1)}function cr(t,e,n,r){void 0===n&&(n=!0);var i=function(t,e,n){var r={framebuffer:e,viewport:n};return t.framebufferStack.push(r),r}(t,e,r);sr(t,n,i),t.currentFramebuffer=i}function fr(t,e){e&&(t.count=e);var n=t.count;return 0!==n&&(function(t){var e=t.count;if(0!==e){var n=t.currentVertexBuffer,r=t.currentShader,i=r.shader.renderToFramebuffer;if(i&&cr(t,r.shader.framebuffer,!0),e===n.batchSize){var o=n.isDynamic?$n.DYNAMIC_DRAW:$n.STATIC_DRAW;$n.bufferData($n.ARRAY_BUFFER,n.data,o)}else{var a=n.indexed?e*n.entryElementSize:e*n.vertexElementSize,u=n.vertexViewF32.subarray(0,a);$n.bufferSubData($n.ARRAY_BUFFER,0,u)}n.indexed?$n.drawElements($n.TRIANGLES,e*n.entryIndexSize,$n.UNSIGNED_SHORT,0):$n.drawArrays($n.TRIANGLES,0,e),i&&hr(t)}}(t),t.prevCount=n,t.count=0,t.flushTotal++,!0)}function dr(t){var e=t.parent,n=t.flipY,r=t.unpackPremultiplyAlpha,i=t.minFilter,o=t.magFilter,a=t.wrapS,u=t.wrapT,s=t.generateMipmap,h=t.isPOT,c=e.image,f=e.width,d=e.height,l=$n.createTexture();return $n.activeTexture($n.TEXTURE0),$n.bindTexture($n.TEXTURE_2D,l),$n.pixelStorei($n.UNPACK_FLIP_Y_WEBGL,n),$n.pixelStorei($n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),c?($n.texImage2D($n.TEXTURE_2D,0,$n.RGBA,$n.RGBA,$n.UNSIGNED_BYTE,c),f=c.width,d=c.height):$n.texImage2D($n.TEXTURE_2D,0,$n.RGBA,f,d,0,$n.RGBA,$n.UNSIGNED_BYTE,null),$n.texParameteri($n.TEXTURE_2D,$n.TEXTURE_MIN_FILTER,i),$n.texParameteri($n.TEXTURE_2D,$n.TEXTURE_MAG_FILTER,o),$n.texParameteri($n.TEXTURE_2D,$n.TEXTURE_WRAP_S,a),$n.texParameteri($n.TEXTURE_2D,$n.TEXTURE_WRAP_T,u),s&&h&&$n.generateMipmap($n.TEXTURE_2D),t.texture=l,l}function lr(t){$n&&$n.isFramebuffer(t)&&$n.deleteFramebuffer(t)}function vr(t){$n.isTexture(t)&&$n.deleteTexture(t)}function pr(t,e){void 0===e&&(e=!0),$n.activeTexture($n.TEXTURE0),$n.bindTexture($n.TEXTURE_2D,t);var n=e?$n.LINEAR:$n.NEAREST;$n.texParameteri($n.TEXTURE_2D,$n.TEXTURE_MIN_FILTER,n),$n.texParameteri($n.TEXTURE_2D,$n.TEXTURE_MAG_FILTER,n)}function yr(t){var e=t.parent.image,n=e.width,r=e.height;return n>0&&r>0&&($n.activeTexture($n.TEXTURE0),$n.bindTexture($n.TEXTURE_2D,t.texture),$n.pixelStorei($n.UNPACK_FLIP_Y_WEBGL,t.flipY),$n.texImage2D($n.TEXTURE_2D,0,$n.RGBA,$n.RGBA,$n.UNSIGNED_BYTE,e)),t.texture}var xr=function(){function t(t,e){void 0===e&&(e={}),this.index=0,this.indexCounter=-1,this.dirtyIndex=!0,this.unpackPremultiplyAlpha=!0,this.flipY=!1,this.isPOT=!1,this.generateMipmap=!1,this.parent=t,this.isPOT=Je(t.width,t.height);var n=e.texture,r=void 0===n?null:n,i=e.framebuffer,o=void 0===i?null:i,a=e.depthbuffer,u=void 0===a?null:a,s=e.unpackPremultiplyAlpha,h=void 0===s||s,c=e.minFilter,f=void 0===c?this.isPOT?$n.LINEAR_MIPMAP_LINEAR:$n.LINEAR:c,d=e.magFilter,l=void 0===d?$n.LINEAR:d,v=e.wrapS,p=void 0===v?$n.CLAMP_TO_EDGE:v,y=e.wrapT,x=void 0===y?$n.CLAMP_TO_EDGE:y,m=e.generateMipmap,w=void 0===m?this.isPOT:m,g=e.flipY,b=void 0!==g&&g;this.minFilter=f,this.magFilter=l,this.wrapS=p,this.wrapT=x,this.generateMipmap=w,this.flipY=b,this.unpackPremultiplyAlpha=h,o&&(this.framebuffer=o),u&&(this.depthbuffer=u),r?this.texture=r:dr(this)}return t.prototype.setFilter=function(t){this.texture&&pr(this.texture,t)},t.prototype.create=function(){var t=this.texture;return t&&vr(t),dr(this)},t.prototype.update=function(){return this.texture?yr(this):dr(this)},t.prototype.setIndex=function(t){this.dirtyIndex=t!==this.index,this.index=t},t.prototype.destroy=function(){vr(this.texture),lr(this.framebuffer),this.parent=null,this.texture=null,this.framebuffer=null},t}();function mr(){return jn.get(Dn)}var wr=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function gr(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}function br(t){var e=function(t){for(var e=$n.createShader($n.FRAGMENT_SHADER);;){var n=wr.replace(/%forloop%/gi,gr(t));if($n.shaderSource(e,n),$n.compileShader(e),$n.getShaderParameter(e,$n.COMPILE_STATUS))break;t=t/2|0}return t}($n.getParameter($n.MAX_TEXTURE_IMAGE_UNITS)),n=mr();0===n||n>0&&n>e?rr(e):n>0&&n<e&&(e=Math.max(8,n));var r=t.tempTextures;r.length&&r.forEach((function(t){$n.deleteTexture(t)}));for(var i=[],o=0;o<e;o++){var a=$n.createTexture();$n.activeTexture($n.TEXTURE0+o),$n.bindTexture($n.TEXTURE_2D,a),$n.texImage2D($n.TEXTURE_2D,0,$n.RGBA,1,1,0,$n.RGBA,$n.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),r[o]=a,i.push(o)}t.maxTextures=e,t.textureIndex=i,t.currentActiveTexture=1}function Mr(t){$n.isBuffer(t)&&$n.deleteBuffer(t)}var _r=function(){function t(t){void 0===t&&(t={}),this.indexed=!1,this.isDynamic=!1,this.count=0,this.offset=0;var e=t.batchSize,n=void 0===e?1:e,r=t.dataSize,i=void 0===r?4:r,o=t.isDynamic,a=void 0===o||o,u=t.elementsPerEntry,s=void 0===u?4:u,h=t.vertexElementSize,c=void 0===h?6:h;this.batchSize=n,this.dataSize=i,this.vertexElementSize=c,this.isDynamic=a,this.elementsPerEntry=s,this.vertexByteSize=c*i,this.entryByteSize=this.vertexByteSize*s,this.bufferByteSize=n*this.entryByteSize,this.create()}return t.prototype.resize=function(t){this.batchSize=t,this.bufferByteSize=t*this.entryByteSize,this.vertexBuffer&&Mr(this.vertexBuffer),this.create()},t.prototype.create=function(){var t=new ArrayBuffer(this.bufferByteSize);this.data=t,this.vertexViewF32=new Float32Array(t),this.vertexViewU32=new Uint32Array(t),this.vertexBuffer=$n.createBuffer(),$n.bindBuffer($n.ARRAY_BUFFER,this.vertexBuffer);var e=this.isDynamic?$n.DYNAMIC_DRAW:$n.STATIC_DRAW;$n.bufferData($n.ARRAY_BUFFER,t,e),$n.bindBuffer($n.ARRAY_BUFFER,null)},t.prototype.add=function(t){this.count+=t,this.offset+=this.vertexElementSize*t},t.prototype.reset=function(){this.count=0,this.offset=0},t.prototype.canContain=function(t){return this.count+t<=this.batchSize},t.prototype.free=function(){return Math.max(0,1-this.count/this.batchSize)},t.prototype.bind=function(){$n.bindBuffer($n.ELEMENT_ARRAY_BUFFER,null),$n.bindBuffer($n.ARRAY_BUFFER,this.vertexBuffer)},t.prototype.destroy=function(){Mr(this.vertexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexBuffer=null},t}(),Cr=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this,r=e.indexSize,i=void 0===r?4:r,o=e.entryIndexSize,a=void 0===o?6:o,u=e.indexLayout,s=void 0===u?null:u;n.indexed=!0,n.indexSize=i,n.entryIndexSize=a,n.entryElementSize=n.vertexElementSize*n.elementsPerEntry;var h=[];if(s){n.indexLayout=s;for(var c=0;c<n.batchSize*i;c+=i)for(var f=0;f<s.length;f++)h.push(c+s[f])}return n.create(),n.createIndexBuffer(h),n}return h(e,t),e.prototype.createIndexBuffer=function(t){this.index=new Uint16Array(t),this.indexBuffer=$n.createBuffer(),$n.bindBuffer($n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),$n.bufferData($n.ELEMENT_ARRAY_BUFFER,this.index,$n.STATIC_DRAW),$n.bindBuffer($n.ELEMENT_ARRAY_BUFFER,null),t=[]},e.prototype.bind=function(){$n.bindBuffer($n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),$n.bindBuffer($n.ARRAY_BUFFER,this.vertexBuffer)},e.prototype.destroy=function(){t.prototype.destroy.call(this),Mr(this.indexBuffer),this.index=null,this.indexLayout=null,this.indexBuffer=null},e}(_r);function Tr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach((function(t){$n.deleteShader(t)}))}function zr(t,e){var n=$n.createShader(e);if($n.shaderSource(n,t),$n.compileShader(n),!$n.getShaderParameter(n,$n.COMPILE_STATUS)){var r=$n.getShaderInfoLog(n),i=t.split("\n").map((function(t,e){return e+": "+t}));return console.error("Error compiling shader: "+r,i.join("\n")),$n.deleteShader(n),null}return n}function Sr(t,e,n){switch(void 0===n&&(n=!1),t.type){case $n.INT:case $n.BOOL:return n?function(t){$n.uniform1iv(e,t)}:function(t){$n.uniform1i(e,t)};case $n.INT_VEC2:case $n.BOOL_VEC2:return function(t){$n.uniform2iv(e,t)};case $n.INT_VEC3:case $n.BOOL_VEC3:return function(t){$n.uniform3iv(e,t)};case $n.INT_VEC4:case $n.BOOL_VEC4:return function(t){$n.uniform4iv(e,t)};case $n.FLOAT:return n?function(t){$n.uniform1fv(e,t)}:function(t){$n.uniform1f(e,t)};case $n.FLOAT_VEC2:return function(t){$n.uniform2fv(e,t)};case $n.FLOAT_VEC3:return function(t){$n.uniform3fv(e,t)};case $n.FLOAT_VEC4:return function(t){$n.uniform4fv(e,t)};case $n.FLOAT_MAT2:return function(t){$n.uniformMatrix2fv(e,!1,t)};case $n.FLOAT_MAT3:return function(t){$n.uniformMatrix3fv(e,!1,t)};case $n.FLOAT_MAT4:return function(t){$n.uniformMatrix4fv(e,!1,t)};case $n.SAMPLER_2D:case $n.SAMPLER_CUBE:return t.size>1?function(t){$n.uniform1iv(e,t)}:function(t){$n.uniform1i(e,t)}}}var Er={aVertexPosition:{size:2,type:5126,normalized:!1,offset:0},aTextureCoord:{size:2,type:5126,normalized:!1,offset:8},aTextureId:{size:1,type:5126,normalized:!1,offset:16},aTintColor:{size:4,type:5121,normalized:!0,offset:20}},Rr={uProjectionMatrix:new Float32Array,uCameraMatrix:new Float32Array,uTexture:0};function Pr(t,e,n){$n.bindFramebuffer($n.FRAMEBUFFER,t);var r=$n.createRenderbuffer();return $n.bindRenderbuffer($n.RENDERBUFFER,r),$n.renderbufferStorage($n.RENDERBUFFER,$n.DEPTH_COMPONENT16,e,n),$n.framebufferRenderbuffer($n.FRAMEBUFFER,$n.DEPTH_ATTACHMENT,$n.RENDERBUFFER,r),$n.bindFramebuffer($n.FRAMEBUFFER,null),r}function Ar(t,e){e||(e=$n.COLOR_ATTACHMENT0);var n=$n.createFramebuffer();return $n.bindFramebuffer($n.FRAMEBUFFER,n),$n.framebufferTexture2D($n.FRAMEBUFFER,e,$n.TEXTURE_2D,t,0),$n.bindFramebuffer($n.FRAMEBUFFER,null),n}var Dr=function(){function t(t,e,n,r,i,o){this.trimmed=!1,this.texture=t,this.key=e,this.x=n,this.y=r,this.width=i,this.height=o,this.sourceSizeWidth=i,this.sourceSizeHeight=o,this.updateUVs()}return t.prototype.setPivot=function(t,e){this.pivot={x:t,y:e}},t.prototype.setSize=function(t,e){this.width=t,this.height=e,this.sourceSizeWidth=t,this.sourceSizeHeight=e,this.updateUVs()},t.prototype.setSourceSize=function(t,e){this.sourceSizeWidth=t,this.sourceSizeHeight=e},t.prototype.setTrim=function(t,e,n,r,i,o){this.trimmed=!0,this.sourceSizeWidth=t,this.sourceSizeHeight=e,this.spriteSourceSizeX=n,this.spriteSourceSizeY=r,this.spriteSourceSizeWidth=i,this.spriteSourceSizeHeight=o},t.prototype.getExtent=function(t,e){var n,r,i,o,a=this.sourceSizeWidth,u=this.sourceSizeHeight;return this.trimmed?(r=(n=this.spriteSourceSizeX-t*a)+this.spriteSourceSizeWidth,o=(i=this.spriteSourceSizeY-e*u)+this.spriteSourceSizeHeight):(r=(n=-t*a)+a,o=(i=-e*u)+u),{left:n,right:r,top:i,bottom:o}},t.prototype.setExtent=function(t){var e,n,r,i,o=t.transform,a=o.origin.x,u=o.origin.y,s=this.sourceSizeWidth,h=this.sourceSizeHeight;this.trimmed?(e=this.spriteSourceSizeX-a*s,n=this.spriteSourceSizeY-u*h,r=this.spriteSourceSizeWidth,i=this.spriteSourceSizeHeight):(e=-a*s,n=-u*h,r=s,i=h),o.setExtent(e,n,r,i)},t.prototype.updateUVs=function(){var t=this.x,e=this.y,n=this.width,r=this.height,i=this.texture.width,o=this.texture.height;this.u0=t/i,this.v0=e/o,this.u1=(t+n)/i,this.v1=(e+r)/o},t}(),Fr=function(){function t(t,e,n,r){this.key="",t&&(e=t.width,n=t.height),this.image=t,this.width=e,this.height=n,this.frames=new Map,this.data={},this.addFrame("__BASE",0,0,e,n),Yn(this,r)}return t.prototype.addFrame=function(t,e,n,r,i){if(this.frames.has(t))return null;var o=new Dr(this,t,e,n,r,i);return this.frames.set(t,o),this.firstFrame&&"__BASE"!==this.firstFrame.key||(this.firstFrame=o),o},t.prototype.getFrame=function(t){if(!t)return this.firstFrame;t instanceof Dr&&(t=t.key);var e=this.frames.get(t);return e||(console.warn("Frame missing: "+t),e=this.firstFrame),e},t.prototype.setSize=function(t,e){this.width=t,this.height=e,this.frames.get("__BASE").setSize(t,e)},t.prototype.destroy=function(){this.binding&&this.binding.destroy(),this.frames.clear(),this.data=null,this.image=null,this.firstFrame=null},t}(),Or=function(){function t(t){this.renderToFramebuffer=!1,this.renderToDepthbuffer=!1,t&&this.fromConfig(t)}return t.prototype.fromConfig=function(t){var e=t.attributes,n=void 0===e?Er:e,r=t.fragmentShader,i=void 0===r?"#define SHADER_NAME SINGLE_QUAD_FRAG\n\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nuniform sampler2D uTexture;\n\nvoid main (void)\n{\n    vec4 color = texture2D(uTexture, vTextureCoord);\n\n    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);\n}":r,o=t.height,a=void 0===o?Wn():o,u=t.renderToFramebuffer,s=void 0!==u&&u,h=t.renderToDepthbuffer,c=void 0!==h&&h,f=t.resolution,d=void 0===f?qn():f,l=t.vertexShader,v=void 0===l?"#define SHADER_NAME SINGLE_QUAD_VERT\n\nprecision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aTextureId;\nattribute vec4 aTintColor;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uCameraMatrix;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nvoid main (void)\n{\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vTintColor = aTintColor;\n\n    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);\n}":l,p=t.width,y=void 0===p?Hn():p,x=t.uniforms,m=void 0===x?Rr:x;if(this.create(i,v,m,n),s){this.renderToFramebuffer=!0;var w=new Fr(null,y*d,a*d),g=new xr(w);w.binding=g,g.framebuffer=Ar(g.texture),c&&(this.renderToDepthbuffer=!0,g.depthbuffer=Pr(g.framebuffer,w.width,w.height)),this.texture=w,this.framebuffer=g.framebuffer}},t.prototype.create=function(t,e,n,r){var i,o,a=zr(t,$n.FRAGMENT_SHADER),u=zr(e,$n.VERTEX_SHADER);if(a&&u){var s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=$n.createProgram();t.forEach((function(t){$n.attachShader(n,t)})),$n.linkProgram(n);var r=$n.getProgramParameter(n,$n.LINK_STATUS);if(!r){var i=$n.getProgramInfoLog(n);return console.error("Error linking program: "+i),$n.deleteProgram(n),Tr.apply(void 0,d(t)),null}return n}(a,u);if(s){var h=$n.getParameter($n.CURRENT_PROGRAM);$n.useProgram(s),this.program=s,this.uniformSetters=function(t){for(var e=new Map,n=$n.getProgramParameter(t,$n.ACTIVE_UNIFORMS),r=0;r<n;r++){var i=$n.getActiveUniform(t,r),o=i.name;if(!o.startsWith("gl_")&&!o.startsWith("webgl_")){var a=$n.getUniformLocation(t,i.name);if(a){var u=!1;"[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3),u=i.size>1),e.set(o,Sr(i,a,u))}}}return e}(s),this.uniforms=new Map;try{for(var l=c(Object.entries(n)),v=l.next();!v.done;v=l.next()){var p=f(v.value,2),y=p[0],x=p[1];this.uniforms.set(y,x)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}this.attributes=function(t,e){for(var n=new Map,r={size:1,type:$n.FLOAT,normalized:!1,stride:0,offset:0},i=$n.getProgramParameter(t,$n.ACTIVE_ATTRIBUTES),o=0;o<i;o++){var a=$n.getActiveAttrib(t,o);if(!a)break;var u=a.name,s=$n.getAttribLocation(t,u);$n.enableVertexAttribArray(s);var h=e.hasOwnProperty(u)?e[u]:{},c=h.size,f=void 0===c?r.size:c,d=h.type,l=void 0===d?r.type:d,v=h.normalized,p=void 0===v?r.normalized:v,y=h.stride,x=void 0===y?r.stride:y,m=h.offset,w=void 0===m?r.offset:m;n.set(u,{index:s,size:f,type:l,normalized:p,stride:x,offset:w})}return n}(s,r),$n.useProgram(h)}}},t.prototype.updateUniforms=function(t){},t.prototype.bind=function(t){return this.updateUniforms(t),this.setUniforms(t)},t.prototype.setUniform=function(t,e){var n=this.uniforms;n.has(t)&&(n.set(t,e),this.uniformSetters.get(t)(e))},t.prototype.setUniforms=function(t){var e,n;if(!this.program)return!1;$n.useProgram(this.program);var r=this.uniforms;try{for(var i=c(this.uniformSetters.entries()),o=i.next();!o.done;o=i.next()){var a=f(o.value,2),u=a[0];(0,a[1])(r.get(u))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!0},t.prototype.setAttributes=function(t){if(this.program){var e=t.currentVertexBuffer.vertexByteSize;this.attributes.forEach((function(t){$n.vertexAttribPointer(t.index,t.size,t.type,t.normalized,e,t.offset)}))}},t.prototype.destroy=function(){Tr(this.program),vr(this.texture),lr(this.framebuffer),this.uniforms.clear(),this.uniformSetters.clear(),this.attributes.clear(),this.program=null,this.texture=null,this.framebuffer=null},t}(),Ir=function(t){function e(e){void 0===e&&(e={});var n=e;return n.attributes=n.attributes?n.attributes:Er,t.call(this,n)||this}return h(e,t),e.prototype.bind=function(e){var n=this.uniforms;return n.set("uProjectionMatrix",e.projectionMatrix.data),n.set("uCameraMatrix",e.cameraMatrix.data),t.prototype.bind.call(this,e)},e}(Or),Lr=(function(t){function e(e){void 0===e&&(e={});var n=e;return n.attributes=n.attributes?n.attributes:Er,n.renderToFramebuffer=!0,t.call(this,n)||this}h(e,t),e.prototype.bind=function(e){var n=e.renderer;return this.uniforms.set("uTime",performance.now()),this.uniforms.set("uResolution",[n.width,n.height]),t.prototype.bind.call(this,e)}}(Ir),function(t){function e(e){void 0===e&&(e={});return e.fragmentShader||(e.fragmentShader="#define SHADER_NAME MULTI_QUAD_FRAG\n\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nuniform sampler2D uTexture[%count%];\n\nvoid main (void)\n{\n    vec4 color;\n\n    %forloop%\n\n    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);\n}"),t.call(this,e)||this}return h(e,t),e.prototype.create=function(e,n,r,i){for(var o=mr(),a="",u=1;u<o;u++)u>1&&(a+="\n\telse "),u<o-1&&(a+="if (vTextureId < "+u+".5)"),a+="\n\t{",a+="\n\t\tcolor = texture2D(uTexture["+u+"], vTextureCoord);",a+="\n\t}";e=(e=e.replace(/%count%/gi,""+o)).replace(/%forloop%/gi,a),t.prototype.create.call(this,e,n,r,i)},e.prototype.bind=function(e){return this.uniforms.set("uTexture",e.textureIndex),t.prototype.bind.call(this,e)},e}(Ir));var Br=function(){function t(t){this.count=0,this.prevCount=0,this.flushTotal=0,this.maxTextures=0,this.currentActiveTexture=0,this.startActiveTexture=0,this.tempTextures=[],this.textureIndex=[],this.framebufferStack=[],this.currentFramebuffer=null,this.defaultFramebuffer=null,this.vertexBufferStack=[],this.currentVertexBuffer=null,this.defaultVertexBuffer=null,this.shaderStack=[],this.currentShader=null,this.defaultShader=null,this.viewportStack=[],this.currentViewport=null,this.defaultViewport=null,this.blendModeStack=[],this.currentBlendMode=null,this.defaultBlendMode=null,this.renderer=t,this.projectionMatrix=new x,this.reset()}return t.prototype.reset=function(){var t,e,n,r,i,o=this.renderer.gl,a=[0,1,2,2,3,0];this.quadShader=new Ir,this.quadBuffer=new Cr({isDynamic:!1,indexLayout:a}),this.quadCamera=new N,br(this),function(t,e,n){void 0===e&&(e=null);var r={framebuffer:e,viewport:n};t.framebufferStack[0]=r,t.currentFramebuffer=r,t.defaultFramebuffer=r}(this),t=this,e=!0,n=o.ONE,r=o.ONE_MINUS_SRC_ALPHA,i={enable:e,sfactor:n,dfactor:r},t.blendModeStack[0]=i,t.currentBlendMode=i,t.defaultBlendMode=i,function(t,e){t.vertexBufferStack[0]=e,t.currentVertexBuffer=e,t.defaultVertexBuffer=e}(this,new Cr({batchSize:jn.get(Pn),indexLayout:a})),function(t,e,n){var r={shader:e,textureID:n};t.shaderStack[0]=r,t.currentShader=r,t.defaultShader=r}(this,new Lr)},t.prototype.resize=function(t,e){S(0,t,e,0,-1e3,1e3,this.projectionMatrix),this.quadCamera.reset(),function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0);var o=new O(e,n,r,i);t.viewportStack[0]=o,t.currentViewport=o,t.defaultViewport=o}(this,0,0,t,e)},t}();function kr(t,e){e||(e=t.currentShader),e.shader.bind(t,e.textureID)&&e.shader.setAttributes(t)}function Gr(t,e){e||(e=t.currentVertexBuffer);var n=e.indexed?e.indexBuffer:null;$n.bindBuffer($n.ELEMENT_ARRAY_BUFFER,n),$n.bindBuffer($n.ARRAY_BUFFER,e.vertexBuffer)}function jr(t){var e=t.vertexBufferStack;e.length>1&&e.pop(),t.currentVertexBuffer=e[e.length-1],Gr(t)}function Ur(t,e){var n=function(t,e){return t.vertexBufferStack.push(e),e}(t,e);Gr(t,n),t.currentVertexBuffer=n}function Vr(t,e){void 0===e&&(e=0);var n=t.currentVertexBuffer;t.count+e>=n.batchSize&&fr(t);var r=n.indexed?t.count*n.entryElementSize:t.count*n.vertexElementSize;return t.count+=e,{buffer:n,F32:n.vertexViewF32,U32:n.vertexViewU32,offset:r}}function Nr(t){var e=t.shaderStack;e.length>1&&e.pop(),t.currentShader=e[e.length-1],kr(t)}function Wr(t,e,n){var r=function(t,e,n){var r={shader:e,textureID:n};return t.shaderStack.push(r),r}(t,e,n);kr(t,r),t.currentShader=r}function qr(t,e){var n=e.binding,r=t.currentActiveTexture;return n.indexCounter<t.startActiveTexture&&(n.indexCounter=t.startActiveTexture,r<t.maxTextures?(n.setIndex(r),$n.activeTexture($n.TEXTURE0+r),$n.bindTexture($n.TEXTURE_2D,n.texture),t.currentActiveTexture++):(fr(t),t.startActiveTexture++,n.indexCounter=t.startActiveTexture,n.setIndex(1),$n.activeTexture($n.TEXTURE1),$n.bindTexture($n.TEXTURE_2D,n.texture),t.currentActiveTexture=2)),n.index}function Hr(t){t.current2DCamera=t.quadCamera,t.cameraMatrix=t.quadCamera.matrix,t.count=0,t.flushTotal=0,sr(t,!1,t.defaultFramebuffer),function(t,e){e||(e=t.currentBlendMode),e.enable?($n.enable($n.BLEND),$n.blendFunc(e.sfactor,e.dfactor)):$n.disable($n.BLEND)}(t,t.defaultBlendMode),ar(t,t.defaultViewport),Gr(t,t.defaultVertexBuffer)}var Kr=function(t){t},Xr=function(){function t(){var t=this;this.clearColor=[0,0,0,1],this.clearBeforeRender=!0,this.optimizeRedraw=!1,this.autoResize=!0,this.contextLost=!1,this.width=Hn(),this.height=Wn(),this.resolution=qn(),this.setBackgroundColor(Qn());var e=document.createElement("canvas");e.addEventListener("webglcontextlost",(function(e){return t.onContextLost(e)}),!1),e.addEventListener("webglcontextrestored",(function(){return t.onContextRestored()}),!1),this.canvas=e,this.initContext(),Kr(this),this.renderPass=new Br(this),this.resize(this.width,this.height,this.resolution)}return t.prototype.initContext=function(){var t=this.canvas.getContext("webgl",jn.get(Bn));or.set(t),this.gl=t,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)},t.prototype.resize=function(t,e,n){void 0===n&&(n=1);var r=t*n,i=e*n;this.width=r,this.height=i,this.resolution=n;var o=this.canvas;o.width=r,o.height=i,this.autoResize&&(o.style.width=t.toString()+"px",o.style.height=e.toString()+"px"),this.renderPass.resize(r,i)},t.prototype.onContextLost=function(t){t.preventDefault(),this.contextLost=!0},t.prototype.onContextRestored=function(){this.contextLost=!1,this.initContext()},t.prototype.setBackgroundColor=function(t){return function(t,e){void 0===e&&(e=[]);var n=t>>16&255,r=t>>8&255,i=255&t,o=t>16777215?t>>>24:255;e[0]=n/255,e[1]=r/255,e[2]=i/255,e[3]=o/255}(t,this.clearColor),this},t.prototype.reset=function(){},t.prototype.render=function(t){if(!this.contextLost){var e=this.gl,n=this.renderPass;if(Zn().forEach((function(t){var e=t.texture,n=t.glConfig;e.binding||(e.binding=new xr(e,n))})),Jn(),!this.optimizeRedraw||0!==t.numDirtyFrames||0!==t.numDirtyCameras){if(this.clearBeforeRender){var r=this.clearColor;e.clearColor(r[0],r[1],r[2],r[3]),e.clear(e.COLOR_BUFFER_BIT)}var i=t.worldData;Hr(n);for(var o=0;o<i.length;o++){var a=i[o].world;a.renderGL(n),a.postRenderGL(n)}!function(t){fr(t)}(n)}}},t.prototype.destroy=function(){Kr(void 0)},t}();var Yr=Object.freeze({__proto__:null,BackgroundColor:function(t){return function(){Un(t)}},Banner:function(t,e,n,r,i){return function(){Vn(t,e,n,r,i)}},BatchSize:function(t){return function(){Nn(t)}},Canvas:function(){return function(){er(tr)}},CanvasContext:function(t){return function(){!function(t){jn.set(kn,t)}(t)}},DefaultOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),function(){nr(t,e)}},MaxTextures:function(t){return void 0===t&&(t=0),function(){rr(t)}},Parent:function(t){return function(){!function(t){t&&jn.set(Fn,ir(t))}(t)}},Scenes:function(t){return function(){!function(t){jn.set(In,[].concat(t))}(t)}},Size:function(t,e,n){return void 0===t&&(t=800),void 0===e&&(e=600),void 0===n&&(n=1),function(){Kn(t,e,n)}},WebGL:function(){return function(){er(Xr)}},WebGLContext:function(t){return function(){!function(t){jn.set(Bn,t)}(t)}}});function Zr(t,e){return ir(e).appendChild(t),t}function Jr(t){var e=document.readyState;if("complete"!==e&&"interactive"!==e){var n=function(){document.removeEventListener("deviceready",n,!0),document.removeEventListener("DOMContentLoaded",n,!0),window.removeEventListener("load",n,!0),t()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",n,!0):(document.addEventListener("DOMContentLoaded",n,!0),window.addEventListener("load",n,!0)):window.setTimeout(n,20)}else t()}function Qr(t){var e;try{return(e=(new DOMParser).parseFromString(t,"text/xml"))&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null}catch(t){return null}}var $r,ti=Object.freeze({__proto__:null,AddToDOM:Zr,DOMContentLoaded:Jr,GetElement:ir,ParseXML:Qr,RemoveFromDOM:function(t){t.parentNode&&t.parentNode.removeChild(t)}});function ei(t,e){return e||($r||($r=document.createElement("audio")),e=$r),e&&""!==e.canPlayType(t)}function ni(t){return ei("audio/x-m4a",t)||ei("audio/aac",t)}function ri(t){return ei('audio/mpeg; codecs="mp3"',t)}function ii(t){return ei('audio/ogg; codecs="vorbis"',t)}function oi(t){return ei('audio/ogg; codecs="opus"',t)||ei('audio/webm; codecs="opus"',t)}function ai(t){return ei('audio/wav; codecs="1"',t)}function ui(t){return ei('audio/webm; codecs="vorbis"',t)}function si(){return window&&window.hasOwnProperty("Audio")}function hi(){return window&&(window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"))}function ci(){var t={audioData:si(),m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:hi(),webm:!1};return t.audioData&&(t.m4a=ni(),t.mp3=ri(),t.ogg=ii(),t.opus=oi(),t.wav=ai(),t.webm=ui()),t}var fi=Object.freeze({__proto__:null,CanPlayAudioType:ei,CanPlayM4A:ni,CanPlayMP3:ri,CanPlayOGG:ii,CanPlayOpus:oi,CanPlayWAV:ai,CanPlayWebM:ui,GetAudio:ci,HasAudio:si,HasWebAudio:hi});function di(){var t=/Chrome\/(\d+)/.test(navigator.userAgent);return{chrome:t,chromeVersion:t?parseInt(RegExp.$1,10):0}}function li(){return{edge:/Edge\/\d+/.test(navigator.userAgent)}}function vi(){var t=/Firefox\D+(\d+)/.test(navigator.userAgent);return{firefox:t,firefoxVersion:t?parseInt(RegExp.$1,10):0}}function pi(){var t=/MSIE (\d+\.\d+);/.test(navigator.userAgent);return{ie:t,ieVersion:t?parseInt(RegExp.$1,10):0}}function yi(){var t=navigator.userAgent,e={iOS:!1,iOSVersion:0,iPhone:!1,iPad:!1};if(/iP[ao]d|iPhone/i.test(t)){var n=/OS (\d+)/.exec(navigator.appVersion);e.iOS=!0,e.iOSVersion=parseInt(n[0],10),e.iPhone=t.toLowerCase().includes("iphone"),e.iPad=t.toLowerCase().includes("ipad")}return e}function xi(){var t=yi().iOS;return{mobileSafari:navigator.userAgent.includes("AppleWebKit")&&t}}function mi(){return{opera:navigator.userAgent.includes("Opera")}}function wi(){var t=navigator.userAgent;return/Windows Phone/i.test(t)||/IEMobile/i.test(t)}function gi(){var t=navigator.userAgent;return{safari:t.includes("Safari")&&!wi(),safariVersion:/Version\/(\d+)\./.test(t)?parseInt(RegExp.$1,10):0}}function bi(){return{silk:navigator.userAgent.includes("Silk")}}function Mi(){var t=/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(navigator.userAgent);return{trident:t,tridentVersion:t?parseInt(RegExp.$1,10):0,tridentIEVersion:t?parseInt(RegExp.$3,10):0}}function _i(){var t=di(),e=t.chrome,n=t.chromeVersion,r=li().edge,i=vi(),o=i.firefox,a=i.firefoxVersion,u=pi(),s=u.ie,h=u.ieVersion,c=xi().mobileSafari,f=mi().opera,d=gi(),l=d.safari,v=d.safariVersion,p=bi().silk,y=Mi(),x=y.trident,m=y.tridentVersion,w=y.tridentIEVersion;return x&&(s=!0,h=w),{chrome:e,chromeVersion:n,edge:r,firefox:o,firefoxVersion:a,ie:s,ieVersion:h,mobileSafari:c,opera:f,safari:l,safariVersion:v,silk:p,trident:x,tridentVersion:m}}var Ci=Object.freeze({__proto__:null,GetBrowser:_i,IsChrome:di,IsEdge:li,IsFirefox:vi,IsMobileSafari:xi,IsMSIE:pi,IsOpera:mi,IsSafari:gi,IsSilk:bi,IsTrident:Mi});function Ti(){return navigator.userAgent.includes("Android")}function zi(){return navigator.userAgent.includes("CrOS")}function Si(){return window.hasOwnProperty("cordova")}function Ei(){return navigator.userAgent.includes("Crosswalk")}function Ri(){return window.hasOwnProperty("ejecta")}function Pi(){var t=navigator.userAgent;return t.includes("Kindle")||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)}function Ai(){return navigator.userAgent.includes("Linux")}function Di(){var t=navigator.userAgent;return t.includes("Mac OS")&&!t.includes("like Mac OS")}function Fi(){return"undefined"!=typeof process&&"object"==typeof process.versions&&process.versions.hasOwnProperty("node")}function Oi(){return Fi()&&!!process.versions.hasOwnProperty("node-webkit")}function Ii(){return navigator.hasOwnProperty("standalone")}function Li(){return navigator.userAgent.includes("Windows")}function Bi(){var t=navigator.userAgent,e=yi(),n=e.iOS,r=e.iOSVersion,i=e.iPad,o=e.iPhone,a={android:Ti(),chromeOS:zi(),cordova:Si(),crosswalk:Ei(),desktop:!1,ejecta:Ri(),iOS:n,iOSVersion:r,iPad:i,iPhone:o,kindle:Pi(),linux:Ai(),macOS:Di(),node:Fi(),nodeWebkit:Oi(),pixelRatio:1,webApp:Ii(),windows:Li(),windowsPhone:wi()};a.windowsPhone&&(a.android=!1,a.iOS=!1,a.macOS=!1,a.windows=!0);var u=t.includes("Silk");return(a.windows||a.macOS||a.linux&&!u||a.chromeOS)&&(a.desktop=!0),(a.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(a.desktop=!1),a}var ki,Gi=Object.freeze({__proto__:null,GetOS:Bi,IsAndroid:Ti,IsChromeOS:zi,IsCordova:Si,IsCrosswalk:Ei,IsEjecta:Ri,IsiOS:yi,IsKindle:Pi,IsLinux:Ai,IsMacOS:Di,IsNode:Fi,IsNodeWebkit:Oi,IsWebApp:Ii,IsWindows:Li,IsWindowsPhone:wi});function ji(t,e){return e||(ki||(ki=document.createElement("video")),e=ki),e&&""!==e.canPlayType(t)}function Ui(t){return ji('video/mp4; codecs="avc1.42E01E"',t)}function Vi(t){return ji('application/x-mpegURL; codecs="avc1.42E01E"',t)}function Ni(t){return ji('video/ogg; codecs="theora"',t)}function Wi(t){return ji('video/webm; codecs="vp9"',t)}function qi(t){return ji('video/webm; codecs="vp8, vorbis"',t)}function Hi(){return{h264Video:Ui(),hlsVideo:Vi(),oggVideo:Ni(),vp9Video:Wi(),webmVideo:qi()}}var Ki=Object.freeze({__proto__:null,CanPlayH264Video:Ui,CanPlayHLSVideo:Vi,CanPlayOGGVideo:Ni,CanPlayVP9Video:Wi,CanPlayVideoType:ji,CanPlayWebMVideo:qi,GetVideo:Hi}),Xi=Object.freeze({__proto__:null,Audio:fi,Browser:Ci,OS:Gi,Video:Ki,CanPlayAudioType:ei,CanPlayM4A:ni,CanPlayMP3:ri,CanPlayOGG:ii,CanPlayOpus:oi,CanPlayWAV:ai,CanPlayWebM:ui,GetAudio:ci,HasAudio:si,HasWebAudio:hi,GetBrowser:_i,IsChrome:di,IsEdge:li,IsFirefox:vi,IsMobileSafari:xi,IsMSIE:pi,IsOpera:mi,IsSafari:gi,IsSilk:bi,IsTrident:Mi,GetOS:Bi,IsAndroid:Ti,IsChromeOS:zi,IsCordova:Si,IsCrosswalk:Ei,IsEjecta:Ri,IsiOS:yi,IsKindle:Pi,IsLinux:Ai,IsMacOS:Di,IsNode:Fi,IsNodeWebkit:Oi,IsWebApp:Ii,IsWindows:Li,IsWindowsPhone:wi,CanPlayH264Video:Ui,CanPlayHLSVideo:Vi,CanPlayOGGVideo:Ni,CanPlayVP9Video:Wi,CanPlayVideoType:ji,CanPlayWebMVideo:qi,GetVideo:Hi});function Yi(t){for(var e=[t],n=[];e.length>0;){var r=e.shift();n.push(r);var i=r.numChildren;if(i>0)for(var o=i-1;o>=0;o--)e.unshift(r.children[o])}return n.shift(),n}function Zi(t,e){return t.children.indexOf(e)}function Ji(t,e){var n,r=t.children;if(e>=0&&e<r.length){var i=r.splice(e,1);i[0]&&((n=i[0]).parent=null)}return n}function Qi(t,e){var n=Zi(t,e);return n>-1&&Ji(t,n),e}function $i(t,e){for(var n,r,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(0===t.events.size||!t.events.has(e))return!1;var a=t.events.get(e);try{for(var u=c(a),s=u.next();!s.done;s=u.next()){var h=s.value;h.callback.apply(h.context,i),h.once&&a.delete(h)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return 0===a.size&&t.events.delete(e),!0}function to(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.world&&($i(e.world,"removedfromworld",e,e.world),$i(e,"removedfromworld",e,e.world)),e.world=t,$i(t,"addedtoworld",e,t),$i(e,"addedtoworld",e,t)})),e}function eo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){e.parent&&Qi(e.parent,e),e.parent=t}));var r=t.world;return r&&to.apply(void 0,d([r],Yi(t))),e}function no(t,e){return t.children.push(e),eo(t,e),e.transform.updateWorld(),e}var ro=1,io=4,oo=16,ao=32,uo=64,so=51;function ho(t,e){void 0===e&&(e=[]);for(var n=0;n<t.numChildren;n++){var r=t.children[n],i=[];e.push({node:r,children:i}),r.numChildren>0&&ho(r,i)}return e}function co(t){return(t.numChildren>0?"Parent":"Child")+" [ type="+t.type+", name="+t.name+" ]"}function fo(t,e,n){void 0===e&&(e=0);var r=t.children;void 0===n&&(n=r.length);var i=n-e;if(i>0&&i<=n){var o=r.splice(e,i);return o.forEach((function(t){t.parent=null})),o}return[]}function lo(t,e,n){void 0===e&&(e=0),fo(t,e,n).forEach((function(t){t.destroy()}))}function vo(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0)&&!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)}function po(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){Qi(t,e)})),e}function yo(t,e,n,r){void 0===n&&(n=0);var i=fo(t,n,r);return eo.apply(void 0,d([e],i)),i.forEach((function(t){t.transform.updateWorld()})),i}var xo=Object.freeze({__proto__:null,AddChild:no,AddChildAt:function(t,e,n){var r=t.children;return e>=0&&e<=r.length&&(eo(t,n),r.splice(e,0,n),n.transform.updateWorld()),n},AddChildren:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){no(t,e)})),e},AddChildrenAt:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=t.children;return e>=0&&e<=i.length&&n.reverse().forEach((function(r){n.splice(e,0,r),eo(t,r),r.transform.updateWorld()})),n},AddPosition:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.x+=t,n.y+=e})),n},AddRotation:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.rotation+=t})),e},AddScale:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.scaleX+=t,n.scaleY+=e})),n},AddSkew:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.skewX+=t,n.skewY+=e})),n},BringChildToTop:function(t,e){var n=t.children,r=Zi(t,e);return-1!==r&&r<n.length&&(n.splice(r,1),n.push(e),e.setDirty(ro)),e},ConsoleTreeChildren:function(t){var e=ho(t);t.world===t?console.group("World"):console.group(co(t)),e.forEach((function(t){t.children.length?function t(e){console.group(co(e.node)),e.children.forEach((function(e){e.children.length>0?t(e):console.log(co(e.node))})),console.groupEnd()}(t):console.log(co(t.node))})),console.groupEnd()},CountMatchingChildren:function(t,e,n){var r=t.children,i=0;return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);!r||void 0!==n&&n!==r.value||i++})),i},DepthFirstSearch:Yi,DepthFirstSearchRecursive:function t(e,n){void 0===n&&(n=[]);for(var r=0;r<e.numChildren;r++){var i=e.children[r];n.push(i),i.numChildren>0&&t(i,n)}return n},DepthFirstSearchRecursiveNested:ho,DestroyChildren:lo,FindChildByName:function(t,e){for(var n=Yi(t),r=RegExp(e),i=0;i<n.length;i++){var o=n[i];if(r.test(o.name))return o}},FindChildrenByName:function(t,e){var n=Yi(t),r=RegExp(e),i=[];return n.forEach((function(t){r.test(t.name)&&i.push(t)})),i},GetAllChildren:function(t,e,n){var r=Yi(t);if(!e)return r;var i=[];return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);!r||void 0!==n&&n!==r.value||i.push(t)})),i},GetChildAt:function(t,e){var n=t.children;if(e<0||e>n.length)throw new Error("Index out of bounds: "+e);return n[e]},GetChildIndex:Zi,GetChildren:function(t,e,n){var r=t.children;if(!e)return d(r);var i=[];return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);!r||void 0!==n&&n!==r.value||i.push(t)})),i},GetClosestChild:function(t,e){var n=t.children,r=null,i=0;return n.forEach((function(t){var n=rn(e,t.transform.position);(!r||n<i)&&(r=t,i=n)})),r},GetFirstChild:function(t,e,n){for(var r=t.children,i=0;i<r.length;i++){var o=r[i],a=Object.getOwnPropertyDescriptor(o,e);if(a&&(void 0===n||n===a.value))return o}},GetFurthestChild:function(t,e){var n=t.children,r=null,i=0;return n.forEach((function(t){var n=rn(e,t.transform.position);(!r||n>i)&&(r=t,i=n)})),r},GetLastChild:function(t,e,n){for(var r=t.children,i=r.length-1;i>=0;i--){var o=r[i],a=Object.getOwnPropertyDescriptor(o,e);if(a&&(void 0===n||n===a.value))return o}},GetParents:function(t){for(var e=[];t.parent;)e.push(t.parent),t=t.parent;return e},GetRandomChild:function(t,e,n){void 0===e&&(e=0);var r=t.children;return n||(n=r.length),r[e+Math.floor(Math.random()*n)]},MoveChildDown:function(t,e){var n=t.children,r=Zi(t,e);if(r>0){var i=n[r-1],o=n.indexOf(i);n[r]=i,n[o]=e,e.setDirty(ro),i.setDirty(ro)}return e},MoveChildTo:function(t,e,n){var r=t.children,i=Zi(t,e);if(-1===i||n<0||n>=r.length)throw new Error("Index out of bounds");return i!==n&&(r.splice(i,1),r.splice(n,0,e),e.setDirty(ro)),e},MoveChildUp:function(t,e){var n=t.children,r=Zi(t,e);if(-1!==r&&r>0){var i=n[r+1],o=n.indexOf(i);n[r]=i,n[o]=e,e.setDirty(ro),i.setDirty(ro)}return e},Overlap:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=t.bounds.get(),i=0;i<e.length;i++){var o=e[i],a=o.bounds.get();if(vo(r,a))return!0}return!1},RemoveChild:Qi,RemoveChildAt:Ji,RemoveChildren:po,RemoveChildrenAt:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[];return e.sort((function(t,e){return t-e})),e.reverse().forEach((function(e){var n=Ji(t,e);n&&r.push(n)})),r},RemoveChildrenBetween:fo,ReparentChildren:yo,RotateChildrenLeft:function(t,e){void 0===e&&(e=1);for(var n=t.children,r=null,i=0;i<e;i++)r=n.shift(),n.push(r),r.setDirty(ro);return r},RotateChildrenRight:function(t,e){void 0===e&&(e=1);for(var n=t.children,r=null,i=0;i<e;i++)r=n.pop(),n.unshift(r),r.setDirty(ro);return r},SendChildToBack:function(t,e){var n=t.children,r=Zi(t,e);return-1!==r&&r>0&&(n.splice(r,1),n.unshift(e),e.setDirty(ro)),e},SetBounds:function(t,e,n,r){for(var i=[],o=4;o<arguments.length;o++)i[o-4]=arguments[o];return i.forEach((function(i){i.bounds.set(t,e,n,r)})),i},SetChildrenValue:function(t,e,n){var r=Yi(t);return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);r&&r.set(n)})),r},SetName:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.name=t})),e},SetOrigin:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.setOrigin(t,e)})),n},SetParent:eo,SetPosition:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.setPosition(t,e)})),n},SetRotation:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.rotation=t})),e},SetScale:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.setScale(t,e)})),n},SetSize:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.setSize(t,e)})),n},SetSkew:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){n.setSkew(t,e)})),n},SetType:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.type=t})),e},SetValue:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.forEach((function(n){var r=Object.getOwnPropertyDescriptor(n,t);r&&r.set(e)})),n},SetVisible:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.visible=t})),e},SetWorld:to,ShuffleChildren:function(t){for(var e=t.children,n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),i=e[n];e[n]=e[r],e[r]=i,i.setDirty(ro)}return e},SwapChildren:function(t,e){if(t.parent===e.parent){var n=t.parent.children,r=Zi(t.parent,t),i=Zi(e.parent,e);r!==i&&(n[r]=e,n[i]=t)}}});function mo(t){for(var e=[t],n=[];e.length>0;){var r=e.shift();n.push(r);var i=r.numChildren;if(i>0)for(var o=i-1;o>=0;o--)e.unshift(r.children[o])}return n.shift(),n}function wo(t,e){return t.children.indexOf(e)}function go(t,e){var n,r=t.children;if(e>=0&&e<r.length){var i=r.splice(e,1);i[0]&&((n=i[0]).parent=null)}return n}function bo(t,e){var n=wo(t,e);return n>-1&&go(t,n),e}function Mo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.world&&($i(e.world,"removedfromworld",e,e.world),$i(e,"removedfromworld",e,e.world)),e.world=t,$i(t,"addedtoworld",e,t),$i(e,"addedtoworld",e,t)})),e}function _o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){e.parent&&bo(e.parent,e),e.parent=t}));var r=t.world;return r&&Mo.apply(void 0,d([r],mo(t))),e}function Co(t,e){return t.children.push(e),_o(t,e),e}function To(t,e,n){var r=t.children;return e>=0&&e<=r.length&&(_o(t,n),r.splice(e,0,n)),n}function zo(t,e){void 0===e&&(e=[]);for(var n=0;n<t.numChildren;n++){var r=t.children[n],i=[];e.push({node:r,children:i}),r.numChildren>0&&zo(r,i)}return e}function So(t){return(t.numChildren>0?"Parent":"Child")+" [ type="+t.type+", name="+t.name+" ]"}function Eo(t,e,n){void 0===e&&(e=0);var r=t.children;void 0===n&&(n=r.length);var i=n-e;if(i>0&&i<=n){var o=r.splice(e,i);return o.forEach((function(t){t.parent=null})),o}return[]}function Ro(t,e,n){var r=t.children,i=wo(t,e);if(-1===i||n<0||n>=r.length)throw new Error("Index out of bounds");return i!==n&&(r.splice(i,1),r.splice(n,0,e),e.setDirty(ro)),e}function Po(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){bo(t,e)})),e}var Ao=Object.freeze({__proto__:null,AddChild3D:Co,AddChild3DAt:To,AddChildren3D:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){Co(t,e)})),e},AddChildren3DAt:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=t.children;return e>=0&&e<=i.length&&n.reverse().forEach((function(r){n.splice(e,0,r),_o(t,r)})),n},ConsoleTreeChildren3D:function(t){var e=zo(t);t.world===t?console.group("World"):console.group(So(t)),e.forEach((function(t){t.children.length?function t(e){console.group(So(e.node)),e.children.forEach((function(e){e.children.length>0?t(e):console.log(So(e.node))})),console.groupEnd()}(t):console.log(So(t.node))})),console.groupEnd()},CountMatchingChildren3D:function(t,e,n){var r=t.children,i=0;return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);!r||void 0!==n&&n!==r.value||i++})),i},DepthFirstSearch3D:mo,DepthFirstSearchRecursive3D:function t(e,n){void 0===n&&(n=[]);for(var r=0;r<e.numChildren;r++){var i=e.children[r];n.push(i),i.numChildren>0&&t(i,n)}return n},DepthFirstSearchRecursiveNested3D:zo,DestroyChildren3D:function(t,e,n){void 0===e&&(e=0),Eo(t,e,n).forEach((function(t){t.destroy()}))},FindChild3DByName:function(t,e){for(var n=mo(t),r=RegExp(e),i=0;i<n.length;i++){var o=n[i];if(r.test(o.name))return o}},FindChildren3DByName:function(t,e){var n=mo(t),r=RegExp(e),i=[];return n.forEach((function(t){r.test(t.name)&&i.push(t)})),i},GetAllChildren3D:function(t,e,n){var r=mo(t);if(!e)return r;var i=[];return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);!r||void 0!==n&&n!==r.value||i.push(t)})),i},GetChild3DAt:function(t,e){var n=t.children;if(e<0||e>n.length)throw new Error("Index out of bounds: "+e);return n[e]},GetChild3DIndex:wo,GetChildren3D:function(t,e,n){var r=t.children;if(!e)return d(r);var i=[];return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);!r||void 0!==n&&n!==r.value||i.push(t)})),i},GetFirstChild3D:function(t,e,n){for(var r=t.children,i=0;i<r.length;i++){var o=r[i],a=Object.getOwnPropertyDescriptor(o,e);if(a&&(void 0===n||n===a.value))return o}},GetLastChild3D:function(t,e,n){for(var r=t.children,i=r.length-1;i>=0;i--){var o=r[i],a=Object.getOwnPropertyDescriptor(o,e);if(a&&(void 0===n||n===a.value))return o}},GetParents3D:function(t){for(var e=[];t.parent;)e.push(t.parent),t=t.parent;return e},GetRandomChild3D:function(t,e,n){void 0===e&&(e=0);var r=t.children;return n||(n=r.length),r[e+Math.floor(Math.random()*n)]},MoveChild3DTo:Ro,RemoveChild3D:bo,RemoveChild3DAt:go,RemoveChildren3D:Po,RemoveChildren3DAt:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[];return e.sort((function(t,e){return t-e})),e.reverse().forEach((function(e){var n=go(t,e);n&&r.push(n)})),r},RemoveChildren3DBetween:Eo,ReparentChildren3D:function(t,e,n,r){void 0===n&&(n=0);var i=Eo(t,n,r);return _o.apply(void 0,d([e],i)),i.forEach((function(t){})),i},ReplaceChild3D:function(t,e){var n=t.parent,r=e.parent,i=wo(n,t);return n===r?(Ro(n,e,i),bo(n,t)):(bo(n,t),bo(r,e),To(n,i,e)),t},SetChildren3DValue:function(t,e,n){var r=mo(t);return r.forEach((function(t){var r=Object.getOwnPropertyDescriptor(t,e);r&&r.set(n)})),r},SetParent3D:_o,SetWorld3D:Mo,SwapChildren3D:function(t,e){if(t.parent===e.parent){var n=t.parent.children,r=wo(t.parent,t),i=wo(e.parent,e);r!==i&&(n[r]=e,n[i]=t)}}});var Do=function(){this.events=new Map},Fo=function(t,e,n){void 0===n&&(n=!1),this.callback=t,this.context=e,this.once=n};function Oo(t,e,n,r,i){var o,a,u=t.events,s=u.get(e);if(n)if(n instanceof Fo)s.delete(n);else{var h=!r,f=void 0!==i;try{for(var d=c(s),l=d.next();!l.done;l=d.next()){var v=l.value;v.callback===n&&h&&v.context===r&&f&&v.once===i&&s.delete(v)}}catch(t){o={error:t}}finally{try{l&&!l.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}}else u.delete(e);return 0===s.size&&u.delete(e),t}function Io(t,e,n,r,i){if(void 0===r&&(r=t),void 0===i&&(i=!1),"function"!=typeof n)throw new TypeError("Listener not a function");var o=new Fo(n,r,i),a=t.events.get(e);return a?a.add(o):t.events.set(e,new Set([o])),o}function Lo(t,e,n,r){return void 0===r&&(r=t),Io(t,e,n,r,!0)}var Bo=Object.freeze({__proto__:null,ClearEvent:function(t,e){return t.events.delete(e),t},Emit:$i,EventEmitter:Do,EventInstance:Fo,GetEventNames:function(t){return d(t.events.keys())},GetListenerCount:function(t,e){var n=t.events.get(e);return n?n.size:0},GetListeners:function(t,e){var n=[];return t.events.get(e).forEach((function(t){n.push(t.callback)})),n},Off:Oo,On:Io,Once:Lo,RemoveAllListeners:function(t,e){e?t.events.delete(e):t.events.clear()}});function ko(t){var e=t.world,n=e.a,r=e.b,i=e.c,o=e.d,a=e.tx,u=e.ty,s=t.extent,h=s.x,c=s.y,f=s.right,d=s.bottom;return{x0:h*n+c*i+a,y0:h*r+c*o+u,x1:h*n+d*i+a,y1:h*r+d*o+u,x2:f*n+d*i+a,y2:f*r+d*o+u,x3:f*n+c*i+a,y3:f*r+c*o+u}}var Go=function(){function t(t){this.fixed=!1,this.includeChildren=!0,this.visibleOnly=!0,this.entity=t,this.area=new O}return t.prototype.set=function(t,e,n,r){this.area.set(t,e,n,r)},t.prototype.get=function(){return this.entity.isDirty(ao)&&!this.fixed&&this.update(),this.area},t.prototype.updateLocal=function(){var t=ko(this.entity.transform),e=t.x0,n=t.y0,r=t.x1,i=t.y1,o=t.x2,a=t.y2,u=t.x3,s=t.y3,h=Math.min(e,r,o,u),c=Math.min(n,i,a,s),f=Math.max(e,r,o,u),d=Math.max(n,i,a,s);return this.area.set(h,c,f-h,d-c)},t.prototype.update=function(){var t=this.updateLocal();if(this.entity.clearDirty(ao),!this.includeChildren||!this.entity.numChildren)return t;for(var e=this.visibleOnly,n=this.entity.children,r=t.x,i=t.y,o=t.right,a=t.bottom,u=0;u<n.length;u++){var s=n[u];if(s&&(!e||s.visible)){var h=s.bounds.get();h.x<r&&(r=h.x),h.y<i&&(i=h.y),h.right>o&&(o=h.right),h.bottom>a&&(a=h.bottom)}}return t.set(r,i,o-r,a-i)},t.prototype.destroy=function(){this.entity=null,this.area=null},t}(),jo=Object.freeze({__proto__:null,BoundsComponent:Go}),Uo=function(){function t(t){this.enabled=!1,this.enabledChildren=!0,this.entity=t}return t.prototype.destroy=function(){this.entity=null,this.hitArea=null},t}(),Vo=Object.freeze({__proto__:null,InputComponent:Uo});function No(t,e,n){return t.x=e-t.width/2,t.y=n-t.height/2,t}function Wo(t,e){return void 0===e&&(e=[]),e.push(new I(t.x,t.y),new I(t.right,t.y),new I(t.right,t.bottom),new I(t.x,t.bottom)),e}function qo(t){return 0===t.height?NaN:t.width/t.height}function Ho(t){return t.x+t.width/2}function Ko(t){return t.y+t.height/2}var Xo=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.set(t,e,n,r)}return t.prototype.set=function(t,e,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x1=t,this.y1=e,this.x2=n,this.y2=r,this},Object.defineProperty(t.prototype,"left",{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t},enumerable:!1,configurable:!0}),t}();function Yo(t){var e=t.x,n=t.y,r=t.right,i=t.bottom;return[new Xo(e,n,r,n),new Xo(r,n,r,i),new Xo(r,i,e,i),new Xo(e,i,e,n)]}function Zo(t){return 2*(t.width+t.height)}function Jo(t,e,n){if(void 0===n&&(n=new I),e<=0||e>=1)return n.set(t.x,t.y);var r=Zo(t)*e;return e>.5?(r-=t.width+t.height)<=t.width?n.set(t.right-r,t.bottom):n.set(t.x,t.bottom-(r-t.width)):r<=t.width?n.set(t.x+r,t.y):n.set(t.right,t.y+(r-t.width))}function Qo(t,e){return!(e.width*e.height>t.width*t.height)&&(e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom)}var $o=Object.freeze({__proto__:null,CeilRectangle:function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t},CeilRectanglePosition:function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t},CenterRectangleOn:No,CloneRectangle:function(t){return new O(t.x,t.y,t.width,t.height)},CopyRectangleFrom:function(t,e){return e.set(t.x,t.y,t.width,t.height)},DecomposeRectangle:Wo,FitRectangleInside:function(t,e){var n=qo(t),r=e.width,i=e.height;return n<qo(e)?r=e.height*n:i=e.width/n,t.set(Ho(e)-t.width/2,Ko(e)-t.height/2,r,i)},FitRectangleOutside:function(t,e){var n=qo(t),r=e.width,i=e.height;return n>qo(e)?r=e.height*n:i=e.width/n,t.set(Ho(e)-t.width/2,Ko(e)-t.height/2,r,i)},FitRectangleToPoint:function(t,e,n){var r=Math.min(t.x,e),i=Math.max(t.right,e),o=Math.min(t.y,n),a=Math.max(t.bottom,n);return t.set(r,o,i-r,a-o)},FitRectangleToPoints:function(t,e){for(var n=t.x,r=t.right,i=t.y,o=t.bottom,a=0;a<e.length;a++)n=Math.min(n,e[a].x),r=Math.max(r,e[a].x),i=Math.min(i,e[a].y),o=Math.max(o,e[a].y);return t.set(n,i,r-n,o-i)},FloorRectangle:function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t},FloorRectanglePosition:function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t},GetRectangleArea:function(t){return t.width*t.height},GetRectangleAspectRatio:qo,GetRectangleCenter:function(t,e){return void 0===e&&(e=new I),e.set(Ho(t),Ko(t))},GetRectangleCenterX:Ho,GetRectangleCenterY:Ko,GetRectangleEdges:Yo,GetRectangleIntersection:function(t,e,n){return void 0===n&&(n=new O),vo(t,e)?n.set(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.min(t.right,e.right)-n.x,Math.min(t.bottom,e.bottom)-n.y):n.set(),n},GetRectangleMarchingAnts:function(t,e,n,r){if(void 0===r&&(r=[]),!e&&!n)return r;e?n=Math.round(Zo(t)/e):e=Zo(t)/n;for(var i=t.x,o=t.y,a=0,u=0;u<n;u++)switch(r.push(new I(i,o)),a){case 0:(i+=e)>=t.right&&(a=1,o+=i-t.right,i=t.right);break;case 1:(o+=e)>=t.bottom&&(a=2,i-=o-t.bottom,o=t.bottom);break;case 2:(i-=e)<=t.x&&(a=3,o-=t.x-i,i=t.x);break;case 3:(o-=e)<=t.y&&(a=0,o=t.y)}return r},GetRectangleOverlap:function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y},GetRectanglePerimeter:Zo,GetRectanglePerimeterPoint:function(t,e,n){void 0===n&&(n=new I),e=Cn(e);var r=Math.sin(e),i=Math.cos(e),o=i>0?t.width/2:t.width/-2,a=r>0?t.height/2:t.height/-2;return Math.abs(o*r)<Math.abs(a*i)?a=o*r/i:o=a*i/r,n.set(o+Ho(t),a+Ko(t))},GetRectanglePoint:Jo,GetRectanglePoints:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=[]),n||(n=Zo(t)/e);for(var i=0;i<n;i++)r.push(Jo(t,i/n));return r},GetRectangleRandomPoint:function(t,e){return void 0===e&&(e=new I),e.set(t.x+Math.random()*t.width,t.y+Math.random()*t.height)},GetRectangleRandomPointOutside:function(t,e,n){if(void 0===n&&(n=new I),Qo(t,e))switch(_n(0,3)){case 0:n.x=t.x+Math.random()*(e.right-t.x),n.y=t.y+Math.random()*(e.y-t.y);break;case 1:n.x=e.x+Math.random()*(t.right-e.x),n.y=e.bottom+Math.random()*(t.bottom-e.bottom);break;case 2:n.x=t.x+Math.random()*(e.x-t.x),n.y=e.y+Math.random()*(t.bottom-e.y);break;case 3:n.x=e.right+Math.random()*(t.right-e.right),n.y=t.y+Math.random()*(e.bottom-t.y)}return n},GetRectangleSize:function(t,e){return void 0===e&&(e=new I),e.set(t.width,t.height)},GetRectangleUnion:function(t,e,n){void 0===n&&(n=new O);var r=Math.min(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.right,e.right)-r,a=Math.max(t.bottom,e.bottom)-i;return n.set(r,i,o,a)},InflateRectangle:function(t,e,n){var r=Ho(t),i=Ko(t);return t.width=t.width+2*e,t.height=t.height+2*n,No(t,r,i)},MergeRectangle:function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.right,e.right),i=Math.min(t.y,e.y),o=Math.max(t.bottom,e.bottom);return t.set(n,i,r-n,o-i)},Rectangle:O,RectangleContains:F,RectangleContainsPoint:function(t,e){return F(t,e.x,e.y)},RectangleContainsRectangle:Qo,RectangleEquals:function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},RectangleFromPoints:function(t,e){if(void 0===e&&(e=new O),0===t.length)return e;for(var n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=B.MIN_SAFE_INTEGER,o=B.MIN_SAFE_INTEGER,a=0;a<t.length;a++){var u=t[a].x,s=t[a].y;n=Math.min(n,u),r=Math.min(r,s),i=Math.max(i,u),o=Math.max(o,s)}return e.set(n,r,i-n,o-r)},RectangleSizeEquals:function(t,e){return t.width===e.width&&t.height===e.height},ScaleRectangle:function(t,e,n){return void 0===n&&(n=e),t.width*=e,t.height*=n,t},TranslateRectangle:function(t,e,n){return t.x+=e,t.y+=n,t},TranslateRectanglePoint:function(t,e){return t.x+=e.x,t.y+=e.y,t}});function ta(t){var e=t.local,n=t.position.x,r=t.position.y,i=t.rotation,o=t.scale.x,a=t.scale.y,u=t.skew.x,s=t.skew.y;e.set(Math.cos(i+s)*o,Math.sin(i+s)*o,-Math.sin(i-u)*a,Math.cos(i-u)*a,n,r)}function ea(t){var e=t.parent,n=t.transform,r=n.local,i=n.world;if(e)if(n.passthru)We(e.transform.world,i);else{var o=r.a,a=r.b,u=r.c,s=r.d,h=r.tx,c=r.ty,f=e.transform.world,d=f.a,l=f.b,v=f.c,p=f.d,y=f.tx,x=f.ty;i.set(o*d+a*v,o*l+a*p,u*d+s*v,u*l+s*p,h*d+c*v+y,h*l+c*p+x)}else We(r,i)}var na=function(){function t(t,e,n){var r=this;void 0===e&&(e=0),void 0===n&&(n=0),this.passthru=!1,this._rotation=0,this.entity=t,this.local=new D,this.world=new D;var i=function(){return r.update()};this.position=new L(i,e,n),this.scale=new L(i,1,1),this.skew=new L(i),this.origin=new L((function(){return r.updateExtent()}),jn.get(An).x,jn.get(An).y),this.extent=new O}return t.prototype.update=function(){this.updateLocal(),this.updateWorld()},t.prototype.updateLocal=function(){this.entity.setDirty(ro,ao),ta(this)},t.prototype.updateWorld=function(){var t=this.entity;t.setDirty(ro,ao),ea(t),t.numChildren&&this.updateChildren()},t.prototype.updateChildren=function(){for(var t=this.entity.children,e=0;e<t.length;e++){t[e].transform.updateWorld()}},t.prototype.globalToLocal=function(t,e,n){void 0===n&&(n=new I);var r=this.world,i=r.a,o=r.b,a=r.c,u=r.d,s=r.tx,h=r.ty,c=1/(i*u+a*-o);return n.x=u*c*t+-a*c*e+(h*a-s*u)*c,n.y=i*c*e+-o*c*t+(-h*i+s*o)*c,n},t.prototype.localToGlobal=function(t,e,n){void 0===n&&(n=new I);var r=this.world,i=r.a,o=r.b,a=r.c,u=r.d,s=r.tx,h=r.ty;return n.x=i*t+a*e+s,n.y=o*t+u*e+h,n},t.prototype.setExtent=function(t,e,n,r){this.extent.set(t,e,n,r),this.entity.setDirty(ro,ao)},t.prototype.updateExtent=function(t,e){var n=this.extent,r=this.entity;void 0!==t&&(n.width=t),void 0!==e&&(n.height=e),n.x=-this.origin.x*n.width,n.y=-this.origin.y*n.height,r.setDirty(ro,ao)},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){t!==this._rotation&&(this._rotation=t,this.update())},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this.position.destroy(),this.scale.destroy(),this.skew.destroy(),this.origin.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.skew=null,this.origin=null,this.extent=null},t}(),ra=Object.freeze({__proto__:null,GetVertices:ko,TransformComponent:na,UpdateLocalTransform:ta,UpdateWorldTransform:ea});function ia(t,e){return((255&(255*e|0))<<24|t)>>>0}var oa=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=0,this.y=0,this.z=0,this.u=0,this.v=0,this.texture=0,this.tint=16777215,this.alpha=1,this.color=4294967295,this.x=t,this.y=e,this.z=n}return t.prototype.setPosition=function(t,e,n){return void 0===n&&(n=0),this.x=t,this.y=e,this.z=n,this},t.prototype.setUV=function(t,e){return this.u=t,this.v=e,this},t.prototype.setColor=function(t,e){return void 0===e&&(e=1),this.tint=t,this.alpha=e,this.packColor(),this},t.prototype.setAlpha=function(t){return this.alpha=t,this},t.prototype.setTint=function(t){return this.tint=t,this},t.prototype.packColor=function(){this.color=ia(this.tint,this.alpha)},t}(),aa=Object.freeze({__proto__:null,Bounds:jo,Input:Vo,Transform:ra,Vertex:oa});var ua,sa=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.type="GameObject",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new na(this,t,e),this.bounds=new Go(this),this.input=new Uo(this),this.dirty=so,this.transform.update()}return t.prototype.isRenderable=function(){return this.visible&&this.willRender},t.prototype.isDirty=function(t){return 0!=(this.dirty&t)},t.prototype.clearDirty=function(t){return this.isDirty(t)&&(this.dirty^=t),this},t.prototype.setDirty=function(t,e){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=o()),this.isDirty(e)||(this.dirty^=e),this},t.prototype.update=function(t,e){if(this.willUpdateChildren)for(var n=this.children,r=0;r<n.length;r++){var i=n[r];i&&i.willUpdate&&i.update(t,e)}this.postUpdate(t,e)},t.prototype.postUpdate=function(t,e){},t.prototype.renderGL=function(t){},t.prototype.renderCanvas=function(t){},t.prototype.postRenderGL=function(t){},t.prototype.postRenderCanvas=function(t){},Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),t.prototype.destroy=function(t){t?yo(this,t):lo(this),$i(this,"destroy",this),this.transform.destroy(),this.bounds.destroy(),this.input.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null},t}(),ha=function(t){function e(e,n){void 0===e&&(e=0),void 0===n&&(n=0);var r=t.call(this,e,n)||this;return r._alpha=1,r.type="Container",r}return h(e,t),e.prototype.setSize=function(t,e){return void 0===e&&(e=t),this.transform.updateExtent(t,e),this},e.prototype.setPosition=function(t,e){return this.transform.position.set(t,e),this},e.prototype.setOrigin=function(t,e){return void 0===e&&(e=t),this.transform.origin.set(t,e),this},e.prototype.setSkew=function(t,e){return void 0===e&&(e=t),this.transform.skew.set(t,e),this},e.prototype.setScale=function(t,e){return void 0===e&&(e=t),this.transform.scale.set(t,e),this},e.prototype.setRotation=function(t){return this.transform.rotation=t,this},Object.defineProperty(e.prototype,"width",{get:function(){return this.transform.extent.width},set:function(t){this.transform.updateExtent(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.transform.extent.height},set:function(t){this.transform.updateExtent(void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originX",{get:function(){return this.transform.origin.x},set:function(t){this.transform.origin.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originY",{get:function(){return this.transform.origin.y},set:function(t){this.transform.origin.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skewX",{get:function(){return this.transform.skew.x},set:function(t){this.transform.skew.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skewY",{get:function(){return this.transform.skew.y},set:function(t){this.transform.skew.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this.transform.scale.x},set:function(t){this.transform.scale.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this.transform.scale.y},set:function(t){this.transform.scale.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this.setDirty(ro))},enumerable:!1,configurable:!0}),e}(sa);function ca(t){return t.vertices.forEach((function(t){t.packColor()})),t}function fa(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=t.getFrame(e),o=i.u0,a=i.u1,u=i.v0,s=i.v1,h=i.pivot;return n.forEach((function(t){if(t&&i!==t.frame){t.frame=i,h&&t.setOrigin(h.x,h.y),t.frame.setExtent(t),t.hasTexture=!0;var e=t.vertices;e[0].setUV(o,u),e[1].setUV(o,s),e[2].setUV(a,s),e[3].setUV(a,u)}})),n}var da=function(){return ua},la=function(t){ua=t};var va=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.hasTexture=!1,o._tint=16777215,o.type="Sprite",o.vertices=[new oa,new oa,new oa,new oa],o.setTexture(r,i),o}return h(e,t),e.prototype.setTexture=function(t,e){return function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];t?(n=t instanceof Fr?t:da().get(t))?(r.forEach((function(t){t.texture=n})),fa.apply(void 0,d([n,e],r))):console.warn("Invalid Texture key: "+t):r.forEach((function(t){t.texture=null,t.frame=null,t.hasTexture=!1}))}(t,e,this),this},e.prototype.setFrame=function(t){return fa(this.texture,t,this),this},e.prototype.isRenderable=function(){return this.visible&&this.willRender&&this.hasTexture&&this.alpha>0},e.prototype.preRender=function(){var t,e,n,r,i,o,a,u,s,h,c;this.isDirty(oo)&&(ca(this),this.clearDirty(oo)),this.isDirty(ro)&&(e=(t=this).vertices,n=ko(t.transform),r=n.x0,i=n.y0,o=n.x1,a=n.y1,u=n.x2,s=n.y2,h=n.x3,c=n.y3,e[0].setPosition(r,i),e[1].setPosition(o,a),e[2].setPosition(u,s),e[3].setPosition(h,c),this.clearDirty(ro))},e.prototype.renderGL=function(t){this.preRender(),function(t,e){var n=Vr(e,1),r=n.F32,i=n.U32,o=n.offset,a=qr(e,t.texture),u=o;t.vertices.forEach((function(t){r[u+0]=t.x,r[u+1]=t.y,r[u+2]=t.u,r[u+3]=t.v,r[u+4]=a,i[u+5]=t.color,u+=6}))}(this,t)},e.prototype.renderCanvas=function(t){this.preRender(),function(t,e){var n=t.frame;if(n){var r=e.ctx,i=t.transform,o=i.world,a=o.a,u=o.b,s=o.c,h=o.d,c=o.tx,f=o.ty,d=i.extent,l=d.x,v=d.y;r.save(),r.setTransform(a,u,s,h,c,f),r.globalAlpha=t.alpha,r.drawImage(n.texture.image,n.x,n.y,n.width,n.height,l,v,n.width,n.height),r.restore()}}(this,t)},Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this.vertices.forEach((function(e){e.setAlpha(t)})),this.setDirty(oo))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this.vertices.forEach((function(e){e.setTint(t)})),this.setDirty(oo))},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.texture=null,this.frame=null,this.hasTexture=!1,this.vertices=[]},e}(ha),pa=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,i)||this;return o.type="AnimatedSprite",o.anims=new Map,o.animData={currentAnim:"",currentFrames:[],frameIndex:0,animSpeed:0,nextFrameTime:0,repeatCount:0,isPlaying:!1,yoyo:!1,pendingStart:!1,playingForward:!0,delay:0,repeatDelay:0,onStart:null,onRepeat:null,onComplete:null},o}return h(e,t),e.prototype.stop=function(){var t=this.animData;t.isPlaying=!1,t.currentAnim="",t.onComplete&&t.onComplete(this,t.currentAnim)},e.prototype.nextFrame=function(){var t=this.animData;if(t.frameIndex++,t.frameIndex===t.currentFrames.length)if(t.yoyo)t.frameIndex--,t.playingForward=!1;else{if(!(-1===t.repeatCount||t.repeatCount>0))return t.frameIndex--,this.stop();t.frameIndex=0,-1!==t.repeatCount&&t.repeatCount--,t.onRepeat&&t.onRepeat(this,t.currentAnim),t.nextFrameTime+=t.repeatDelay}this.setFrame(t.currentFrames[t.frameIndex]),t.nextFrameTime+=t.animSpeed},e.prototype.prevFrame=function(){var t=this.animData;if(t.frameIndex--,-1===t.frameIndex){if(!(-1===t.repeatCount||t.repeatCount>0))return t.frameIndex=0,this.stop();t.frameIndex=0,t.playingForward=!0,-1!==t.repeatCount&&t.repeatCount--,t.onRepeat&&t.onRepeat(this,t.currentAnim),t.nextFrameTime+=t.repeatDelay}this.setFrame(t.currentFrames[t.frameIndex]),t.nextFrameTime+=t.animSpeed},e.prototype.update=function(e,n){t.prototype.update.call(this,e,n);var r=this.animData;r.isPlaying&&(r.nextFrameTime-=1e3*e,r.nextFrameTime=Math.max(r.nextFrameTime,0),0===r.nextFrameTime&&(r.pendingStart?(r.onStart&&r.onStart(this,r.currentAnim),r.pendingStart=!1,r.nextFrameTime=r.animSpeed):r.playingForward?this.nextFrame():this.prevFrame()))},Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.animData.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPlayingForward",{get:function(){return this.animData.isPlaying&&this.animData.playingForward},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentAnimation",{get:function(){return this.animData.currentAnim},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.anims.clear(),this.animData=null},e}(va);function ya(t,e,n){n||(n=t.quadShader);var r=e.firstFrame,i=r.u0,o=r.v0,a=r.u1,u=r.v1;!function(t,e){void 0===e&&(e=0);var n=t.binding;n.setIndex(e),$n.activeTexture($n.TEXTURE0+e),$n.bindTexture($n.TEXTURE_2D,n.texture)}(e,0),Ur(t,t.quadBuffer),Wr(t,n,0),function(t,e,n,r,i,o,a,u,s,h,c){void 0===h&&(h=0),void 0===c&&(c=4294967295);var f=Vr(t,1),d=f.F32,l=f.U32,v=f.offset;d[v+0]=e,d[v+1]=n,d[v+2]=o,d[v+3]=s,d[v+4]=h,l[v+5]=c,d[v+6]=e,d[v+7]=n+i,d[v+8]=o,d[v+9]=a,d[v+10]=h,l[v+11]=c,d[v+12]=e+r,d[v+13]=n+i,d[v+14]=u,d[v+15]=a,d[v+16]=h,l[v+17]=c,d[v+18]=e+r,d[v+19]=n,d[v+20]=u,d[v+21]=s,d[v+22]=h,l[v+23]=c}(t,0,0,e.width,e.height,i,o,a,u,0),fr(t),jr(t),Nr(t),function(t,e){void 0===e&&(e=0),$n.activeTexture($n.TEXTURE0+e),$n.bindTexture($n.TEXTURE_2D,t.tempTextures[e]),e>0&&t.startActiveTexture++}(t)}var xa=function(t){function e(){var e=t.call(this)||this;return e.type="Layer",e.transform.passthru=!0,e.willRender=!1,e}return h(e,t),e}(sa),ma=function(t){function e(){var e=t.call(this)||this;e.type="RenderLayer",e.willRender=!0,e.willRenderChildren=!0,e.willCacheChildren=!0,e.setDirty(io);var n=Hn(),r=Wn(),i=qn(),o=new Fr(null,n*i,r*i),a=new xr(o);return o.binding=a,a.framebuffer=Ar(a.texture),e.texture=o,e.framebuffer=a.framebuffer,e}return h(e,t),e.prototype.renderGL=function(t){this.numChildren>0&&(fr(t),!this.willCacheChildren||this.isDirty(io)?(cr(t,this.framebuffer,!0),this.clearDirty(io)):(cr(t,this.framebuffer,!1),this.postRenderGL(t)))},e.prototype.postRenderGL=function(t){fr(t),hr(t),ya(t,this.texture),this.clearDirty(ro)},e}(xa),wa=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.call(this)||this;return r.shaders=[],r.type="EffectLayer",Array.isArray(e)&&(r.shaders=e),r}return h(e,t),e.prototype.postRenderGL=function(t){var e=this.shaders,n=this.texture;if(fr(t),hr(t),0===e.length)ya(t,n);else{for(var r=n,i=0;i<e.length;i++){var o=e[i];ya(t,r,o),r=o.texture}ya(t,r)}this.clearDirty(ro)},e}(ma);function ga(t,e,n,r,i,o,a,u,s,h,c){void 0===a&&(a=0),void 0===u&&(u=1),void 0===s&&(s=1),void 0===h&&(h=0),void 0===c&&(c=0);var f=Math.cos(a+c)*u,d=Math.sin(a+c)*u,l=-Math.sin(a-h)*s,v=Math.cos(a-h)*s;return{x0:t*f+n*l+i,y0:t*d+n*v+o,x1:t*f+r*l+i,y1:t*d+r*v+o,x2:e*f+r*l+i,y2:e*d+r*v+o,x3:e*f+n*l+i,y3:e*d+n*v+o}}var ba=function(t){function e(e,n){var r=t.call(this)||this;return r.glTextureIndex=0,r.hasTexture=!1,r.type="SpriteBatch",r.willRender=!0,r.setTexture(n),r.setMaxSize(e),r}return h(e,t),e.prototype.resetBuffers=function(){for(var t=[],e=0;e<4*this.maxSize;e+=4)t.push(e+0,e+1,e+2,e+2,e+3,e+0);this.data=new ArrayBuffer(96*this.maxSize),this.index=new Uint16Array(t),this.vertexViewF32=new Float32Array(this.data),this.vertexViewU32=new Uint32Array(this.data),$n&&(lr(this.vertexBuffer),lr(this.indexBuffer),this.vertexBuffer=$n.createBuffer(),this.indexBuffer=$n.createBuffer(),$n.bindBuffer($n.ARRAY_BUFFER,this.vertexBuffer),$n.bufferData($n.ARRAY_BUFFER,this.data,$n.STATIC_DRAW),$n.bindBuffer($n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),$n.bufferData($n.ELEMENT_ARRAY_BUFFER,this.index,$n.STATIC_DRAW),$n.bindBuffer($n.ARRAY_BUFFER,null)),t=[],this.count=0},e.prototype.setMaxSize=function(t){return this.maxSize=ct(t,0,65535),this.resetBuffers(),this},e.prototype.setTexture=function(t){var e;return(e=t instanceof Fr?t:da().get(t))?(this.texture=e,this.hasTexture=!0,this.glTextureIndex=-1):console.warn("Invalid Texture key: "+t),this},e.prototype.isRenderable=function(){return this.visible&&this.willRender&&this.hasTexture&&this.count>0},e.prototype.clear=function(){return this.count=0,this},e.prototype.addToBatch=function(t,e,n,r,i,o,a,u,s,h){if(this.count>=this.maxSize)return console.warn("SpriteBatch full"),this;var c=t.u0,f=t.u1,d=t.v0,l=t.v1,v=this.vertexViewF32,p=this.vertexViewU32,y=24*this.count,x=this.texture.binding?this.texture.binding.index:0;return v[y+0]=n,v[y+1]=r,v[y+2]=c,v[y+3]=d,v[y+4]=x,p[y+5]=e,v[y+6]=i,v[y+7]=o,v[y+8]=c,v[y+9]=l,v[y+10]=x,p[y+11]=e,v[y+12]=a,v[y+13]=u,v[y+14]=f,v[y+15]=l,v[y+16]=x,p[y+17]=e,v[y+18]=s,v[y+19]=h,v[y+20]=f,v[y+21]=d,v[y+22]=x,p[y+23]=e,this.setDirty(ro),this.count++,this},e.prototype.add=function(t){var e=t.frame,n=void 0===e?null:e,r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,u=t.rotation,s=void 0===u?0:u,h=t.scaleX,c=void 0===h?1:h,f=t.scaleY,d=void 0===f?1:f,l=t.skewX,v=void 0===l?0:l,p=t.skewY,y=void 0===p?0:p,x=t.originX,m=void 0===x?0:x,w=t.originY,g=void 0===w?0:w,b=t.alpha,M=void 0===b?1:b,_=t.tint,C=void 0===_?16777215:_,T=this.texture.getFrame(n),z=T.getExtent(m,g),S=ga(z.left,z.right,z.top,z.bottom,i,a,s,c,d,v,y),E=S.x0,R=S.y0,P=S.x1,A=S.y1,D=S.x2,F=S.y2,O=S.x3,I=S.y3,L=ia(C,M);return this.addToBatch(T,L,E,R,P,A,D,F,O,I)},e.prototype.addXY=function(t,e,n){var r=this.texture.getFrame(n),i=r.getExtent(0,0),o=ga(i.left,i.right,i.top,i.bottom,t,e),a=o.x0,u=o.y0,s=o.x1,h=o.y1,c=o.x2,f=o.y2,d=o.x3,l=o.y3;return this.addToBatch(r,4294967295,a,u,s,h,c,f,d,l)},e.prototype.updateTextureIndex=function(){var t=this.texture.binding.index;if(t!==this.glTextureIndex){var e=this.vertexViewF32;this.glTextureIndex=t;for(var n=0;n<this.count;n++)e[24*n+4]=t,e[24*n+10]=t,e[24*n+16]=t,e[24*n+22]=t}},e.prototype.renderGL=function(t){},e.prototype.destroy=function(){t.prototype.destroy.call(this),lr(this.vertexBuffer),lr(this.indexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.index=null,this.texture=null,this.hasTexture=!1},e}(xa);function Ma(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n.getContext("2d")}function _a(t,e){void 0===t&&(t=32),void 0===e&&(e=32);var n=Ma(t,e);return new Fr(n.canvas)}var Ca=function(t){function e(e,n,i,o,a){void 0===i&&(i="");var u=t.call(this,e,n,_a())||this;u.splitRegExp=/(?:\r\n|\r|\n)/,u.padding={left:0,right:0,top:0,bottom:0},u.verticalAlign="ascent",u.lineSpacing=0,u.font="16px monospace",u.fillStyle="#fff",u.strokeStyle="",u.backgroundStyle="",u.cornerRadius=0,u.textAlign="left",u.textBaseline="alphabetic",u.lineWidth=0,u.lineDash=[],u.antialias=!1,u.type="Text";var s=r();return u.resolution=s.renderer.resolution,u.canvas=u.texture.image,u.context=u.canvas.getContext("2d"),o&&(u.font=o),a&&(u.fillStyle=a),u.setText(i),u}return h(e,t),e.prototype.syncContext=function(t,e){this.preRenderCallback&&this.preRenderCallback(t,e),e.font=this.font,e.textBaseline=this.textBaseline,e.textAlign=this.textAlign,e.fillStyle=this.fillStyle,e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.lineCap="round",e.lineJoin="round",e.setLineDash(this.lineDash),e.imageSmoothingEnabled=this.antialias},e.prototype.updateText=function(){var t=this.canvas,e=this.context,n=this.resolution,r=this._text.split(this.splitRegExp),i=this.padding,o=this.fillStyle,a=this.strokeStyle,u=this.lineWidth,s=this.lineSpacing,h=u>0?u/2:0;e.clearRect(0,0,t.width,t.height),this.syncContext(t,e),e.textAlign="start";for(var c=0,f=0,d=0,l=[],v="ascent"===this.verticalAlign,p=e.measureText("|Mq"),y=Math.ceil(Math.abs(p.actualBoundingBoxAscent)+Math.abs(p.actualBoundingBoxDescent))+u,x=0;x<r.length;x++){var m=e.measureText(r[x]),w=m.actualBoundingBoxLeft,g=m.actualBoundingBoxRight,b=m.actualBoundingBoxAscent,M=m.actualBoundingBoxDescent;(b||M)&&""!==r[x]||(b=y,M=0);var _=Math.ceil(Math.abs(w)+Math.abs(g))+u,C=Math.ceil(Math.abs(b)+Math.abs(M))+u;v?(d+=b+h,x>0&&(d+=s+h),f=d+M+h):(d=f+(C-M-h),f+=C,x<r.length-1&&(f+=s)),c=Math.max(c,_),l.push({lineWidth:_,lineHeight:C,ascent:b,descent:M,left:w,right:g,y:d})}c+=i.left+i.right,f+=i.top+i.bottom;var T=this.fixedWidth?this.fixedWidth:c,z=this.fixedHeight?this.fixedHeight:f,S=Math.ceil(T*n),E=Math.ceil(z*n);t.width===S&&t.height===E||(t.width=S,t.height=E,this.texture.setSize(T,z),this.setSize(T,z)),e.save(),e.scale(n,n),this.syncContext(t,e);var R=this.backgroundStyle;if(R){e.save(),e.fillStyle=R,e.strokeStyle=R;var P=this.cornerRadius,A=P>0?P/2:0;P&&(e.lineWidth=P,e.strokeRect(A,A,T-P,z-P)),e.fillRect(A,A,T-P,z-P),e.restore()}var D=this.textAlign,F="center"===D,O="right"===D||"end"===D,I=(z-f)/2+i.top;for(x=0;x<r.length;x++){var L=r[x],B=l[x],k=i.left+B.left+h,G=I+B.y;F?k=T/2:O&&(k=T-h),a&&e.strokeText(L,k,G),o&&e.fillText(L,k,G)}return e.restore(),this.texture.binding&&this.texture.binding.update(),this.setDirty(uo),this},Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this.setText(t)},enumerable:!1,configurable:!0}),e.prototype.setText=function(t){return void 0===t&&(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},e.prototype.destroy=function(e){this.texture.destroy(),this.fillStyle=null,this.strokeStyle=null,this.backgroundStyle=null,this.canvas=null,this.context=null,t.prototype.destroy.call(this,e)},e}(va),Ta=Object.freeze({__proto__:null,AnimatedSprite:pa,Components:aa,Container:ha,EffectLayer:wa,Layer:xa,RenderLayer:ma,GameObject:sa,Sprite:va,SpriteBatch:ba,Text:Ca}),za=function(){function t(t,e,n,r){var i=this;void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.passthru=!1,this.entity=t,this.local=new x,this.world=new x,this.normal=new x,this.position=new bt((function(){return i.update()}),e,n,r),this.scale=new bt((function(){return i.update()}),1,1,1),this.origin=new bt((function(){return i.update()})),this.rotation=new M,this.rotation.onChange=function(){return i.update()},this.forward=K(),this.up=Z(),this.right=Y(),this.update()}return t.prototype.rotateX=function(t){kt(this.rotation,t,this.rotation)},t.prototype.rotateY=function(t){Gt(this.rotation,t,this.rotation)},t.prototype.rotateZ=function(t){jt(this.rotation,t,this.rotation)},t.prototype.update=function(){var t=this.local,e=this.normal;m(this.rotation,this.position,this.scale,t),C(t,e),P(e,e)},t.prototype.updateLocal=function(){this.entity.setDirty(ro,ao)},t.prototype.updateWorld=function(){var t=this.entity;t.setDirty(ro,ao),t.numChildren&&this.updateChildren()},t.prototype.updateChildren=function(){for(var t=this.entity.children,e=0;e<t.length;e++)t[e]},t.prototype.destroy=function(){this.position.destroy(),this.scale.destroy(),this.origin.destroy(),this.rotation.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.origin=null,this.rotation=null},t}(),Sa=Object.freeze({__proto__:null,Transform3DComponent:za});function Ea(){return{vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0}}var Ra=Object.freeze({__proto__:null,CreateFramebuffer:Ar,CreateGLTexture:dr,DeleteFramebuffer:lr,DeleteGLBuffer:Mr,DeleteGLTexture:vr,GL:or,PackColor:ia,PackColors:ca,SetGLTextureFilterMode:pr,UpdateGLTexture:yr,WebGLRenderer:Xr}),Pa=function(){function t(t,e,n,r,i,o,a,u,s,h){void 0===h&&(h=1),this.color=16777215,this.alpha=1,this.size=30,this.vertex1=new oa(t.x*h,t.y*h,t.z*h),this.vertex2=new oa(e.x*h,e.y*h,e.z*h),this.vertex3=new oa(n.x*h,n.y*h,n.z*h),this.vertex1.setUV(a.x,a.y),this.vertex2.setUV(u.x,u.y),this.vertex3.setUV(s.x,s.y),this.normal1=r,this.normal2=i,this.normal3=o,this._packedColor=ia(this.color,this.alpha)}return t.prototype.setColor=function(t,e){void 0===e&&(e=1),this.color=t,this.alpha=e,this._packedColor=ia(t,e)},t.prototype.addToBuffer=function(t,e,n,r){var i=this.vertex1,o=this.vertex2,a=this.vertex3,u=this.normal1,s=this.normal2,h=this.normal3,c=this._packedColor;return t[r++]=i.x,t[r++]=i.y,t[r++]=i.z,t[r++]=u.x,t[r++]=u.y,t[r++]=u.z,t[r++]=i.u,t[r++]=i.v,t[r++]=n,e[r++]=c,t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=o.u,t[r++]=o.v,t[r++]=n,e[r++]=c,t[r++]=a.x,t[r++]=a.y,t[r++]=a.z,t[r++]=h.x,t[r++]=h.y,t[r++]=h.z,t[r++]=a.u,t[r++]=a.v,t[r++]=n,e[r++]=c,r},t}();function Aa(t,e){return[t[3*e+0],t[3*e+1],t[3*e+2]]}function Da(t,e){return[t[2*e+0],t[2*e+1]]}function Fa(t){return t.indices&&t.indices.length>0?function(t){for(var e=t.vertices,n=t.normals,r=t.uvs,i=t.indices,o=new _r({batchSize:i.length/3,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),a=o.vertexViewF32,u=0,s=0;s<i.length;s+=3){var h=i[s+0],c=i[s+1],f=i[s+2],d=Aa(e,h),l=Aa(e,c),v=Aa(e,f),p=Aa(n,h),y=Aa(n,c),x=Aa(n,f),m=Da(r,h),w=Da(r,c),g=Da(r,f);a[u++]=d[0],a[u++]=d[1],a[u++]=d[2],a[u++]=p[0],a[u++]=p[1],a[u++]=p[2],a[u++]=m[0],a[u++]=m[1],a[u++]=l[0],a[u++]=l[1],a[u++]=l[2],a[u++]=y[0],a[u++]=y[1],a[u++]=y[2],a[u++]=w[0],a[u++]=w[1],a[u++]=v[0],a[u++]=v[1],a[u++]=v[2],a[u++]=x[0],a[u++]=x[1],a[u++]=x[2],a[u++]=g[0],a[u++]=g[1]}return o.count=i.length,o}(t):function(t){for(var e=t.vertices,n=t.normals,r=t.uvs,i=e.length,o=i/3,a=new _r({batchSize:o/3,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),u=a.vertexViewF32,s=0,h=0,c=0;c<i;c+=3)u[s++]=e[c+0],u[s++]=e[c+1],u[s++]=e[c+2],u[s++]=n[c+0],u[s++]=n[c+1],u[s++]=n[c+2],u[s++]=r[h+0],u[s++]=r[h+1],h+=2;return a.count=o,a}(t)}var Oa=function(){function t(t){t&&(t.hasOwnProperty("vertices")?this.buffer=Fa(t):this.buffer=t)}return t.prototype.destroy=function(){this.buffer.destroy()},t}(),Ia=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n="untitled"),this.currentMaterial="",this.currentGroup="",this.smoothingGroup=0,this.result={materialLibraries:[],models:[]},this.fileContents=t,this.defaultModelName=n,this.flipUVs=e}return t.prototype.parseAsync=function(){var t=this;return new Promise((function(e,n){try{e(t.parse())}catch(t){n(t)}}))},t.prototype.parse=function(){var t,e,n=function(t){var e=t.indexOf("#");return e>-1?t.substring(0,e):t},r=this.fileContents.split("\n");try{for(var i=c(r),o=i.next();!o.done;o=i.next()){var a=n(o.value).replace(/\s\s+/g," ").trim().split(" ");switch(a[0].toLowerCase()){case"o":this.parseObject(a);break;case"g":this.parseGroup(a);break;case"v":this.parseVertexCoords(a);break;case"vt":this.parseTextureCoords(a);break;case"vn":this.parseVertexNormal(a);break;case"s":this.parseSmoothShadingStatement(a);break;case"f":this.parsePolygon(a);break;case"mtllib":this.parseMtlLib(a);break;case"usemtl":this.parseUseMtl(a)}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return this.fileContents="",this.result},t.prototype.currentModel=function(){return 0===this.result.models.length&&(this.result.models.push({faces:[],name:this.defaultModelName,textureCoords:[],vertexNormals:[],vertices:[]}),this.currentGroup="",this.smoothingGroup=0),this.result.models[this.result.models.length-1]},t.prototype.parseObject=function(t){var e=t.length>=2?t[1]:this.defaultModelName;this.result.models.push({faces:[],name:e,textureCoords:[],vertexNormals:[],vertices:[]}),this.currentGroup="",this.smoothingGroup=0},t.prototype.parseGroup=function(t){if(2!==t.length)throw"Group statements must have exactly 1 argument (eg. g group_1)";this.currentGroup=t[1]},t.prototype.parseVertexCoords=function(t){var e=t.length,n=e>=2?parseFloat(t[1]):0,r=e>=3?parseFloat(t[2]):0,i=e>=4?parseFloat(t[3]):0;this.currentModel().vertices.push({x:n,y:r,z:i})},t.prototype.parseTextureCoords=function(t){var e=t.length,n=e>=2?parseFloat(t[1]):0,r=e>=3?parseFloat(t[2]):0,i=e>=4?parseFloat(t[3]):0;isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(i)&&(i=0),this.flipUVs&&(r=1-r),this.currentModel().textureCoords.push({u:n,v:r,w:i})},t.prototype.parseVertexNormal=function(t){var e=t.length,n=e>=2?parseFloat(t[1]):0,r=e>=3?parseFloat(t[2]):0,i=e>=4?parseFloat(t[3]):0;this.currentModel().vertexNormals.push({x:n,y:r,z:i})},t.prototype.parsePolygon=function(t){var e=t.length-1;if(e<3)throw"Face < 3 vertices";for(var n={group:this.currentGroup,material:this.currentMaterial,smoothingGroup:this.smoothingGroup,vertices:[]},r=0;r<e;r++){var i=t[r+1].split("/"),o=i.length;if(o<1||o>3)throw"Too many / values for single vertex";var a=0,u=0,s=0;if(a=parseInt(i[0],10),o>1&&""!==i[1]&&(u=parseInt(i[1],10)),o>2&&(s=parseInt(i[2],10)),0===a)throw"Faces uses invalid vertex index of 0";a<0&&(a=this.currentModel().vertices.length+1+a),u-=1,a-=1,s-=1,n.vertices.push({textureCoordsIndex:u,vertexIndex:a,vertexNormalIndex:s})}this.currentModel().faces.push(n)},t.prototype.parseMtlLib=function(t){t.length>=2&&this.result.materialLibraries.push(t[1])},t.prototype.parseUseMtl=function(t){t.length>=2&&(this.currentMaterial=t[1])},t.prototype.parseSmoothShadingStatement=function(t){if(2!==t.length)throw"Smoothing group statements must have exactly 1 argument (eg. s <number|off>)";var e="off"===t[1].toLowerCase()?0:parseInt(t[1],10);this.smoothingGroup=e},t}();function La(t,e){void 0===e&&(e=!0);var n=new Ia(t,e).parse(),r=[];return n.models.forEach((function(t){for(var e=t.faces,n=t.textureCoords,i=t.vertexNormals,o=t.vertices,a=0,u=0;u<e.length;u++)a+=4===e[u].vertices.length?6:3;var s=new _r({batchSize:a,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),h=s.vertexViewF32,c=0;for(u=0;u<e.length;u++){var f=e[u],d=f.vertices[0],l=f.vertices[1],v=f.vertices[2],p=o[d.vertexIndex],y=o[l.vertexIndex],x=o[v.vertexIndex],m=i[d.vertexNormalIndex],w=i[l.vertexNormalIndex],g=i[v.vertexNormalIndex],b=n[d.textureCoordsIndex],M=n[l.textureCoordsIndex],_=n[v.textureCoordsIndex];if(h[c++]=p.x,h[c++]=p.y,h[c++]=p.z,h[c++]=m.x,h[c++]=m.y,h[c++]=m.z,h[c++]=b.u,h[c++]=b.v,h[c++]=y.x,h[c++]=y.y,h[c++]=y.z,h[c++]=w.x,h[c++]=w.y,h[c++]=w.z,h[c++]=M.u,h[c++]=M.v,h[c++]=x.x,h[c++]=x.y,h[c++]=x.z,h[c++]=g.x,h[c++]=g.y,h[c++]=g.z,h[c++]=_.u,h[c++]=_.v,s.count+=3,4===f.vertices.length){var C=f.vertices[3],T=o[C.vertexIndex],z=i[C.vertexNormalIndex],S=n[C.textureCoordsIndex];h[c++]=p.x,h[c++]=p.y,h[c++]=p.z,h[c++]=m.x,h[c++]=m.y,h[c++]=m.z,h[c++]=b.u,h[c++]=b.v,h[c++]=x.x,h[c++]=x.y,h[c++]=x.z,h[c++]=g.x,h[c++]=g.y,h[c++]=g.z,h[c++]=_.u,h[c++]=_.v,h[c++]=T.x,h[c++]=T.y,h[c++]=T.z,h[c++]=z.x,h[c++]=z.y,h[c++]=z.z,h[c++]=S.u,h[c++]=S.v,s.count+=3}}r.push({name:t.name,buffer:s})})),r}function Ba(t,e){return[t[3*e+0],t[3*e+1],t[3*e+2]]}function ka(t,e){return[t[2*e+0],t[2*e+1]]}var Ga=Object.freeze({__proto__:null,CreateVertexSet:Ea,FaceUVNormalTexture:Pa,Geometry:Oa,GetBufferFromObj:La,GetBufferFromVertexSet:Fa,GetFacesFromVertexSet:function(t){for(var e=t.vertices,n=t.normals,r=t.uvs,i=t.indices,o=[],a=0;a<i.length;a+=3){var u=i[a+0],s=i[a+1],h=i[a+2],c=Ba(e,u),f=Ba(e,s),d=Ba(e,h),l=Ba(n,u),v=Ba(n,s),p=Ba(n,h),y=ka(r,u),x=ka(r,s),m=ka(r,h),w=new Pa({x:c[0],y:c[1],z:c[2]},{x:f[0],y:f[1],z:f[2]},{x:d[0],y:d[1],z:d[2]},{x:l[0],y:l[1],z:l[2]},{x:v[0],y:v[1],z:v[2]},{x:p[0],y:p[1],z:p[2]},{x:y[0],y:y[1]},{x:x[0],y:x[1]},{x:m[0],y:m[1]},1);o.push(w)}return o},ParseObj:Ia});function ja(t,e,n,r,i,o,a,u,s,h,c,f,d,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=1),void 0===a&&(a=2),void 0===u&&(u=1),void 0===s&&(s=-1),void 0===h&&(h=1),void 0===c&&(c=1),void 0===f&&(f=1),void 0===d&&(d=1),void 0===l&&(l=1),t||(t={vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0});for(var v=t.vertices,p=t.normals,y=t.uvs,x=t.indices,m=t.numberOfVertices,w=h/d,g=c/l,b=h/2,M=c/2,_=f/2,C=d+1,T=l+1,z=0,S=[],E=0;E<T;E++)for(var R=E*g-M,P=0;P<C;P++){var A=P*w-b;S[i]=A*u,S[o]=R*s,S[a]=_,v.push(e+S[0],n+S[1],r+S[2]),S[i]=0,S[o]=0,S[a]=f>0?1:-1,p.push(S[0],S[1],S[2]),y.push(P/d),y.push(1-E/l),z+=1}for(E=0;E<l;E++)for(P=0;P<d;P++){var D=m+P+C*E,F=m+P+C*(E+1),O=m+(P+1)+C*(E+1),I=m+(P+1)+C*E;x.push(D,F,I),x.push(F,O,I)}return t.numberOfVertices+=z,t}function Ua(t,e,n,r,i,o,a,u,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),void 0===u&&(u=1),void 0===s&&(s=1);var h={vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0};return ja(h,t,e,n,2,1,0,-1,-1,o,i,r,s,u),ja(h,t,e,n,2,1,0,1,-1,o,i,-r,s,u),ja(h,t,e,n,0,2,1,1,1,r,o,i,a,s),ja(h,t,e,n,0,2,1,1,-1,r,o,-i,a,s),ja(h,t,e,n,0,1,2,1,-1,r,i,o,a,u),ja(h,t,e,n,0,1,2,-1,-1,r,i,-o,a,u),h}var Va=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.type="GameObject3D",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new za(this,t,e,n),this.dirty=so}return t.prototype.isRenderable=function(){return this.visible&&this.willRender},t.prototype.isDirty=function(t){return 0!=(this.dirty&t)},t.prototype.clearDirty=function(t){return this.isDirty(t)&&(this.dirty^=t),this},t.prototype.setDirty=function(t,e){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=o()),this.isDirty(e)||(this.dirty^=e),this},t.prototype.update=function(t,e){if(this.willUpdateChildren)for(var n=this.children,r=0;r<n.length;r++){var i=n[r];i&&i.willUpdate&&i.update(t,e)}this.postUpdate(t,e)},t.prototype.postUpdate=function(t,e){},t.prototype.renderGL=function(t){},t.prototype.postRenderGL=function(t){},Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),t.prototype.destroy=function(t){$i(this,"destroy",this),this.transform.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null},t}(),Na=function(){function t(t){var e=this;void 0===t&&(t={}),this.isDirty=!1;var n=t.ambient,r=void 0===n?[1,1,1]:n,i=t.diffuse,o=void 0===i?[1,1,1]:i,a=t.specular,u=void 0===a?[1,1,1]:a,s=t.shine,h=void 0===s?.25:s,c=function(){return e.update()};this.ambient=new Mt(c).fromArray(r),this.diffuse=new Mt(c).fromArray(o),this.specular=new Mt(c).fromArray(u),this._shine=h}return Object.defineProperty(t.prototype,"shine",{get:function(){return this._shine},set:function(t){this._shine=ct(t,0,1),this.isDirty=!0},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.isDirty=!0},t.prototype.setUniforms=function(t){t.setUniform("uMaterialAmbient",this.ambient.toArray()),t.setUniform("uMaterialDiffuse",this.diffuse.toArray()),t.setUniform("uMaterialSpecular",this.specular.toArray()),t.setUniform("uMaterialShine",256*this._shine)},t.prototype.destroy=function(){this.ambient.destroy(),this.diffuse.destroy(),this.specular.destroy()},t}();function Wa(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=t.getFrame(e);return n.forEach((function(t){t&&i!==t.frame&&(t.frame=i,t.hasTexture=!0)})),n}var qa=function(t){function e(e,n,r,i,o){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=new Na);var a=t.call(this,e,n,r)||this;return a.hasTexture=!1,a.cullFaces=!0,a.geometry=i,a.material=o,a.setTexture("__WHITE"),a}return h(e,t),e.prototype.setTexture=function(t,e){return function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];t?(n=t instanceof Fr?t:da().get(t))?(r.forEach((function(t){t.texture=n})),Wa.apply(void 0,d([n,e],r))):console.warn("Invalid Texture key: "+t):r.forEach((function(t){t.texture=null,t.frame=null,t.hasTexture=!1}))}(t,e,this),this},e.prototype.setFrame=function(t){return Wa(this.texture,t,this),this},e.prototype.setMaterial=function(t){return this.material=t,this},e.prototype.renderGL=function(t){var e=t.currentShader.shader;if(e.setUniform("uModelMatrix",this.transform.local.data),e.setUniform("uNormalMatrix",this.transform.normal.data),this.hasTexture){var n=qr(t,this.texture);e.setUniform("uTexture",n)}this.material.setUniforms(e),function(t,e){Ur(t,e),t.currentShader.shader.setAttributes(t);var n=fr(t,e.count);jr(t)}(t,this.geometry.buffer)},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry=null,this.material=null,this.texture=null,this.frame=null,this.hasTexture=!1},e}(Va),Ha=function(t){function e(e,n,r,i,o,a,u,s,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),void 0===u&&(u=1),void 0===s&&(s=1),void 0===h&&(h=1);var c=Ua(0,0,0,i,o,a,u,s,h),f=new Oa(c);return t.call(this,e,n,r,f)||this}return h(e,t),e}(qa);function Ka(t,e,n,r,i,o,a,u,s){for(var h=e.vertices,c=e.normals,f=e.uvs,d=e.indices,l=new I,v=new g,p=!0===t?i:o,y=!0===t?1:-1,x=n,m=1;m<=a;m++)h.push(0,r*y,0),c.push(0,y,0),f.push(.5,.5),n++;var w=n;for(m=0;m<=a;m++){var b=m/a*s+u,M=Math.cos(b),_=Math.sin(b);v.x=p*_,v.y=r*y,v.z=p*M,h.push(v.x,v.y,v.z),c.push(0,y,0),l.x=.5*M+.5,l.y=.5*_*y+.5,f.push(l.x,l.y),n++}for(m=0;m<a;m++){var C=x+m,T=w+m;t?d.push(T,T+1,C):d.push(T+1,T,C)}return n}function Xa(t,e,n,r,i,o,a,u){void 0===t&&(t=1),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=!1),void 0===a&&(a=0),void 0===u&&(u=2*Math.PI);for(var s={vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0},h=s.vertices,c=s.normals,f=s.uvs,d=s.indices,l=0,v=[],p=n/2,y=new g,x=new g,m=(e-t)/n,w=0;w<=i;w++){for(var b=[],M=w/i,_=M*(e-t)+t,C=0;C<=r;C++){var T=C/r,z=T*u+a,S=Math.sin(z),E=Math.cos(z);x.x=_*S,x.y=-M*n+p,x.z=_*E,h.push(x.x,x.y,x.z),y.set(S,m,E),xt(y,y),c.push(y.x,y.y,y.z),f.push(T,1-M),b.push(l++)}v.push(b)}for(C=0;C<r;C++)for(w=0;w<i;w++){var R=v[w][C],P=v[w+1][C],A=v[w+1][C+1],D=v[w][C+1];d.push(R,P,D),d.push(P,A,D)}return o||(t>0&&(l=Ka(!0,s,l,p,t,e,r,a,u)),e>0&&Ka(!1,s,l,p,t,e,r,a,u)),s.numberOfVertices=h.length,s}function Ya(t,e,n,r,i,o,a){return void 0===t&&(t=1),void 0===e&&(e=1),void 0===n&&(n=8),void 0===r&&(r=1),void 0===i&&(i=!1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),Xa(0,t,e,n,r,i,o,a)}var Za=function(t){function e(e,n,r,i,o,a,u,s,h,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=8),void 0===u&&(u=1),void 0===s&&(s=!1),void 0===h&&(h=0),void 0===c&&(c=2*Math.PI);var f=Ya(i,o,a,u,s,h,c),d=new Oa(f);return t.call(this,e,n,r,d)||this}return h(e,t),e}(qa),Ja=function(){function t(t){var e=this;void 0===t&&(t={}),this.isDirty=!1;var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,a=t.z,u=void 0===a?.1:a,s=t.ambient,h=void 0===s?[1,1,1]:s,c=t.diffuse,f=void 0===c?[1,1,1]:c,d=t.specular,l=void 0===d?[1,1,1]:d,v=function(){return e.update()};this.position=new bt(v,r,o,u),this.ambient=new Mt(v).fromArray(h),this.diffuse=new Mt(v).fromArray(f),this.specular=new Mt(v).fromArray(l)}return t.prototype.setUniforms=function(t){t.setUniform("uLightPosition",this.position.toArray()),t.setUniform("uLightAmbient",this.ambient.toArray()),t.setUniform("uLightDiffuse",this.diffuse.toArray()),t.setUniform("uLightSpecular",this.specular.toArray())},t.prototype.update=function(){this.isDirty=!0},t.prototype.destroy=function(){this.position.destroy(),this.ambient.destroy(),this.diffuse.destroy(),this.specular.destroy()},t}(),Qa=function(t){function e(e,n,r,i,o,a,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),void 0===u&&(u=1);var s=ja(null,0,0,0,0,1,2,1,-1,i,o,1,a,u),h=new Oa(s);return t.call(this,e,n,r,h)||this}return h(e,t),e}(qa),$a=function(t){function e(){var e=t.call(this)||this;e.type="RenderLayer",e.willRender=!0,e.willRenderChildren=!0,e.willCacheChildren=!0,e.setDirty(io);var n=Hn(),r=Wn(),i=qn(),o=new Fr(null,n*i,r*i),a=new xr(o);return o.binding=a,a.framebuffer=Ar(a.texture),a.depthbuffer=Pr(a.framebuffer,o.width,o.height),e.texture=o,e.framebuffer=a.framebuffer,e}return h(e,t),e.prototype.renderGL=function(t){this.numChildren>0&&(fr(t),!this.willCacheChildren||this.isDirty(io)?(cr(t,this.framebuffer,!0),this.clearDirty(io)):(cr(t,this.framebuffer,!1),this.postRenderGL(t)))},e.prototype.postRenderGL=function(t){fr(t),hr(t),ya(t,this.texture),this.clearDirty(ro)},e}(xa);function tu(t,e,n,r,i,o,a){void 0===t&&(t=1),void 0===e&&(e=3),void 0===n&&(n=3),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),void 0===o&&(o=0),void 0===a&&(a=Math.PI),e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6);for(var u=Math.min(o+a,Math.PI),s={vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0},h=s.vertices,c=s.normals,f=s.uvs,d=s.indices,l=0,v=[],p=new g,y=new g,x=0;x<=n;x++){var m=[],w=x/n,b=0;0===x&&0===o?b=.5/e:x===n&&u==Math.PI&&(b=-.5/e);for(var M=0;M<=e;M++){var _=M/e;p.x=-t*Math.cos(r+_*i)*Math.sin(o+w*a),p.y=t*Math.cos(o+w*a),p.z=t*Math.sin(r+_*i)*Math.sin(o+w*a),h.push(p.x,p.y,p.z),xt(p,y),c.push(y.x,y.y,y.z),f.push(_+b,1-w),m.push(l++)}v.push(m)}for(x=0;x<n;x++)for(M=0;M<e;M++){var C=v[x][M+1],T=v[x][M],z=v[x+1][M],S=v[x+1][M+1];(0!==x||o>0)&&d.push(C,T,S),(x!==n-1||u<Math.PI)&&d.push(T,z,S)}return s.numberOfVertices=h.length,s}var eu=function(t){function e(e,n,r,i,o,a,u,s,h,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===o&&(o=3),void 0===a&&(a=3),void 0===u&&(u=0),void 0===s&&(s=2*Math.PI),void 0===h&&(h=0),void 0===c&&(c=Math.PI);var f=tu(i,o,a,u,s,h,c),d=new Oa(f);return t.call(this,e,n,r,d)||this}return h(e,t),e}(qa),nu=Object.freeze({__proto__:null,Components:Sa,Geometry:Ga,Box:Ha,Cone:Za,Light:Ja,Material:Na,Mesh:qa,Plane:Qa,RenderLayer3D:$a,Sphere:eu,GameObject3D:Va});function ru(t,e,n){return t.radius>0&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-n)*(t.y-n)<=t.radius*t.radius}var iu=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.set(t,e,n)}return t.prototype.set=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this},t.prototype.contains=function(t,e){return ru(this,t,e)},Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diameter",{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius},enumerable:!1,configurable:!0}),t}();function ou(t){return Math.PI*t.radius*2}function au(t,e,n){return void 0===n&&(n=new I),n.set(t.x+t.radius*Math.cos(e),t.y+t.radius*Math.sin(e))}var uu=Object.freeze({__proto__:null,Circle:iu,CircleContains:ru,CircleContainsPoint:function(t,e){return ru(t,e.x,e.y)},CircleContainsRect:function(t,e){return ru(t,e.x,e.y)&&ru(t,e.right,e.y)&&ru(t,e.x,e.bottom)&&ru(t,e.right,e.bottom)},CircleEquals:function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius},GetCircleRandomPoint:function(t,e){void 0===e&&(e=new I);var n=2*Math.PI*Math.random(),r=Math.random()+Math.random(),i=r>1?2-r:r,o=i*Math.cos(n),a=i*Math.sin(n);return e.set(t.x+o*t.radius,t.y+a*t.radius)},CloneCircle:function(t){return new iu(t.x,t.y,t.radius)},CopyCircleFrom:function(t,e){return e.set(t.x,t.y,t.radius)},GetCircleArea:function(t){return t.radius>0?Math.PI*t.radius*t.radius:0},GetCircleBounds:function(t,e){return void 0===e&&(e=new O),e.set(t.left,t.top,t.diameter,t.diameter)},GetCircleCircumference:ou,GetCircleCircumferencePoint:au,GetCirclePoint:function(t,e,n){return void 0===n&&(n=new I),au(t,Tn(e,0,B.PI2),n)},GetCirclePoints:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=[]),n||(n=ou(t)/e);for(var i=0;i<n;i++){var o=Tn(i/n,0,B.PI2);r.push(au(t,o))}return r},TranslateCircle:function(t,e,n){return t.x+=e,t.y+=n,t},TranslateCirclePoint:function(t,e){return t.x+=e.x,t.y+=e.y,t}});function su(t,e,n){if(t.width<=0||t.height<=0)return!1;var r=(e-t.x)/t.width,i=(n-t.y)/t.height;return(r*=r)+(i*=i)<.25}var hu=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.set(t,e,n,r)}return t.prototype.set=function(t,e,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=n,this.height=r,this},t.prototype.contains=function(t,e){return su(this,t,e)},t.prototype.getMinorRadius=function(){return Math.min(this.width,this.height)/2},t.prototype.getMajorRadius=function(){return Math.max(this.width,this.height)/2},Object.defineProperty(t.prototype,"left",{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2},enumerable:!1,configurable:!0}),t}();function cu(t){var e=t.width/2,n=t.height/2,r=Math.pow(e-n,2)/Math.pow(e+n,2);return Math.PI*(e+n)*(1+3*r/(10+Math.sqrt(4-3*r)))}function fu(t,e,n){void 0===n&&(n=new I);var r=t.width/2,i=t.height/2;return n.set(t.x+r*Math.cos(e),t.y+i*Math.sin(e))}var du=Object.freeze({__proto__:null,CloneEllipse:function(t){return new hu(t.x,t.y,t.width,t.height)},CopyEllipseFrom:function(t,e){return e.set(t.x,t.y,t.width,t.height)},Ellipse:hu,EllipseContains:su,EllipseContainsPoint:function(t,e){return su(t,e.x,e.y)},EllipseContainsRect:function(t,e){return su(t,e.x,e.y)&&su(t,e.right,e.y)&&su(t,e.x,e.bottom)&&su(t,e.right,e.bottom)},EllipseEquals:function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},GetEllipseRandomPoint:function(t,e){void 0===e&&(e=new I);var n=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());return e.x=t.x+r*Math.cos(n)*t.width/2,e.y=t.y+r*Math.sin(n)*t.height/2,e},GetEllipseArea:function(t){return t.width<=0||t.height<=0?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI},GetEllipseBounds:function(t,e){return void 0===e&&(e=new O),e.set(t.left,t.top,t.width,t.height)},GetEllipseCircumference:cu,GetEllipseCircumferencePoint:fu,GetEllipsePoint:function(t,e,n){return void 0===n&&(n=new I),fu(t,Tn(e,0,B.PI2),n)},GetEllipsePoints:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=[]),n||(n=cu(t)/e);for(var i=0;i<n;i++){var o=Tn(i/n,0,B.PI2);r.push(fu(t,o))}return r},TranslateEllipse:function(t,e,n){return t.x+=e,t.y+=n,t},TranslateEllipsePoint:function(t,e){return t.x+=e.x,t.y+=e.y,t}});function lu(t,e){return rn(t,e)<=t.radius+e.radius}function vu(t,e){var n=e.width/2,r=e.height/2,i=Math.abs(t.x-e.x-n),o=Math.abs(t.y-e.y-r),a=n+t.radius,u=r+t.radius;if(i>a||o>u)return!1;if(i<=n||o<=r)return!0;var s=i-n,h=o-r;return s*s+h*h<=t.radius*t.radius}var pu=new I;function yu(t,e,n){n||(n=pu);var r=t.x1,i=t.y1,o=t.x2,a=t.y2;if(ru(e,r,i))return n.set(r,i),!0;if(ru(e,o,a))return n.set(o,a),!0;var u=o-r,s=a-i,h=e.x-r,c=e.y-i,f=u*u+s*s,d=u,l=s;if(f>0){var v=(h*u+c*s)/f;d*=v,l*=v}return n.set(r+d,i+l),d*d+l*l<=f&&d*u+l*s>=0&&ru(e,n.x,n.y)}function xu(t,e,n){if(void 0===n&&(n=[]),yu(t,e)){var r=t.x1,i=t.y1,o=t.x2,a=t.y2,u=e.radius,s=o-r,h=a-i,c=r-e.x,f=i-e.y,d=s*s+h*h,l=2*(s*c+h*f),v=l*l-4*d*(c*c+f*f-u*u),p=void 0,y=void 0;if(0===v){var x=-l/(2*d);p=r+x*s,y=i+x*h,x>=0&&x<=1&&n.push(new I(p,y))}else if(v>0){var m=(-l-Math.sqrt(v))/(2*d);p=r+m*s,y=i+m*h,m>=0&&m<=1&&n.push(new I(p,y));var w=(-l+Math.sqrt(v))/(2*d);p=r+w*s,y=i+w*h,w>=0&&w<=1&&n.push(new I(p,y))}}return n}function mu(t,e,n){var r=t.x1,i=t.y1,o=t.x2,a=t.y2,u=e.x1,s=e.y1,h=e.x2,c=e.y2,f=(c-s)*(o-r)-(h-u)*(a-i);if(0===f)return!1;var d=((h-u)*(i-s)-(c-s)*(r-u))/f,l=((o-r)*(i-s)-(a-i)*(r-u))/f;return d>=0&&d<=1&&l>=0&&l<=1&&(n&&n.set(r+d*(o-r),i+d*(a-i)),!0)}function wu(t,e){var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=e.x,u=e.y,s=e.right,h=e.bottom,c=0;if(n>=a&&n<=s&&r>=u&&r<=h||i>=a&&i<=s&&o>=u&&o<=h)return!0;if(n<a&&i>=a){if((c=r+(o-r)*(a-n)/(i-n))>u&&c<=h)return!0}else if(n>s&&i<=s&&(c=r+(o-r)*(s-n)/(i-n))>=u&&c<=h)return!0;if(r<u&&o>=u){if((c=n+(i-n)*(u-r)/(o-r))>=a&&c<=s)return!0}else if(r>h&&o<=h&&(c=n+(i-n)*(h-r)/(o-r))>=a&&c<=s)return!0;return!1}function gu(t,e,n){if(void 0===n&&(n=[]),wu(t,e))for(var r=f(Yo(e),4),i=r[0],o=r[1],a=r[2],u=r[3],s=[new I,new I,new I,new I],h=[mu(i,t,s[0]),mu(o,t,s[1]),mu(a,t,s[2]),mu(u,t,s[3])],c=0;c<h.length;c++)h[c]&&n.push(s[c]);return n}function bu(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=t.x3,a=t.y3;return[new Xo(e,n,r,i),new Xo(r,i,o,a),new Xo(o,a,e,n)]}function Mu(t,e,n){var r=t.x1,i=t.y1,o=t.x2,a=t.y2,u=t.x3-r,s=t.y3-i,h=o-r,c=a-i,f=e-r,d=n-i,l=u*u+s*s,v=u*h+s*c,p=u*f+s*d,y=h*h+c*c,x=h*f+c*d,m=l*y-v*v,w=0===m?0:1/m,g=(y*p-v*x)*w,b=(l*x-v*p)*w;return g>=0&&b>=0&&g+b<1}function _u(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=[]);var i=!1;return e.forEach((function(e){if(!i){var o=e.x,a=e.y;Mu(t,o,a)&&(r.push(new I(o,a)),n&&(i=!0))}})),r}function Cu(t,e){if(e.left>t.right||e.right<t.x||e.top>t.bottom||e.bottom<t.y)return!1;var n=f(bu(e),3),r=n[0],i=n[1],o=n[2];if(F(t,r.x1,r.y1)||F(t,r.x2,r.y2))return!0;if(F(t,i.x1,i.y1)||F(t,i.x2,i.y2))return!0;if(F(t,o.x1,o.y1)||F(t,o.x2,o.y2))return!0;var a=f(Yo(t),4),u=a[0],s=a[1],h=a[2],c=a[3];return!!(mu(r,u)||mu(r,s)||mu(r,h)||mu(r,c))||(!!(mu(i,u)||mu(i,s)||mu(i,h)||mu(i,c))||(!!(mu(o,u)||mu(o,s)||mu(o,h)||mu(o,c))||_u(e,Wo(t),!0).length>0))}function Tu(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;if(Mu(t,e.x,e.y))return!0;var n=f(bu(t),3),r=n[0],i=n[1],o=n[2];return yu(r,e)||yu(i,e)||yu(o,e)}function zu(t,e){var n=e.x1,r=e.y1,i=e.x2,o=e.y2;if(Mu(t,n,r)||Mu(t,i,o))return!0;var a=f(bu(t),3),u=a[0],s=a[1],h=a[2];return mu(u,e)||mu(s,e)||mu(h,e)}function Su(t,e,n){if(void 0===n&&(n=[]),zu(t,e))for(var r=f(bu(t),3),i=r[0],o=r[1],a=r[2],u=[new I,new I,new I],s=[mu(i,e,u[0]),mu(o,e,u[1]),mu(a,e,u[2])],h=0;h<s.length;h++)s[h]&&n.push(u[h]);return n}function Eu(t,e){void 0===e&&(e=[]);var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=t.x3,u=t.y3;return e.push(new I(n,r),new I(i,o),new I(a,u)),e}function Ru(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;var n=f(bu(t),3),r=n[0],i=n[1],o=n[2],a=f(bu(e),3),u=a[0],s=a[1],h=a[2];return!!(mu(r,u)||mu(r,s)||mu(r,h)||mu(i,u)||mu(i,s)||mu(i,h)||mu(o,u)||mu(o,s)||mu(o,h))||(_u(e,Eu(t),!0).length>0||_u(t,Eu(e),!0).length>0)}function Pu(t,e,n){void 0===n&&(n=1);var r=e.x1,i=e.y1,o=e.x2,a=e.y2,u=t.x,s=t.y,h=(o-r)*(o-r)+(a-i)*(a-i);if(0===h)return!1;var c=((u-r)*(o-r)+(s-i)*(a-i))/h;if(c<0)return Math.sqrt((r-u)*(r-u)+(i-s)*(i-s))<=n;if(c>=0&&c<=1){var f=((i-s)*(o-r)-(r-u)*(a-i))/h;return Math.abs(f)*Math.sqrt(h)<=n}return Math.sqrt((o-u)*(o-u)+(a-s)*(a-s))<=n}var Au=Object.freeze({__proto__:null,CircleToCircle:lu,CircleToRectangle:vu,GetCircleToCircle:function(t,e,n){if(void 0===n&&(n=[]),lu(t,e)){var r=t.x,i=t.y,o=t.radius,a=e.x,u=e.y,s=e.radius,h=void 0,c=void 0,f=void 0,d=void 0;if(i===u)0===(f=(c=-2*u)*c-4*(h=1)*(a*a+(d=(s*s-o*o-a*a+r*r)/(2*(r-a)))*d-2*a*d+u*u-s*s))?n.push(new I(d,-c/(2*h))):f>0&&(n.push(new I(d,(-c+Math.sqrt(f))/(2*h))),n.push(new I(d,(-c-Math.sqrt(f))/(2*h))));else{var l=(r-a)/(i-u),v=(s*s-o*o-a*a+r*r-u*u+i*i)/(2*(i-u));0===(f=(c=2*i*l-2*v*l-2*r)*c-4*(h=l*l+1)*(r*r+i*i+v*v-o*o-2*i*v))?(d=-c/(2*h),n.push(new I(d,v-d*l))):f>0&&(d=(-c+Math.sqrt(f))/(2*h),n.push(new I(d,v-d*l)),d=(-c-Math.sqrt(f))/(2*h),n.push(new I(d,v-d*l)))}}return n},GetCircleToRectangle:function(t,e,n){if(void 0===n&&(n=[]),vu(t,e)){var r=f(Yo(e),4),i=r[0],o=r[1],a=r[2],u=r[3];xu(i,t,n),xu(o,t,n),xu(a,t,n),xu(u,t,n)}return n},GetLineToCircle:xu,GetLineToRectangle:gu,GetRectangleIntersection:function(t,e,n){if(void 0===n&&(n=new O),vo(t,e)){var r=Math.max(t.x,e.x),i=Math.max(t.y,e.y);return n.set(r,i,Math.min(t.right,e.right)-r,Math.min(t.bottom,e.bottom)-i)}},GetRectangleToRectangle:function(t,e,n){if(void 0===n&&(n=[]),vo(t,e)){var r=f(Yo(t),4),i=r[0],o=r[1],a=r[2],u=r[3];gu(i,e,n),gu(o,e,n),gu(a,e,n),gu(u,e,n)}return n},GetRectangleToTriangle:function(t,e,n){if(void 0===n&&(n=[]),Cu(t,e)){var r=f(bu(e),3),i=r[0],o=r[1],a=r[2];gu(i,t,n),gu(o,t,n),gu(a,t,n)}return n},GetTriangleToCircle:function(t,e,n){if(void 0===n&&(n=[]),Tu(t,e)){var r=f(bu(t),3),i=r[0],o=r[1],a=r[2];xu(i,e,n),xu(o,e,n),xu(a,e,n)}return n},GetTriangleToLine:Su,GetTriangleToTriangle:function(t,e,n){if(void 0===n&&(n=[]),Ru(t,e)){var r=f(bu(e),3),i=r[0],o=r[1],a=r[2];Su(t,i,n),Su(t,o,n),Su(t,a,n)}return n},LineToCircle:yu,LineToLine:mu,LineToRectangle:wu,PointToLine:Pu,PointToLineSegment:function(t,e){if(!Pu(t,e))return!1;var n=e.x1,r=e.y1,i=e.x2,o=e.y2,a=t.x,u=t.y,s=Math.min(n,i),h=Math.max(n,i),c=Math.min(r,o),f=Math.max(r,o);return a>=s&&a<=h&&u>=c&&u<=f},RectangleToRectangle:vo,RectangleToTriangle:Cu,TriangleToCircle:Tu,TriangleToLine:zu,TriangleToTriangle:Ru});function Du(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2;return Math.sqrt((r-e)*(r-e)+(i-n)*(i-n))}function Fu(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}function Ou(t){return G(Fu(t)-B.HALF_PI,-Math.PI,Math.PI)}function Iu(t,e,n,r){var i=Math.cos(r),o=Math.sin(r),a=t.x1-e,u=t.y1-n;return t.x1=a*i-u*o+e,t.y1=a*o+u*i+n,a=t.x2-e,u=t.y2-n,t.x2=a*i-u*o+e,t.y2=a*o+u*i+n,t}function Lu(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t}var Bu=Object.freeze({__proto__:null,CenterLineOn:function(t,e,n){var r=e-(t.x1+t.x2)/2,i=n-(t.y1+t.y2)/2;return t.x1+=r,t.y1+=i,t.x2+=r,t.y2+=i,t},CloneLine:function(t){return new Xo(t.x1,t.y1,t.x2,t.y2)},CopyLineFrom:function(t,e){return e.set(t.x1,t.y1,t.x2,t.y2)},ExtendLine:function(t,e,n){void 0===n&&(n=e);var r=Du(t),i=t.x2-t.x1,o=t.y2-t.y1;return e&&(t.x1=t.x1-i/r*e,t.y1=t.y1-o/r*e),n&&(t.x2=t.x2+i/r*n,t.y2=t.y2+o/r*n),t},GetLineAngle:Fu,GetLineBresenhamPoints:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=[]);var r=Math.round(t.x1),i=Math.round(t.y1),o=Math.round(t.x2),a=Math.round(t.y2),u=Math.abs(o-r),s=Math.abs(a-i),h=r<o?1:-1,c=i<a?1:-1,f=u-s;n.push(new I(r,i));for(var d=1;r!==o||i!==a;){var l=f<<1;l>-s&&(f-=s,r+=h),l<u&&(f+=u,i+=c),d%e==0&&n.push(new I(r,i)),d++}return n},GetLineHeight:function(t){return Math.abs(t.y1-t.y2)},GetLineLength:Du,GetLineMidPoint:function(t,e){return void 0===e&&(e=new I),e.x=(t.x1+t.x2)/2,e.y=(t.y1+t.y2)/2,e},GetLineNearestPoint:function(t,e,n){void 0===n&&(n=new I);var r=t.x1,i=t.y1,o=t.x2,a=t.y2,u=(o-r)*(o-r)+(a-i)*(a-i);if(0===u)return n;var s=((e.x-r)*(o-r)+(e.y-i)*(a-i))/u;return n.x=r+s*(o-r),n.y=i+s*(a-i),n},GetLineNormal:function(t,e){void 0===e&&(e=new I);var n=Fu(t)-B.HALF_PI;return e.x=Math.cos(n),e.y=Math.sin(n),e},GetLineNormalAngle:Ou,GetLineNormalX:function(t){return Math.cos(Fu(t)-B.HALF_PI)},GetLineNormalY:function(t){return Math.sin(Fu(t)-B.HALF_PI)},GetLinePerpSlope:function(t){var e=t.x1,n=t.y1;return-(t.x2-e)/(t.y2-n)},GetLinePoint:function(t,e,n){return void 0===n&&(n=new I),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n},GetLinePoints:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=[]),e||(e=Du(t)/n);for(var i=t.x1,o=t.y1,a=t.x2,u=t.y2,s=0;s<e;s++){var h=s/e,c=i+(a-i)*h,f=o+(u-o)*h;r.push(new I(c,f))}return r},GetLineReflectAngle:function(t,e){return 2*Ou(e)-Math.PI-Fu(t)},GetLineSlope:function(t){var e=t.x1,n=t.y1,r=t.x2;return(t.y2-n)/(r-e)},GetLineWidth:function(t){return Math.abs(t.x1-t.x2)},GetLineRandomPoint:function(t,e){void 0===e&&(e=new I);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e},GetShortestLineDistance:function(t,e){var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=(i-n)*(i-n)+(o-r)*(o-r);if(0===a)return 0;var u=((r-e.y)*(i-n)-(n-e.x)*(o-r))/a;return Math.abs(u)*Math.sqrt(a)},Line:Xo,LineEquals:function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2},LineSetToAngle:function(t,e,n,r,i){return t.x1=e,t.y1=n,t.x2=e+Math.cos(r)*i,t.y2=n+Math.sin(r)*i,t},RotateLine:function(t,e){return Iu(t,(t.x1+t.x2)/2,(t.y1+t.y2)/2,e)},RotateLineAround:Iu,RotateLineAroundPoint:function(t,e,n){return Iu(t,e.x,e.y,n)},TranslateLine:Lu,TranslateLinePoint:function(t,e){return Lu(t,e.x,e.y)}}),ku=function(){function t(t,e,n,r,i,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),this.set(t,e,n,r,i,o)}return t.prototype.set=function(t,e,n,r,i,o){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),this.x1=t,this.y1=e,this.x2=n,this.y2=r,this.x3=i,this.y3=o,this},t.prototype.contains=function(t,e){return Mu(this,t,e)},Object.defineProperty(t.prototype,"left",{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e=0;e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e=0;e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e=0;e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e=0;e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e},enumerable:!1,configurable:!0}),t}();function Gu(t,e){return void 0===e&&(e=new I),e.set((t.x1+t.x2+t.x3)/3,(t.y1+t.y2+t.y3)/3)}function ju(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t.x3+=e,t.y3+=n,t}function Uu(t,e,n,r){return t*r-e*n}var Vu=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.set(t,e,n)}return t.prototype.set=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this},t.prototype.contains=function(t,e){return function(t,e,n){return t.radius>0&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-n)*(t.y-n)<=t.radius*t.radius}(this,t,e)},Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diameter",{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius},enumerable:!1,configurable:!0}),t}();function Nu(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Wu(t,e){void 0===e&&(e=new I);var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=t.x3,u=t.y3,s=Nu(a,u,i,o),h=Nu(n,r,a,u),c=Nu(i,o,n,r),f=s+h+c;return e.set((n*s+i*h+a*c)/f,(r*s+o*h+u*c)/f)}function qu(t,e,n,r){var i=t.x1,o=t.y1,a=t.x2,u=t.y2,s=t.x3,h=t.y3,c=Math.cos(r),f=Math.sin(r);return t.set((i-e)*c-(o-n)*f+e,(i-e)*f+(o-n)*c+n,(a-e)*c-(u-n)*f+e,(a-e)*f+(u-n)*c+n,(s-e)*c-(h-n)*f+e,(s-e)*f+(h-n)*c+n)}var Hu=Object.freeze({__proto__:null,BuildEquilateralTriangle:function(t,e,n){var r=n*(Math.sqrt(3)/2);return new ku(t,e,t+n/2,e+r,t-n/2,e+r)},BuildRightTriangle:function(t,e,n,r){return void 0===r&&(r=n),new ku(t,e,t,e-r,t+n,e)},CenterTriangleOn:function(t,e,n,r){void 0===r&&(r=Gu);var i=r(t);return ju(t,e-i.x,n-i.y)},CloneTriangle:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=t.x3,a=t.y3;return new ku(e,n,r,i,o,a)},CopyTriangleFrom:function(t,e){var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=t.x3,u=t.y3;return e.set(n,r,i,o,a,u)},DecomposeTriangle:Eu,GetTriangleArea:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=t.x3,a=t.y3;return Math.abs(((o-e)*(i-n)-(r-e)*(a-n))/2)},GetTriangleCentroid:Gu,GetTriangleCircumCenter:function(t,e){void 0===e&&(e=new I);var n=t.x3,r=t.y3,i=t.x1-n,o=t.y1-r,a=t.x2-n,u=t.y2-r,s=2*Uu(i,o,a,u),h=Uu(o,i*i+o*o,u,a*a+u*u),c=Uu(i,i*i+o*o,a,a*a+u*u);return e.set(n-h/s,r+c/s)},GetTriangleCircumCircle:function(t,e){void 0===e&&(e=new Vu);var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=t.x3,u=t.y3,s=i-n,h=o-r,c=a-n,f=u-r,d=s*(n+i)+h*(r+o),l=c*(n+a)+f*(r+u),v=2*(s*(u-o)-h*(a-i));if(Math.abs(v)<1e-6){var p=Math.min(n,i,a),y=Math.min(r,o,u),x=.5*(Math.max(n,i,a)-p),m=.5*(Math.max(r,o,u)-y);return e.set(p+x,y+m,Math.sqrt(x*x+m*m))}var w=(f*d-h*l)/v,g=(s*l-c*d)/v;return x=w-n,m=g-r,e.set(w,g,Math.sqrt(x*x+m*m))},GetTriangleEdges:bu,GetTriangleInCenter:Wu,GetTrianglePerimeter:function(t){var e=f(bu(t),3),n=e[0],r=e[1],i=e[2];return Du(n)+Du(r)+Du(i)},GetTrianglePoint:function(t,e,n){void 0===n&&(n=new I);var r=f(bu(t),3),i=r[0],o=r[1],a=r[2];if(e<=0||e>=1)return n.set(i.x1,i.y1);var u=Du(i),s=Du(o),h=Du(a),c=(u+s+h)*e,d=0;if(c<u){d=c/u;var l=i.x1,v=i.y1,p=i.x2,y=i.y2;return n.set(l+(p-l)*d,v+(y-v)*d)}if(c>u+s){d=(c-=u+s)/h;l=a.x1,v=a.y1,p=a.x2,y=a.y2;return n.set(l+(p-l)*d,v+(y-v)*d)}return d=(c-=u)/s,l=o.x1,v=o.y1,p=o.x2,y=o.y2,n.set(l+(p-l)*d,v+(y-v)*d)},GetTrianglePoints:function(t,e,n,r){void 0===r&&(r=[]);var i=f(bu(t),3),o=i[0],a=i[1],u=i[2],s=Du(o),h=Du(a),c=Du(u),d=s+h+c;e||(e=d/n);for(var l=0;l<e;l++){var v=d*(l/e),p=0,y=void 0;if(v<s){p=v/s;var x=o.x1,m=o.y1,w=o.x2,g=o.y2;y=new I(x+(w-x)*p,m+(g-m)*p)}else if(v>s+h){p=(v-=s+h)/c;x=u.x1,m=u.y1,w=u.x2,g=u.y2;y=new I(x+(w-x)*p,m+(g-m)*p)}else{p=(v-=s)/h;x=a.x1,m=a.y1,w=a.x2,g=a.y2;y=new I(x+(w-x)*p,m+(g-m)*p)}r.push(y)}return r},GetTriangleRandomPoint:function(t,e){void 0===e&&(e=new I);var n=t.x1,r=t.y1,i=t.x2-n,o=t.y2-r,a=t.x3-n,u=t.y3-r,s=Math.random(),h=Math.random();return s+h>=1&&(s=1-s,h=1-h),e.set(n+(i*s+a*h),r+(o*s+u*h))},RotateTriangle:function(t,e){var n=Wu(t);return qu(t,n.x,n.y,e)},RotateTriangleAround:qu,RotateTriangleAroundPoint:function(t,e,n){return qu(t,e.x,e.y,n)},TranslateTriangle:ju,Triangle:ku,TriangleContains:Mu,TriangleContainsPoint:function(t,e){return Mu(t,e.x,e.y)},TriangleContainsPoints:_u,TriangleEquals:function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}}),Ku=Object.freeze({__proto__:null,Circle:uu,Ellipse:du,Intersects:Au,Line:Bu,Rectangle:$o,Triangle:Hu});var Xu=Object.freeze({__proto__:null,BoxGeometry:Ua,ConeGeometry:Ya,CylinderGeometry:Xa,PlaneGeometry:ja,SphereGeometry:tu,TorusGeometry:function(t,e,n,r,i){void 0===t&&(t=1),void 0===e&&(e=.4),void 0===n&&(n=8),void 0===r&&(r=6),void 0===i&&(i=2*Math.PI);for(var o={vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0},a=o.vertices,u=o.normals,s=o.uvs,h=o.indices,c=new g,f=new g,d=new g,l=0;l<=n;l++)for(var v=0;v<=r;v++){var p=v/r*i,y=l/n*Math.PI*2;f.x=(t+e*Math.cos(y))*Math.cos(p),f.y=(t+e*Math.cos(y))*Math.sin(p),f.z=e*Math.sin(y),a.push(f.x,f.y,f.z),c.x=t*Math.cos(p),c.y=t*Math.sin(p),_t(f,c,d),xt(d,d),u.push(d.x,d.y,d.z),s.push(v/r),s.push(l/n)}for(l=1;l<=n;l++)for(v=1;v<=r;v++){var x=(r+1)*l+v-1,m=(r+1)*(l-1)+v-1,w=(r+1)*(l-1)+v,b=(r+1)*l+v;h.push(x,m,b),h.push(m,w,b)}return o.numberOfVertices=a.length,o}}),Yu=function(){function t(t){this.capture=!0,this.isDown=!1,this.enabled=!0,this.repeatRate=0,this.canRepeat=!0,this.timeDown=0,this.timeUpdated=0,this.timeUp=0,this.value=t,this.events=new Map}return t.prototype.getValue=function(){return this.value},t.prototype.down=function(t){this.enabled&&(this.capture&&t.preventDefault(),this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.isDown&&this.canRepeat?(this.timeUpdated=t.timeStamp,this.timeUpdated-this.timeDown>=this.repeatRate&&($i(this,"keydown",this),this.downCallback&&this.downCallback(this))):(this.isDown=!0,this.timeDown=t.timeStamp,this.timeUpdated=t.timeStamp,$i(this,"keydown",this),this.downCallback&&this.downCallback(this)))},t.prototype.up=function(t){this.enabled&&(this.capture&&t.preventDefault(),this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.isDown&&(this.isDown=!1,this.timeUp=t.timeStamp,this.timeUpdated=t.timeStamp,$i(this,"keyup",this),this.upCallback&&this.upCallback(this)))},t.prototype.reset=function(){this.isDown=!1,this.timeUpdated=this.timeDown,this.timeUp=this.timeDown},t.prototype.destroy=function(){this.downCallback=null,this.upCallback=null,this.events.clear()},t}(),Zu=function(t){function e(){return t.call(this,"a")||this}return h(e,t),e}(Yu),Ju=function(t,e){var n=e.left,r=void 0===n||n,i=e.right,o=void 0===i||i,a=e.up,u=void 0===a||a,s=e.down,h=void 0===s||s,c=e.space,f=void 0===c||c,d=t.keys;r&&(this.left=new Yu("ArrowLeft"),d.set(this.left.value,this.left)),o&&(this.right=new Yu("ArrowRight"),d.set(this.right.value,this.right)),u&&(this.up=new Yu("ArrowUp"),d.set(this.up.value,this.up)),h&&(this.down=new Yu("ArrowDown"),d.set(this.down.value,this.down)),f&&(this.space=new Yu(" "),d.set(this.space.value,this.space))},Qu=function(t){function e(){return t.call(this,"b")||this}return h(e,t),e}(Yu),$u=function(t){function e(){return t.call(this,"c")||this}return h(e,t),e}(Yu),ts=function(t){function e(){return t.call(this,"d")||this}return h(e,t),e}(Yu),es=function(t){function e(){return t.call(this,"ArrowDown")||this}return h(e,t),e}(Yu),ns=function(t){function e(){return t.call(this,"e")||this}return h(e,t),e}(Yu),rs=function(t){function e(){return t.call(this,"f")||this}return h(e,t),e}(Yu),is=function(t){function e(){return t.call(this,"g")||this}return h(e,t),e}(Yu),os=function(t){function e(){return t.call(this,"h")||this}return h(e,t),e}(Yu),as=function(t){function e(){return t.call(this,"i")||this}return h(e,t),e}(Yu),us=function(t){function e(){return t.call(this,"j")||this}return h(e,t),e}(Yu),ss=function(t){function e(){return t.call(this,"k")||this}return h(e,t),e}(Yu),hs=function(t){function e(){return t.call(this,"l")||this}return h(e,t),e}(Yu),cs=function(t){function e(){return t.call(this,"ArrowLeft")||this}return h(e,t),e}(Yu),fs=function(t){function e(){return t.call(this,"m")||this}return h(e,t),e}(Yu),ds=function(t){function e(){return t.call(this,"n")||this}return h(e,t),e}(Yu),ls=function(t){function e(){return t.call(this,"o")||this}return h(e,t),e}(Yu),vs=function(t){function e(){return t.call(this,"p")||this}return h(e,t),e}(Yu),ps=function(t){function e(){return t.call(this,"q")||this}return h(e,t),e}(Yu),ys=function(t){function e(){return t.call(this,"r")||this}return h(e,t),e}(Yu),xs=function(t){function e(){return t.call(this,"ArrowRight")||this}return h(e,t),e}(Yu),ms=function(t){function e(){return t.call(this,"s")||this}return h(e,t),e}(Yu),ws=function(t){function e(){return t.call(this," ")||this}return h(e,t),e}(Yu),gs=function(t){function e(){return t.call(this,"t")||this}return h(e,t),e}(Yu),bs=function(t){function e(){return t.call(this,"u")||this}return h(e,t),e}(Yu),Ms=function(t){function e(){return t.call(this,"ArrowUp")||this}return h(e,t),e}(Yu),_s=function(t){function e(){return t.call(this,"v")||this}return h(e,t),e}(Yu),Cs=function(t,e){var n=e.W,r=void 0===n||n,i=e.A,o=void 0===i||i,a=e.S,u=void 0===a||a,s=e.D,h=void 0===s||s,c=e.space,f=void 0===c||c,d=t.keys;r&&(this.W=new Yu("w"),d.set(this.W.value,this.W)),o&&(this.A=new Yu("a"),d.set(this.A.value,this.A)),u&&(this.S=new Yu("s"),d.set(this.S.value,this.S)),h&&(this.D=new Yu("d"),d.set(this.D.value,this.D)),f&&(this.space=new Yu(" "),d.set(this.space.value,this.space))},Ts=function(t){function e(){return t.call(this,"w")||this}return h(e,t),e}(Yu),zs=function(t){function e(){return t.call(this,"x")||this}return h(e,t),e}(Yu),Ss=function(t){function e(){return t.call(this,"y")||this}return h(e,t),e}(Yu),Es=function(t){function e(){return t.call(this,"z")||this}return h(e,t),e}(Yu),Rs=Object.freeze({__proto__:null,AKey:Zu,BKey:Qu,CKey:$u,DKey:ts,EKey:ns,FKey:rs,GKey:is,HKey:os,IKey:as,JKey:us,KKey:ss,LKey:hs,MKey:fs,NKey:ds,OKey:ls,PKey:vs,QKey:ps,RKey:ys,SKey:ms,TKey:gs,UKey:bs,VKey:_s,WKey:Ts,XKey:zs,YKey:Ss,ZKey:Es,ArrowKeys:Ju,DownKey:es,LeftKey:cs,RightKey:xs,SpaceKey:ws,UpKey:Ms,WASDKeys:Cs});var Ps=function(t){function e(){var e=t.call(this)||this;return e.keyConversion={Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Win:"Meta",Scroll:"ScrollLock",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Add:"+",Subtract:"-",Multiply:"*",Decimal:".",Divide:"/"},e.keydownHandler=function(t){return e.onKeyDown(t)},e.keyupHandler=function(t){return e.onKeyUp(t)},e.blurHandler=function(){return e.onBlur()},window.addEventListener("keydown",e.keydownHandler),window.addEventListener("keyup",e.keyupHandler),window.addEventListener("blur",e.blurHandler),e.keys=new Map,e}return h(e,t),e.prototype.addKeys=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach((function(e){t.keys.set(e.getValue(),e)}))},e.prototype.clearKeys=function(){this.keys.clear()},e.prototype.onBlur=function(){this.keys.forEach((function(t){t.reset()}))},e.prototype.getKeyValue=function(t){return this.keyConversion.hasOwnProperty(t)?this.keyConversion[t]:t},e.prototype.onKeyDown=function(t){var e=this.getKeyValue(t.key);this.keys.has(e)&&this.keys.get(e).down(t);$i(this,"keydown-"+e,t),$i(this,"keydown",t)},e.prototype.onKeyUp=function(t){var e=this.getKeyValue(t.key);this.keys.has(e)&&this.keys.get(e).up(t);$i(this,"keyup-"+e,t),$i(this,"keyup",t)},e.prototype.destroy=function(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler),window.removeEventListener("blur",this.blurHandler),$i(this,"destroy")},e}(Do);var As=Object.freeze({__proto__:null,GetKeyDownDuration:function(t){return t.isDown?t.timeUpdated-t.timeDown:t.timeUp-t.timeDown},Key:Yu,Keys:Rs,Keyboard:Ps,SetKeyRepeatRate:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.repeatRate=t})),e}}),Ds=function(t){function e(e){var n=t.call(this)||this;return n.primaryDown=!1,n.auxDown=!1,n.secondaryDown=!1,n.blockContextMenu=!0,n.resolution=1,n.mousedownHandler=function(t){return n.onMouseDown(t)},n.mouseupHandler=function(t){return n.onMouseUp(t)},n.mousemoveHandler=function(t){return n.onMouseMove(t)},n.mousewheelHandler=function(t){return n.onMouseWheel(t)},n.contextmenuHandler=function(t){return n.onContextMenuEvent(t)},n.blurHandler=function(){return n.onBlur()},n.localPoint=new I,n.hitPoint=new I,n.transPoint=new I,e||(e=r().renderer.canvas),e.addEventListener("mousedown",n.mousedownHandler),e.addEventListener("mouseup",n.mouseupHandler),e.addEventListener("wheel",n.mousewheelHandler,{passive:!1}),e.addEventListener("contextmenu",n.contextmenuHandler),window.addEventListener("mouseup",n.mouseupHandler),window.addEventListener("mousemove",n.mousemoveHandler),window.addEventListener("blur",n.blurHandler),n.target=e,n}return h(e,t),e.prototype.onBlur=function(){},e.prototype.onMouseDown=function(t){this.positionToPoint(t),this.primaryDown=0===t.button,this.auxDown=1===t.button,this.secondaryDown=2===t.button,$i(this,"pointerdown",this.localPoint.x,this.localPoint.y,t.button,t)},e.prototype.onMouseUp=function(t){this.positionToPoint(t),this.primaryDown=!(0===t.button),this.auxDown=!(1===t.button),this.secondaryDown=!(2===t.button),$i(this,"pointerup",this.localPoint.x,this.localPoint.y,t.button,t)},e.prototype.onMouseMove=function(t){this.positionToPoint(t),$i(this,"pointermove",this.localPoint.x,this.localPoint.y,t)},e.prototype.onMouseWheel=function(t){$i(this,"wheel",t.deltaX,t.deltaY,t.deltaZ,t)},e.prototype.onContextMenuEvent=function(t){this.blockContextMenu&&t.preventDefault(),$i(this,"contextmenu",t)},e.prototype.positionToPoint=function(t){return this.localPoint.set(t.offsetX,t.offsetY)},e.prototype.getInteractiveChildren=function(t,e){for(var n=t.children,r=0;r<n.length;r++){var i=n[r];i.visible&&i.input.enabled&&(e.push(i),i.input.enabledChildren&&i.numChildren&&this.getInteractiveChildren(i,e))}},e.prototype.checkHitArea=function(t,e,n){return t.input.hitArea?!!t.input.hitArea.contains(e,n):t.transform.extent.contains(e,n)},e.prototype.hitTest=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this.localPoint.x,r=this.localPoint.y,i=this.transPoint,o=0;o<t.length;o++){var a=t[o];if(a.world){var u=Ne(a.world.camera.worldTransform,a.transform.world);if(Ye(u,n,r,i),this.checkHitArea(a,i.x,i.y))return this.hitPoint.set(i.x,i.y),!0}}return!1},e.prototype.hitTestChildren=function(t,e){void 0===e&&(e=!0);var n=[];if(!t.visible)return n;var r=[],i=t.input;i&&i.enabled&&r.push(t),i.enabledChildren&&t.numChildren&&this.getInteractiveChildren(t,r);for(var o=r.length-1;o>=0;o--){var a=r[o];if(this.hitTest(a)&&(n.push(a),e))break}return n},e.prototype.shutdown=function(){var t=this.target;t.removeEventListener("mousedown",this.mousedownHandler),t.removeEventListener("mouseup",this.mouseupHandler),t.removeEventListener("wheel",this.mousewheelHandler),t.removeEventListener("contextmenu",this.contextmenuHandler),window.removeEventListener("mouseup",this.mouseupHandler),window.removeEventListener("mousemove",this.mousemoveHandler),window.removeEventListener("blur",this.blurHandler)},e}(Do),Fs=Object.freeze({__proto__:null,Mouse:Ds});var Os=Object.freeze({__proto__:null,Keyboard:As,Mouse:Fs,SetInteractive:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.forEach((function(t){t.input.enabled=!0})),t}});function Is(t,e){var n;if(Array.isArray(e.textures)?n=e.textures[0].frames:Array.isArray(e.frames)?n=e.frames:e.hasOwnProperty("frames")?n=Object.values(e.frames):console.warn("Invalid Texture Atlas JSON"),n)for(var r=void 0,i=0;i<n.length;i++){var o=n[i];r=t.addFrame(o.filename,o.frame.x,o.frame.y,o.frame.w,o.frame.h),o.trimmed?r.setTrim(o.sourceSize.w,o.sourceSize.h,o.spriteSourceSize.x,o.spriteSourceSize.y,o.spriteSourceSize.w,o.spriteSourceSize.h):r.setSourceSize(o.sourceSize.w,o.sourceSize.h),o.rotated,o.anchor&&r.setPivot(o.anchor.x,o.anchor.y)}}var Ls=function(t,e,n){this.responseType="text",this.crossOrigin=void 0,this.skipCache=!1,this.hasLoaded=!1,this.key=t,this.url=e,this.config=n};function Bs(t,e,n,r){return e||(e=t+n),/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/.exec(e)?e:r?r.baseURL+r.path+e:e}function ks(t){return t.data=new Image,t.crossOrigin&&(t.data.crossOrigin=t.crossOrigin),new Promise((function(e,n){t.data.onload=function(){t.data.onload&&(t.data.onload=null,t.data.onerror=null,e(t))},t.data.onerror=function(e){t.data.onload&&(t.data.onload=null,t.data.onerror=null,t.error=e,n(t))},t.data.src=t.url,t.data.complete&&t.data.width&&t.data.height&&(t.data.onload=null,t.data.onerror=null,e(t))}))}function Gs(t,e,n){var r=new Ls(t,e);return r.load=function(){return r.url=Bs(r.key,r.url,".png",r.loader),r.loader&&(r.crossOrigin=r.loader.crossOrigin),new Promise((function(t,e){var i=da();i.has(r.key)?t(r):ks(r).then((function(e){i.add(e.key,e.data,n),t(e)})).catch((function(t){e(t)}))}))},r}var js=new Map,Us=function(t){return js.has(t)||js.set(t,new Map),js.get(t)};function Vs(t){var e=new XMLHttpRequest;return e.open("GET",t.url,!0),e.responseType=t.responseType,new Promise((function(n,r){e.onload=function(){t.data=e.responseText,t.hasLoaded=!0,n(t)},e.onerror=function(){t.hasLoaded=!0,r(t)},e.send()}))}function Ns(t,e){var n=new Ls(t,e);return n.load=function(){return n.url=Bs(n.key,n.url,".json",n.loader),new Promise((function(t,e){var r=Us("JSON");!n.skipCache&&r.has(n.key)?t(n):Vs(n).then((function(e){e.data=JSON.parse(e.data),e.skipCache||r.set(e.key,e.data),t(e)})).catch((function(t){e(t)}))}))},n}function Ws(t,e){return parseInt(t.getAttribute(e),10)}function qs(t,e,n){for(var r=e.getElementsByTagName("info")[0],i=e.getElementsByTagName("common")[0],o={font:r.getAttribute("face"),size:Ws(r,"size"),lineHeight:Ws(i,"lineHeight")+0,chars:{}},a=e.getElementsByTagName("char"),u=0;u<a.length;u++){var s=a[u],h=Ws(s,"id"),c=Ws(s,"x"),f=Ws(s,"y"),d=Ws(s,"width"),l=Ws(s,"height");o.chars[h]={x:c,y:f,width:d,height:l,xOffset:Ws(s,"xoffset"),yOffset:Ws(s,"yoffset"),xAdvance:Ws(s,"xadvance")+0,kerning:{}},t.addFrame(h,c,f,d,l)}var v=e.getElementsByTagName("kerning");for(u=0;u<v.length;u++){var p=v[u],y=Ws(p,"first"),x=Ws(p,"second"),m=Ws(p,"amount");o.chars[x].kerning[y]=m}return o}function Hs(t,e){var n=new Ls(t,e);return n.load=function(){return n.url=Bs(n.key,n.url,".xml",n.loader),new Promise((function(t,e){var r=Us("XML");!n.skipCache&&r.has(n.key)?t(n):Vs(n).then((function(n){var i=Qr(n.data);null!==i?(n.data=i,n.skipCache||r.set(n.key,i),t(n)):e(n)})).catch((function(t){e(t)}))}))},n}function Ks(t,e,n,r,i,o){var a=o.frameWidth,u=void 0===a?null:a,s=o.endFrame,h=void 0===s?-1:s,c=o.margin,f=void 0===c?0:c,d=o.spacing,l=void 0===d?0:d,v=o.frameHeight,p=void 0===v?null:v,y=o.startFrame,x=void 0===y?0:y;if(p||(p=u),null===u)throw new Error("SpriteSheetParser: Invalid frameWidth");var m=Math.floor((r-f+l)/(u+l))*Math.floor((i-f+l)/(p+l));0===m&&console.warn("SpriteSheetParser: Frame config will result in zero frames"),(x>m||x<-m)&&(x=0),x<0&&(x=m+x),-1!==h&&(m=x+(h+1));for(var w=f,g=f,b=0,M=0,_=0;_<m;_++){b=0,M=0;var C=w+u,T=g+p;C>r&&(b=C-r),T>i&&(M=T-i),t.addFrame(_,e+w,n+g,u-b,p-M),(w+=u+l)+u>r&&(w=f,g+=p+l)}}var Xs=Object.freeze({__proto__:null,AtlasFile:function(t,e,n,r){var i=Ns(t,n),o=Gs(t,e,r),a=new Ls(t,"");return a.load=function(){return i.url=Bs(i.key,i.url,".json",a.loader),o.url=Bs(o.key,o.url,".png",a.loader),new Promise((function(e,n){i.skipCache=!0,i.load().then((function(){o.load().then((function(){Is(da().get(t),i.data),e(a)})).catch((function(){n(a)}))})).catch((function(){n(a)}))}))},a},BitmapTextFile:function(t,e,n,r){var i=Hs(t,n),o=Gs(t,e,r),a=new Ls(t,"");return a.load=function(){return i.url=Bs(i.key,i.url,".xml",a.loader),o.url=Bs(o.key,o.url,".png",a.loader),new Promise((function(e,n){i.skipCache=!0,i.load().then((function(){o.load().then((function(){var n=da().get(t),r=qs(n,i.data);n.data=r,e(a)})).catch((function(){n(a)}))})).catch((function(){n(a)}))}))},a},CSVFile:function(t,e){var n=new Ls(t,e);return n.load=function(){return n.url=Bs(n.key,n.url,".csv",n.loader),new Promise((function(t,e){var r=Us("CSV");!n.skipCache&&r.has(n.key)?t(n):Vs(n).then((function(e){e.skipCache||r.set(e.key,e.data),t(e)})).catch((function(t){e(t)}))}))},n},ImageFile:Gs,JSONFile:Ns,JSONGeometryFile:function(t,e,n){var r=new Ls(t,e),i=n.vertices,o=void 0===i?"verts":i,a=n.normals,u=void 0===a?"normals":a,s=n.uvs,h=void 0===s?"uvs":s,c=n.numberOfVertices,f=void 0===c?0:c;return r.load=function(){return r.url=Bs(r.key,r.url,".json",r.loader),new Promise((function(t,e){var n=Us("Geometry");!r.skipCache&&n.has(r.key)?t(r):Vs(r).then((function(e){var r=JSON.parse(e.data),i=new Oa({vertices:r[o],normals:r[u],uvs:r[h],numberOfVertices:f});e.data=i,e.skipCache||n.set(e.key,i),t(e)})).catch((function(t){e(t)}))}))},r},OBJFile:function(t,e){var n=new Ls(t,e);return n.load=function(){return n.url=Bs(n.key,n.url,".obj",n.loader),new Promise((function(t,e){var r=Us("Obj");!n.skipCache&&r.has(n.key)?t(n):Vs(n).then((function(e){e.skipCache||r.set(e.key,e.data),t(e)})).catch((function(t){e(t)}))}))},n},OBJGeometryFile:function(t,e,n){void 0===n&&(n=!0);var r=new Ls(t,e);return r.load=function(){return r.url=Bs(r.key,r.url,".obj",r.loader),new Promise((function(t,e){var i=Us("Geometry");!r.skipCache&&i.has(r.key)?t(r):Vs(r).then((function(e){var r=La(e.data,n);if(e.data=r,!e.skipCache){var o=e.key;r.forEach((function(t,n){n>0&&(o=e.key+n.toString());var r=new Oa(t.buffer);i.set(o,r)}))}t(e)})).catch((function(t){e(t)}))}))},r},SpriteSheetFile:function(t,e,n,r){var i=new Ls(t,e);return i.load=function(){return i.url=Bs(i.key,i.url,".png",i.loader),i.loader&&(i.crossOrigin=i.loader.crossOrigin),new Promise((function(t,e){var o=da();o.has(i.key)?t(i):ks(i).then((function(i){var a=o.add(i.key,i.data,r);a?(Ks(a,0,0,a.width,a.height,n),t(i)):e(i)})).catch((function(t){e(t)}))}))},i},XMLFile:Hs}),Ys=function(t){function e(){var e=t.call(this)||this;return e.baseURL="",e.path="",e.crossOrigin="anonymous",e.maxParallelDownloads=-1,e.isLoading=!1,e.reset(),e}return h(e,t),e.prototype.reset=function(){this.isLoading=!1,this.queue=new Set,this.inflight=new Set,this.completed=new Set,this.progress=0},e.prototype.add=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach((function(e){e.loader=t,t.queue.add(e)})),this},e.prototype.start=function(){var t=this;return this.isLoading?null:new Promise((function(e,n){t.completed.clear(),t.progress=0,t.queue.size>0?(t.isLoading=!0,t.onComplete=e,t.onError=n,$i(t,"start"),t.nextFile()):(t.progress=1,$i(t,"complete"),e())}))},e.prototype.nextFile=function(){var t=this,e=this.queue.size;if(-1!==this.maxParallelDownloads&&(e=Math.min(e,this.maxParallelDownloads)-this.inflight.size),e)for(var n=this.queue.values();e>0;){var r=n.next().value;this.inflight.add(r),this.queue.delete(r),r.load().then((function(e){return t.fileComplete(e)})).catch((function(e){return t.fileError(e)})),e--}else 0===this.inflight.size&&this.stop()},e.prototype.stop=function(){this.isLoading&&(this.isLoading=!1,$i(this,"complete",this.completed),this.onComplete(),this.completed.clear())},e.prototype.updateProgress=function(t){this.inflight.delete(t),this.completed.add(t);var e=this.completed.size,n=this.queue.size+this.inflight.size;e>0&&(this.progress=e/(e+n)),$i(this,"progress",this.progress,e,n),this.nextFile()},e.prototype.fileComplete=function(t){$i(this,"filecomplete",t),this.updateProgress(t)},e.prototype.fileError=function(t){$i(this,"fileerror",t),this.updateProgress(t)},e.prototype.totalFilesToLoad=function(){return this.queue.size+this.inflight.size},e.prototype.setBaseURL=function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},e.prototype.setPath=function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},e.prototype.setCORS=function(t){return this.crossOrigin=t,this},e.prototype.setMaxParallelDownloads=function(t){return this.maxParallelDownloads=t,this},e}(Do),Zs=Object.freeze({__proto__:null,File:Ls,Files:Xs,Loader:Ys}),Js=new Na({ambient:[0,0,0],diffuse:[.01,.01,.01],specular:[.5,.5,.5],shine:.25}),Qs=new Na({ambient:[.02,.02,.02],diffuse:[.01,.01,.01],specular:[.4,.4,.4],shine:.078125}),$s=new Na({ambient:[.329412,.223529,.027451],diffuse:[.780392,.568627,.113725],specular:[.992157,.941176,.807843],shine:.21794872}),th=new Na({ambient:[.2125,.1275,.054],diffuse:[.714,.4284,.18144],specular:[.393548,.271906,.166721],shine:.2}),eh=new Na({ambient:[.25,.25,.25],diffuse:[.4,.4,.4],specular:[.774597,.774597,.774597],shine:.6}),nh=new Na({ambient:[.19125,.0735,.0225],diffuse:[.7038,.27048,.0828],specular:[.256777,.137622,.086014],shine:.1}),rh=new Na({ambient:[0,.1,.06],diffuse:[0,.50980392,.50980392],specular:[.50196078,.50196078,.50196078],shine:.25}),ih=new Na({ambient:[0,.05,.05],diffuse:[.4,.5,.5],specular:[.04,.7,.7],shine:.078125}),oh=new Na({ambient:[.0215,.1745,.0215],diffuse:[.07568,.61424,.07568],specular:[.633,.727811,.633],shine:.6}),ah=new Na({ambient:[.24725,.1995,.0745],diffuse:[.75164,.60648,.22648],specular:[.628281,.555802,.366065],shine:.4}),uh=new Na({ambient:[0,0,0],diffuse:[.1,.35,.1],specular:[.45,.55,.45],shine:.25}),sh=new Na({ambient:[0,.05,0],diffuse:[.4,.5,.4],specular:[.04,.7,.04],shine:.078125}),hh=new Na({ambient:[.135,.2225,.1575],diffuse:[.54,.89,.63],specular:[.316228,.316228,.316228],shine:.1}),ch=new Na({ambient:[.05375,.05,.06625],diffuse:[.18275,.17,.22525],specular:[.332741,.328634,.346435],shine:.3}),fh=new Na({ambient:[.25,.20725,.20725],diffuse:[1,.829,.829],specular:[.296648,.296648,.296648],shine:.088}),dh=new Na({ambient:[0,0,0],diffuse:[.5,0,0],specular:[.7,.6,.6],shine:.25}),lh=new Na({ambient:[.05,0,0],diffuse:[.5,.4,.4],specular:[.7,.04,.04],shine:.078125}),vh=new Na({ambient:[.1745,.01175,.01175],diffuse:[.61424,.04136,.04136],specular:[.727811,.626959,.626959],shine:.6}),ph=new Na({ambient:[.19225,.19225,.19225],diffuse:[.50754,.50754,.50754],specular:[.508273,.508273,.508273],shine:.4}),yh=new Na({ambient:[.1,.18725,.1745],diffuse:[.396,.74151,.69102],specular:[.297254,.30829,.306678],shine:.1}),xh=new Na({ambient:[0,0,0],diffuse:[.55,.55,.55],specular:[.7,.7,.7],shine:.25}),mh=new Na({ambient:[.05,.05,.05],diffuse:[.5,.5,.5],specular:[.7,.7,.7],shine:.078125}),wh=new Na({ambient:[0,0,0],diffuse:[.5,.5,0],specular:[.6,.6,.5],shine:.25}),gh=new Na({ambient:[.05,.05,0],diffuse:[.5,.5,.4],specular:[.7,.7,.04],shine:.078125}),bh=Object.freeze({__proto__:null,BlackPlastic:Js,BlackRubber:Qs,Brass:$s,Bronze:th,Chrome:eh,Copper:nh,CyanPlastic:rh,CyanRubber:ih,Emerald:oh,Gold:ah,GreenPlastic:uh,GreenRubber:sh,Jade:hh,Obsidian:ch,Pearl:fh,RedPlastic:dh,RedRubber:lh,Ruby:vh,Silver:ph,Turquoise:yh,WhitePlastic:xh,WhiteRubber:mh,YellowPlastic:wh,YellowRubber:gh}),Mh=["#000","#9D9D9D","#FFF","#BE2633","#E06F8B","#493C2B","#A46422","#EB8931","#F7E26B","#2F484E","#44891A","#A3CE27","#1B2632","#005784","#31A2F2","#B2DCEF"],_h=Object.freeze({__proto__:null,Arne16:Mh,C64:["#000","#fff","#8b4131","#7bbdc5","#8b41ac","#6aac41","#3931a4","#d5de73","#945a20","#5a4100","#bd736a","#525252","#838383","#acee8b","#7b73de","#acacac"],CGA:["#000","#2234d1","#0c7e45","#44aacc","#8a3622","#5c2e78","#aa5c3d","#b5b5b5","#5e606e","#4c81fb","#6cd947","#7be2f9","#eb8a60","#e23d69","#ffd93f","#fff"],JMP:["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#f5f4eb"],MSX:["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#fff"],PICO8:["#000","#1D2B53","#7E2553","#008751","#AB5236","#5F574F","#C2C3C7","#FFF1E8","#FF004D","#FFA300","#FFEC27","#00E436","#29ADFF","#83769C","#FF77A8","#FFCCAA"]}),Ch=Object.freeze({__proto__:null,AtlasParser:Is,BitmapTextParser:qs,SpriteSheetParser:Ks});var Th=function(t){function e(e,n,r){void 0===n&&(n=256),void 0===r&&(r=n);var i=t.call(this,null,n,r)||this;return i.renderer=e,i}return h(e,t),e.prototype.cls=function(){return this},e.prototype.batchStart=function(){return this},e.prototype.batchDraw=function(t){for(var e=0,n=t.length;e<n;e++);return this},e.prototype.batchEnd=function(){return this.renderer.reset(),this},e.prototype.draw=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.batchStart(),this.batchDraw(t),this.batchEnd(),this},e}(Fr);var zh=Object.freeze({__proto__:null,CanvasTexture:_a,GridTexture:function(t,e,n,r,i,o){void 0===n&&(n=32),void 0===r&&(r=32),void 0===i&&(i=2),void 0===o&&(o=2);var a=Ma(n,r),u=n/i,s=r/o;a.fillStyle=t,a.fillRect(0,0,n,r),a.fillStyle=e;for(var h=0;h<o;h++)for(var c=h%2;c<i;c+=2)a.fillRect(c*u,h*s,u,s);return new Fr(a.canvas)},PixelTexture:function(t){var e=t.data,n=void 0===e?[]:e,r=t.palette,i=void 0===r?Mh:r,o=t.pixelWidth,a=void 0===o?1:o,u=t.pixelHeight,s=void 0===u?a:u,h=t.preRender,c=void 0===h?null:h,f=t.postRender,d=void 0===f?null:f,l=t.canvas,v=void 0===l?null:l,p=t.resizeCanvas,y=void 0===p||p,x=t.clearCanvas,m=void 0===x||x,w=Math.floor(Math.abs(n[0].length*a)),g=Math.floor(Math.abs(n.length*s));v||(v=Ma(w,g).canvas,y=!1,m=!1),y&&(v.width=w,v.height=g);var b=v.getContext("2d");m&&b.clearRect(0,0,w,g),c&&c(v,b);for(var M=0;M<n.length;M++)for(var _=n[M],C=0;C<_.length;C++){var T=_[C];"."!==T&&" "!==T&&(b.fillStyle=i[parseInt("0x"+T.toUpperCase())],b.fillRect(C*a,M*s,a,s))}return d&&d(v,b),new Fr(v)},RenderTexture:Th,SolidColorTexture:function(t,e,n){void 0===t&&(t="rgba(0,0,0,0)"),void 0===e&&(e=32),void 0===n&&(n=32);var r=Ma(e,n);return r.fillStyle=t,r.fillRect(0,0,e,n),new Fr(r.canvas)}});var Sh=function(){function t(){this.textures=new Map,this.createDefaultTextures(),la(this)}return t.prototype.createDefaultTextures=function(){this.add("__BLANK",new Fr(Ma(32,32).canvas));var t=Ma(32,32);t.strokeStyle="#0f0",t.moveTo(0,0),t.lineTo(32,32),t.stroke(),t.strokeRect(.5,.5,31,31),this.add("__MISSING",new Fr(t.canvas));var e=Ma(32,32);e.fillStyle="#fff",e.fillRect(0,0,32,32),this.add("__WHITE",new Fr(e.canvas))},t.prototype.get=function(t){var e=this.textures;return e.has(t)?e.get(t):e.get("__MISSING")},t.prototype.has=function(t){return this.textures.has(t)},t.prototype.add=function(t,e,n){var r,i=this.textures;return i.has(t)||((r=e instanceof Fr?e:new Fr(e,0,0,n)).key=t,i.set(t,r)),r},t}(),Eh=Object.freeze({__proto__:null,CreateCanvas:Ma,Frame:Dr,GetFrames:function(t,e){var n=[];return e.forEach((function(e){n.push(t.getFrame(e))})),n},GetFramesInRange:function(t,e){var n=e.prefix,r=void 0===n?"":n,i=e.start,o=void 0===i?0:i,a=e.zeroPad,u=void 0===a?0:a,s=e.suffix,h=void 0===s?"":s,c=e.end,f=[],d=o<c?1:-1;c+=d;for(var l=o;l!==c;l+=d){var v=r+l.toString().padStart(u,"0")+h;f.push(t.getFrame(v))}return f},SetFilter:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach((function(e){e.binding&&e.binding.setFilter(t)})),e},Palettes:_h,Parsers:Ch,Types:zh,Texture:Fr,TextureManager:Sh});function Rh(){}function Ph(t,e){var n=e.duration,r=void 0===n?0:n,i=e.repeat,o=void 0===i?0:i,a=e.delay,u=void 0===a?-1:a,s=e.onStart,h=void 0===s?Rh:s,c=e.onUpdate,f=void 0===c?Rh:c,d=e.onRepeat,l=void 0===d?Rh:d,v=e.onComplete,p={elapsed:r,duration:r,repeat:o,delay:u,update:null,onStart:h,onUpdate:f,onRepeat:l,onComplete:void 0===v?Rh:v};p.update=function(t){if(p.delay>0){if(p.delay-=t,!(p.delay<0))return!1;p.delay=0}return 0===p.delay&&(p.onStart(),p.delay=-1),-1===p.delay&&(p.elapsed-=t,p.onUpdate(t,p.elapsed/p.duration),p.elapsed<=0&&(p.repeat>0?(p.repeat--,p.elapsed=p.duration,p.onRepeat(p.repeat)):(p.elapsed=0,p.onComplete()))),0===p.elapsed},t.events.add(p)}var Ah=function(){function t(t){this.world=t,this.timeScale=1,this.events=new Set}return t.prototype.update=function(t,e){var n=this;this.now=e,t*=this.timeScale,this.events.forEach((function(e){e.update(t)&&n.events.delete(e)}))},t}(),Dh=Object.freeze({__proto__:null,AddDelayedCall:function(t,e,n){Ph(t,{duration:0,delay:e,onComplete:n})},AddTimer:Ph,Clock:Ah,NOOP:Rh}),Fh=Object.freeze({__proto__:null,WorldRenderEvent:"worldrender",WorldShutdownEvent:"worldshutdown"});function Oh(t,e){e.numRendered++,e.numRenderable++,t.node.dirtyFrame>=e.gameFrame&&e.dirtyFrame++,t.children.forEach((function(t){t.children.length>0&&Oh(t,e)}))}function Ih(t){if(t.node.isDirty(io))return!0;for(var e=[t];e.length>0;){var n=e.pop();if(n.node.isDirty(ro))return!0;var r=n.children.length;if(r>0)for(var i=0;i<r;i++)e.push(n.children[i])}return e.length=0,!1}function Lh(t,e){t.forEach((function(t){e||Ih(t)?t.node.setDirty(io):t.children.length=0}))}function Bh(t,e,n){void 0===n&&(n=[]);for(var r=0;r<e.numChildren;r++){var i=e.children[r];if(i.isRenderable()){var o=[],a={node:i,children:o};n.push(a),i.willRenderChildren&&i.numChildren>0&&(i.willCacheChildren&&t.push(a),Bh(t,i,o))}}return n}function kh(t){var e=[],n=Bh(e,t,[]),r=t.renderData;e.length>0&&Lh(e,t.camera.dirtyRender),n.forEach((function(t){t.children.length>0?Oh(t,r):(r.numRendered++,r.numRenderable++,t.node.dirtyFrame>=r.gameFrame&&r.dirtyFrame++)})),t.renderList=n,t.forceRefresh&&(r.dirtyFrame++,t.forceRefresh=!1)}function Gh(t,e){t.numDirtyFrames+=e.dirtyFrame,t.numTotalFrames+=e.numRendered,e.camera.dirtyRender&&t.numDirtyCameras++,t.worldData.push(e)}function jh(t,e){t.gameFrame=e,t.dirtyFrame=0,t.numRendered=0,t.numRenderable=0}var Uh=function(t){function e(e){var n=t.call(this)||this;return n.forceRefresh=!1,n.is3D=!1,n.type="BaseWorld",n.scene=e,n.world=n,n.events=new Map,n.renderList=[],n._updateListener=Io(e,"update",(function(t,e){return n.update(t,e)})),n._renderListener=Io(e,"render",(function(t){return n.render(t)})),n._shutdownListener=Io(e,"shutdown",(function(){return n.shutdown()})),Lo(e,"destroy",(function(){return n.destroy()})),n}return h(e,t),e.prototype.update=function(e,n){this.willUpdate&&($i(this,"update",e,n,this),t.prototype.update.call(this,e,n))},e.prototype.postUpdate=function(t,e){$i(this,"postupdate",t,e,this)},e.prototype.render=function(t){var e=this.renderData;jh(e,t.gameFrame),this.willRender&&this.visible&&(kh(this),$i(this,"worldrender",e,this),Gh(t,e),this.camera.dirtyRender=!1)},e.prototype.renderGL=function(t){var e=this,n=t.current2DCamera,r=this.camera;n&&qe(r.worldTransform,n.worldTransform)||fr(t),function(t,e){t.current2DCamera=e,t.cameraMatrix=e.matrix,kr(t)}(t,r),this.renderList.forEach((function(n){n.children.length>0?e.renderNode(n,t):n.node.renderGL(t)}))},e.prototype.renderNode=function(t,e){var n=this;t.node.renderGL(e),t.children.forEach((function(t){t.children.length>0?n.renderNode(t,e):t.node.renderGL(e)})),t.node.postRenderGL(e)},e.prototype.postRenderGL=function(t){},e.prototype.shutdown=function(){var t=this.scene;Oo(t,"update",this._updateListener),Oo(t,"render",this._renderListener),Oo(t,"shutdown",this._shutdownListener),po(this),$i(this,"worldshutdown",this),jh(this.renderData,0),this.camera&&this.camera.reset()},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),$i(this,"destroy",this),jh(this.renderData,0),this.camera&&this.camera.destroy(),this.events.clear(),this.camera=null,this.renderData=null,this.events=null},e}(sa);function Vh(t,e){return{world:t,camera:e,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var Nh=function(t){function e(e){var n=t.call(this,e)||this;return n.type="StaticWorld",n.camera=new N,n.renderData=Vh(n,n.camera),n}return h(e,t),e}(Uh),Wh=function(t){function e(e){var n=t.call(this,e)||this;return n.enableCameraCull=!0,n.type="World",n.camera=new V,n.renderData=Vh(n,n.camera),n}return h(e,t),e}(Uh),qh=Object.freeze({__proto__:null,BaseWorld:Uh,BuildRenderList:kh,CalculateTotalRenderable:Oh,CreateWorldRenderData:Vh,Events:Fh,HasDirtyChildren:Ih,MergeRenderData:Gh,ResetWorldRenderData:jh,StaticWorld:Nh,UpdateCachedLayers:Lh,World:Wh,WorldDepthFirstSearch:Bh}),Hh=Object.freeze({__proto__:null,World3DRenderEvent:"worldrender",World3DShutdownEvent:"worldshutdown"});function Kh(t,e){e.numRendered++,e.numRenderable++,t.node.dirtyFrame>=e.gameFrame&&e.dirtyFrame++,t.children.forEach((function(t){t.children.length>0&&Kh(t,e)}))}function Xh(t){if(t.node.isDirty(io))return!0;for(var e=[t];e.length>0;){var n=e.pop();if(n.node.isDirty(ro))return!0;var r=n.children.length;if(r>0)for(var i=0;i<r;i++)e.push(n.children[i])}return e.length=0,!1}function Yh(t,e){t.forEach((function(t){e||Xh(t)?t.node.setDirty(io):t.children.length=0}))}function Zh(t,e,n){void 0===n&&(n=[]);for(var r=0;r<e.numChildren;r++){var i=e.children[r];if(i.isRenderable()){var o=[],a={node:i,children:o};n.push(a),i.willRenderChildren&&i.numChildren>0&&(i.willCacheChildren&&t.push(a),Zh(t,i,o))}}return n}function Jh(t){var e=[],n=Zh(e,t,[]),r=t.renderData;e.length>0&&Yh(e,t.camera.dirtyRender),n.forEach((function(t){t.children.length>0?Kh(t,r):(r.numRendered++,r.numRenderable++,t.node.dirtyFrame>=r.gameFrame&&r.dirtyFrame++)})),t.renderList=n,t.forceRefresh&&(r.dirtyFrame++,t.forceRefresh=!1)}function Qh(t,e){t.numDirtyFrames+=e.dirtyFrame,t.numTotalFrames+=e.numRendered,e.camera.dirtyRender&&t.numDirtyCameras++,t.worldData.push(e)}function $h(t,e){t.gameFrame=e,t.dirtyFrame=0,t.numRendered=0,t.numRenderable=0}var tc=function(t){function e(e){var n=t.call(this)||this;return n.forceRefresh=!1,n.is3D=!0,n.type="BaseWorld",n.scene=e,n.world=n,n.events=new Map,n.renderList=[],n._updateListener=Io(e,"update",(function(t,e){return n.update(t,e)})),n._renderListener=Io(e,"render",(function(t){return n.render(t)})),n._shutdownListener=Io(e,"shutdown",(function(){return n.shutdown()})),Lo(e,"destroy",(function(){return n.destroy()})),n}return h(e,t),e.prototype.update=function(e,n){this.willUpdate&&($i(this,"update",e,n,this),t.prototype.update.call(this,e,n))},e.prototype.postUpdate=function(t,e){$i(this,"postupdate",t,e,this)},e.prototype.render=function(t){var e=this.renderData;$h(e,t.gameFrame),this.willRender&&this.visible&&(Jh(this),$i(this,"worldrender",e,this),Qh(t,e))},e.prototype.renderNode=function(t,e){var n=this;t.node.renderGL(e),t.children.forEach((function(t){t.children.length>0?n.renderNode(t,e):t.node.renderGL(e)})),t.node.postRenderGL(e)},e.prototype.shutdown=function(){var t=this.scene;Oo(t,"update",this._updateListener),Oo(t,"render",this._renderListener),Oo(t,"shutdown",this._shutdownListener),Po(this),$i(this,"worldshutdown",this),$h(this.renderData,0)},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),$i(this,"destroy",this),$h(this.renderData,0),this.events.clear(),this.camera=null,this.renderData=null,this.events=null},e}(Va);function ec(t,e){return{world:t,camera:e,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var nc,rc=function(t){function e(){var e=t.call(this)||this,n=new Float32Array(16).fill(0),r=[0,0,0],i={fragmentShader:"#define SHADER_NAME AMBIENT_LIGHT_FRAG\n\nprecision highp float;\n\nuniform vec3 uLightPosition;\nuniform vec3 uLightAmbient;\nuniform vec3 uLightDiffuse;\nuniform vec3 uLightSpecular;\n\nuniform vec3 uMaterialAmbient;\nuniform vec3 uMaterialDiffuse;\nuniform vec3 uMaterialSpecular;\nuniform float uMaterialShine;\n\nuniform vec3 uCameraPosition;\n\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nvoid main (void)\n{\n    vec4 color = texture2D(uTexture, vTextureCoord);\n\n    vec3 ambient = uLightAmbient * uMaterialAmbient;\n\n    vec3 norm = normalize(vNormal);\n    vec3 lightDir = normalize(uLightPosition - vPosition);\n    float diff = max(dot(norm, lightDir), 0.0);\n    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);\n\n    vec3 viewDir = normalize(uCameraPosition - vPosition);\n    vec3 reflectDir = reflect(-lightDir, norm);\n    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);\n    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);\n\n    vec3 result = (ambient + diffuse + specular) * color.rgb;\n\n    gl_FragColor = vec4(result, color.a);\n}",vertexShader:"\n#define SHADER_NAME AMBIENT_LIGHT_VERT\n\nprecision highp float;\n\nattribute vec3 aVertexPosition;\nattribute vec3 aVertexNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uViewProjectionMatrix;\nuniform mat4 uModelMatrix;\nuniform mat4 uNormalMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nvoid main(void)\n{\n    vTextureCoord = aTextureCoord;\n\n    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));\n\n    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));\n\n    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n}\n",attributes:{aVertexPosition:{size:3,type:5126,normalized:!1,offset:0},aVertexNormal:{size:3,type:5126,normalized:!1,offset:12},aTextureCoord:{size:2,type:5126,normalized:!1,offset:24}},uniforms:{uViewProjectionMatrix:n,uNormalMatrix:n,uModelMatrix:n,uCameraPosition:r,uTexture:0,uLightPosition:r,uLightAmbient:r,uLightDiffuse:r,uLightSpecular:r,uMaterialAmbient:r,uMaterialDiffuse:r,uMaterialSpecular:r,uMaterialShine:0}};return e.fromConfig(i),e}return h(e,t),e}(Or),ic=function(){function t(t,e,n){var i=this;void 0===t&&(t=45),void 0===e&&(e=.1),void 0===n&&(n=1e3),this.isOrbit=!1,this.minDistance=0,this.maxDistance=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.dirtyRender=!0,this.panRate=5,this.zoomRate=200,this.rotateRate=-3,this._yaw=0,this._pitch=0,this._roll=0,this.type="Camera3D",this._fov=t,this._near=e,this._far=n,this.matrix=new x,this.viewMatrix=new x,this.projectionMatrix=new x,this.viewProjectionMatrix=new x,this.position=new bt((function(){return i.update()})),this.rotation=new M;var o=r().renderer;this.viewport=new O(0,0,o.width,o.height),this.renderer=o,this.forward=K(),this.up=Z(),this.right=Y(),this.start=new g,this.setAspectRatio()}return t.prototype.update=function(){var t=this.matrix,e=this.viewMatrix;return w(this.rotation,this.position,!this.isOrbit,t),Tt(nt,t,this.forward),Tt(Q,t,this.up),Tt(et,t,this.right),C(t,e),z(this.projectionMatrix,e,this.viewProjectionMatrix),this},t.prototype.panX=function(t){var e=this.position;return this.isOrbit||Ct(e,this.right,t,e),this},t.prototype.panY=function(t){var e=this.position,n=this.up;return this.isOrbit?e.y+=n.y*t:Ct(e,n,t,e),this},t.prototype.panZ=function(t){var e=this.position;return this.isOrbit?e.z+=t:Ct(e,this.forward,t,e),this},t.prototype.begin=function(t,e){this.start.set(t,e)},t.prototype.pan=function(t,e){var n=t-this.start.x,r=e-this.start.y,i=this.viewport;this.panX(-n*(this.panRate/i.width)),this.panY(r*(this.panRate/i.height)),this.start.set(t,e)},t.prototype.rotate=function(t,e){var n=t-this.start.x,r=e-this.start.y,i=this.viewport;this.rotation.x+=r*(this.rotateRate/i.height),this.rotation.y+=n*(this.rotateRate/i.width),this.start.set(t,e),this.update()},t.prototype.zoom=function(t){this.panZ(ct(t,-1,1)*(this.zoomRate/this.viewport.height))},t.prototype.setAspectRatio=function(t){if(!t){var e=this.renderer;t=e.width/e.height}return this.aspect=t,this.updateProjectionMatrix()},t.prototype.updateProjectionMatrix=function(){return E(Cn(this._fov),this.aspect,this._near,this._far,this.projectionMatrix),this},Object.defineProperty(t.prototype,"fov",{get:function(){return this._fov},set:function(t){this._fov=ct(t,0,180),this.updateProjectionMatrix()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"near",{get:function(){return this._near},set:function(t){t>0&&(this._near=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"far",{get:function(){return this._far},set:function(t){t>0&&(this._far=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yaw",{get:function(){return this._yaw},set:function(t){this._yaw=t,Dt(t,this._pitch,this._roll,this.rotation)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=t,Dt(this._yaw,t,this._roll,this.rotation)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roll",{get:function(){return this._roll},set:function(t){this._roll=t,Dt(this._yaw,this._pitch,t,this.rotation)},enumerable:!1,configurable:!0}),t}(),oc=function(t){function e(e,n,r,i,o){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0);var a=t.call(this,e)||this;return a.enableCameraCull=!0,a.type="World3D",a.camera=new ic,a.camera.position.set(n,r,i),a.light=new Ja(o),a.shader=new rc,a.renderData=ec(a,a.camera),a}return h(e,t),e.prototype.renderGL=function(t){var e=this;fr(t);var n=this.shader,r=this.camera,i=t.renderer.gl;Wr(t,n,0),n.setUniform("uViewProjectionMatrix",r.viewProjectionMatrix.data),n.setUniform("uCameraPosition",r.position.toArray()),this.light.setUniforms(n),i.enable(i.DEPTH_TEST),this.renderList.forEach((function(n){n.children.length>0?e.renderNode(n,t):n.node.renderGL(t)}))},e.prototype.postRenderGL=function(t){var e=t.renderer.gl;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),Nr(t)},e}(tc),ac=Object.freeze({__proto__:null,BaseWorld3D:tc,BuildRenderList:Jh,CalculateTotalRenderable:Kh,CreateWorld3DRenderData:ec,Events:Hh,HasDirtyChildren:Xh,MergeRenderData:Qh,ResetWorld3DRenderData:$h,UpdateCachedLayers:Yh,World3D:oc,WorldDepthFirstSearch:Zh});var uc=function(){return nc},sc=function(t){nc=t},hc=function(){function t(){var t=this;this.scenes=new Map,this.sceneIndex=0,this.flush=!1,this.renderResult={gameFrame:0,numTotalFrames:0,numDirtyFrames:0,numDirtyCameras:0,worldData:[]},this.game=r(),sc(this),Lo(this.game,"boot",(function(){return t.boot()}))}return t.prototype.boot=function(){jn.get(In).forEach((function(t){return new t}))},t.prototype.update=function(t,e){var n,r;try{for(var i=c(this.scenes.values()),o=i.next();!o.done;o=i.next()){$i(o.value,"update",t,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.render=function(t){var e,n,r=this.renderResult;!function(t,e){void 0===e&&(e=0),t.gameFrame=e,t.numTotalFrames=0,t.numDirtyFrames=0,t.numDirtyCameras=0,t.worldData.length=0}(r,t);try{for(var i=c(this.scenes.values()),o=i.next();!o.done;o=i.next()){$i(o.value,"render",r)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return this.flush&&(r.numDirtyFrames++,this.flush=!1),r},t}();function cc(){Un(0),Nn(4096),Vn("Phaser","4.0.0","https://phaser4.io"),rr(0),nr(.5,.5),Kn(800,600,1)}var fc=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.call(this)||this;return r.VERSION="4.0.0-beta1",r.isBooted=!1,r.isPaused=!1,r.willUpdate=!0,r.willRender=!0,r.lastTick=0,r.elapsed=0,r.frame=0,i(r),cc(),Jr((function(){return r.boot(e)})),r}return h(e,t),e.prototype.boot=function(t){t.forEach((function(t){return t()}));var e=jn.get(Ln);this.renderer=new e,this.textureManager=new Sh,this.sceneManager=new hc;var n=jn.get(Fn);n&&Zr(this.renderer.canvas,n),this.isBooted=!0,function(){var t=jn.get(Gn),e=t.title,n=t.version,r=t.url,i=t.color,o=t.background;if(""!==e){var a=""!==n?e+" "+n:e;console.log("%c"+a+"%c "+r,"padding: 4px 16px; color: "+i+"; background: "+o,"")}}(),$i(this,"boot"),this.lastTick=performance.now(),this.step(this.lastTick)},e.prototype.pause=function(){this.isPaused=!0},e.prototype.resume=function(){this.isPaused=!1,this.lastTick=performance.now()},e.prototype.step=function(t){var e=this,n=t-this.lastTick;this.lastTick=t,this.elapsed+=n,this.isPaused||(this.willUpdate&&(this.sceneManager.update(n,t),$i(this,"update",n,t)),this.willRender&&this.renderer.render(this.sceneManager.render(this.frame))),this.frame++,a(this.frame),u(this.elapsed),requestAnimationFrame((function(t){return e.step(t)}))},e.prototype.destroy=function(){},e}(Do);function dc(t,e){void 0===e&&(e={});var n=uc(),r=n.scenes.size,i=n.sceneIndex,o=0===r;"string"==typeof e?t.key=e:(e||!e&&o)&&(t.key=function(t,e,n){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:n}(e,"key","scene"+i.toString())),n.scenes.has(t.key)?console.warn("Scene key already in use: "+t.key):(n.scenes.set(t.key,t),n.flush=!0,n.sceneIndex++)}var lc=function(t){this.game=r(),this.events=new Map,dc(this,t)};t.Camera=W,t.Camera3D=En,t.Config=Yr,t.DOM=ti,t.Device=Xi,t.Display=xo,t.Display3D=Ao,t.Events=Bo,t.Game=fc,t.GameObjects=Ta,t.GameObjects3D=nu,t.Geom=Ku,t.Geom3D=Xu,t.Input=Os,t.Loader=Zs,t.Materials3D=bh,t.Math=zn,t.Scene=lc,t.Textures=Eh,t.Time=Dh,t.WebGL1=Ra,t.World=qh,t.World3D=ac}));
